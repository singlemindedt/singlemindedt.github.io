<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Hexo</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://singlemindedt.github.io/"/>
  <updated>2019-10-10T15:56:49.921Z</updated>
  <id>https://singlemindedt.github.io/</id>
  
  <author>
    <name>Smtsec</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>初探栈溢出</title>
    <link href="https://singlemindedt.github.io/2019/10/10/%E5%88%9D%E6%8E%A2%E6%A0%88%E6%BA%A2%E5%87%BA/"/>
    <id>https://singlemindedt.github.io/2019/10/10/初探栈溢出/</id>
    <published>2019-10-10T14:09:17.000Z</published>
    <updated>2019-10-10T15:56:49.921Z</updated>
    
    <content type="html"><![CDATA[<p>这里给出一个简单的exe文件，实现的功能为：让用户键入密码，程序将之与固定密码(1234567)进行比较，如果错误继续键入，成功则提示“Congratulation! You have passed the verification!”</p><p>将程序拖入IDA，在左边窗口有<strong>函数名称</strong>列表，找到_main函数双击，可以看到其程序流程图：<br><img src="/images/zyc0.png" alt="zyc0"><br>伪代码：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [esp+0h] [ebp-8h]//变量v4</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_4010A7(aPleaseInputPas, v4);<span class="comment">//函数sub_4010A7需要调用两个参数aPleaseInputPas, v4</span></span><br><span class="line">    <span class="built_in">scanf</span>(aS, &amp;v4);<span class="comment">//输入v4</span></span><br><span class="line">    <span class="keyword">if</span> ( !sub_401000(&amp;v4) )<span class="comment">//若sub_401000(&amp;v4)==0调用 sub_4010A7(aIncorrectPassw, v4)</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    sub_4010A7(aIncorrectPassw, v4);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sub_4010A7(aCongratulation, v4);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们接下来查看 判断函数sub_401000：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">sub_401000</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">strcmp</span>(a1, a1234567);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*比较两个字符串</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">设这两个字符串为str1，str2，</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">若str1=str2，则返回零；</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">若str1&lt;str2，则返回负数；</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">若str1&gt;str2，则返回正数。</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>查看sub_4010A7：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">sub_4010A7</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// ebx</span></span><br><span class="line"></span><br><span class="line">  v2 = _stbuf(&amp;stru_4080E0);</span><br><span class="line">  v3 = sub_401E34(&amp;stru_4080E0, a1, (<span class="keyword">int</span>)&amp;a2);</span><br><span class="line">  _ftbuf(v2, &amp;stru_4080E0);</span><br><span class="line">  <span class="keyword">return</span> v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;这里给出一个简单的exe文件，实现的功能为：让用户键入密码，程序将之与固定密码(1234567)进行比较，如果错误继续键入，成功则提示“Congratulation! You have passed the verification!”&lt;/p&gt;
&lt;p&gt;将程序拖入IDA，在左
      
    
    </summary>
    
      <category term="notes" scheme="https://singlemindedt.github.io/categories/notes/"/>
    
    
      <category term="re" scheme="https://singlemindedt.github.io/tags/re/"/>
    
  </entry>
  
  <entry>
    <title>ics-05</title>
    <link href="https://singlemindedt.github.io/2019/10/05/ics-05/"/>
    <id>https://singlemindedt.github.io/2019/10/05/ics-05/</id>
    <published>2019-10-05T02:53:52.000Z</published>
    <updated>2019-10-06T00:38:42.710Z</updated>
    
    <summary type="html">
    
    </summary>
    
      <category term="CTF" scheme="https://singlemindedt.github.io/categories/CTF/"/>
    
    
      <category term="CTF" scheme="https://singlemindedt.github.io/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>正则表达式</title>
    <link href="https://singlemindedt.github.io/2019/10/04/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    <id>https://singlemindedt.github.io/2019/10/04/正则表达式/</id>
    <published>2019-10-04T06:34:42.000Z</published>
    <updated>2019-10-04T07:18:57.002Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://c.runoob.com/front-end/854" target="_blank" rel="noopener">https://c.runoob.com/front-end/854</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://c.runoob.com/front-end/854&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://c.runoob.com/front-end/854&lt;/a&gt;&lt;/p&gt;

      
    
    </summary>
    
      <category term="notes" scheme="https://singlemindedt.github.io/categories/notes/"/>
    
    
      <category term="正则表达式" scheme="https://singlemindedt.github.io/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>PHP学习</title>
    <link href="https://singlemindedt.github.io/2019/09/30/PHP%E5%AD%A6%E4%B9%A0/"/>
    <id>https://singlemindedt.github.io/2019/09/30/PHP学习/</id>
    <published>2019-09-30T14:44:09.000Z</published>
    <updated>2019-10-03T13:33:07.472Z</updated>
    
    <content type="html"><![CDATA[<p>文章内容主要来自W3School，仅作为学习记录使用。</p><h2 id="在-PHP-创建用户定义函数"><a href="#在-PHP-创建用户定义函数" class="headerlink" title="在 PHP 创建用户定义函数"></a>在 PHP 创建用户定义函数</h2><p>用户定义的函数声明以单词 “function” 开头：</p><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">functionName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  被执行的代码;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注释：函数名能够以字母或下划线开头（而非数字）。<br>注释：函数名对大小写不敏感。<br>提示：函数名应该能够反映函数所执行的任务。*</p><hr><h2 id="获得数组的长度-count-函数"><a href="#获得数组的长度-count-函数" class="headerlink" title="获得数组的长度 - count() 函数"></a>获得数组的长度 - count() 函数</h2><p>count() 函数用于返回数组的长度（元素数）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$cars=<span class="keyword">array</span>(<span class="string">"porsche"</span>,<span class="string">"BMW"</span>,<span class="string">"Volvo"</span>);</span><br><span class="line"><span class="keyword">echo</span> count($cars);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><hr><h2 id="PHP-关联数组"><a href="#PHP-关联数组" class="headerlink" title="PHP 关联数组"></a>PHP 关联数组</h2><p>关联数组是使用您分配给数组的指定键的数组。<br>有两种创建关联数组的方法：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$age=<span class="keyword">array</span>(<span class="string">"Bill"</span>=&gt;<span class="string">"35"</span>,<span class="string">"Steve"</span>=&gt;<span class="string">"37"</span>,<span class="string">"Elon"</span>=&gt;<span class="string">"43"</span>);</span><br><span class="line">或者：</span><br><span class="line">$age[<span class="string">'Bill'</span>]=<span class="string">"63"</span>;</span><br><span class="line">$age[<span class="string">'Steve'</span>]=<span class="string">"56"</span>;</span><br><span class="line">$age[<span class="string">'Elon'</span>]=<span class="string">"47"</span>;</span><br></pre></td></tr></table></figure><p>随后可以在脚本中使用指定键：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$age=<span class="keyword">array</span>(<span class="string">"Bill"</span>=&gt;<span class="string">"63"</span>,<span class="string">"Steve"</span>=&gt;<span class="string">"56"</span>,<span class="string">"Elon"</span>=&gt;<span class="string">"47"</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Elon is "</span> . $age[<span class="string">'Elon'</span>] . <span class="string">" years old."</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">Elon is <span class="number">47</span> years old.</span><br></pre></td></tr></table></figure><hr><h2 id="PHP-数组的排序函数"><a href="#PHP-数组的排序函数" class="headerlink" title="PHP - 数组的排序函数"></a>PHP - 数组的排序函数</h2><p>在本节中，我们将学习如下 PHP 数组排序函数：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sort() - 以升序对数组排序</span><br><span class="line">rsort() - 以降序对数组排序</span><br><span class="line">asort() - 根据值，以升序对关联数组进行排序</span><br><span class="line">ksort() - 根据键，以升序对关联数组进行排序</span><br><span class="line">arsort() - 根据值，以降序对关联数组进行排序</span><br><span class="line">krsort() - 根据键，以降序对关联数组进行排序</span><br></pre></td></tr></table></figure><hr><h2 id="GET-vs-POST"><a href="#GET-vs-POST" class="headerlink" title="GET vs. POST"></a>GET vs. POST</h2><p>GET 和 POST 都创建数组（例如，array( key =&gt; value, key2 =&gt; value2, key3 =&gt; value3, …)）。此数组包含键/值对，其中的键是表单控件的名称，而值是来自用户的输入数据。<br>GET 和 POST 被视作 $_GET 和 $_POST。它们是超全局变量，这意味着对它们的访问无需考虑作用域 - 无需任何特殊代码，您能够从任何函数、类或文件访问它们。<br>$_GET 是通过 URL 参数传递到当前脚本的变量数组。<br>$_POST 是通过 HTTP POST 传递到当前脚本的变量数组。</p><h3 id="何时使用-GET？"><a href="#何时使用-GET？" class="headerlink" title="何时使用 GET？"></a>何时使用 GET？</h3><p>通过 GET 方法从表单发送的信息对任何人都是可见的（所有变量名和值都显示在 URL 中）。GET 对所发送信息的数量也有限制。限制在大约 2000 个字符。不过，由于变量显示在 URL 中，把页面添加到书签中也更为方便。<br>GET 可用于发送非敏感的数据。<br>注释：绝不能使用 GET 来发送密码或其他敏感信息！</p><h3 id="何时使用-POST？"><a href="#何时使用-POST？" class="headerlink" title="何时使用 POST？"></a>何时使用 POST？</h3><p>通过 POST 方法从表单发送的信息对其他人是不可见的（所有名称/值会被嵌入 HTTP 请求的主体中），并且对所发送信息的数量也无限制。<br>此外 POST 支持高阶功能，比如在向服务器上传文件时进行 multi-part 二进制输入。<br>不过，由于变量未显示在 URL 中，也就无法将页面添加到书签。<br>提示：开发者偏爱 POST 来发送表单数据。</p><hr><h2 id="表单元素"><a href="#表单元素" class="headerlink" title="表单元素"></a>表单元素</h2><p>表单的 HTML 代码是这样的：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method=<span class="string">"post"</span> action=<span class="string">"&lt;?php echo htmlspecialchars($_SERVER["</span>PHP_SELF<span class="string">"]);?&gt;"</span>&gt;</span><br></pre></td></tr></table></figure><p>当提交此表单时，通过 method=”post” 发送表单数据。<br>什么是 $_SERVER[“PHP_SELF”] 变量？<br>$_SERVER[“PHP_SELF”] 是一种超全局变量，它返回当前执行脚本的文件名。<br>因此，$_SERVER[“PHP_SELF”] 将表单数据发送到页面本身，而不是跳转到另一张页面。这样，用户就能够在表单页面获得错误提示信息。</p><h2 id="什么是-htmlspecialchars-函数？"><a href="#什么是-htmlspecialchars-函数？" class="headerlink" title="什么是 htmlspecialchars() 函数？"></a>什么是 htmlspecialchars() 函数？</h2><p>htmlspecialchars() 函数把特殊字符转换为 HTML 实体。这意味着 &lt; 和 &gt; 之类的 HTML 字符会被替换为 &lt; 和 &gt; 。这样可防止攻击者通过在表单中注入 HTML 或 JavaScript 代码（跨站点脚本攻击）对代码进行利用。</p><h2 id="关于-PHP-表单安全性的重要提示"><a href="#关于-PHP-表单安全性的重要提示" class="headerlink" title="关于 PHP 表单安全性的重要提示"></a>关于 PHP 表单安全性的重要提示</h2><p>$_SERVER[“PHP_SELF”] 变量能够被黑客利用！<br>如果您的页面使用了 PHP_SELF，用户能够输入下划线然后执行跨站点脚本（XSS）。<br>提示：跨站点脚本（Cross-site scripting，XSS）是一种计算机安全漏洞类型，常见于 Web 应用程序。XSS 能够使攻击者向其他用户浏览的网页中输入客户端脚本。<br>假设我们的一张名为 “test_form.php” 的页面中有如下表单：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method=<span class="string">"post"</span> action=<span class="string">"&lt;?php echo $_SERVER["</span>PHP_SELF<span class="string">"];?&gt;"</span>&gt;</span><br></pre></td></tr></table></figure><p>现在，如果用户进入的是地址栏中正常的 URL：”<a href="http://www.example.com/test_form.php&quot;，上面的代码会转换为：" target="_blank" rel="noopener">http://www.example.com/test_form.php&quot;，上面的代码会转换为：</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method=<span class="string">"post"</span> action=<span class="string">"test_form.php"</span>&gt;</span><br></pre></td></tr></table></figure><p>到目前，一切正常。<br>不过，如果用户在地址栏中键入了如下 URL：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//www.example.com/test_form.php/%22%3E%3Cscript%3Ealert('hacked')%3C/script%3E</span></span><br></pre></td></tr></table></figure><p>在这种情况下，上面的代码会转换为：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method=<span class="string">"post"</span> action=<span class="string">"test_form.php"</span>/&gt;&lt;script&gt;alert(<span class="string">'hacked'</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>这段代码加入了一段脚本和一个提示命令。并且当此页面加载后，就会执行 JavaScript 代码（用户会看到一个提示框）。这仅仅是一个关于 PHP_SELF 变量如何被利用的简单无害案例。<br>您应该意识到 <script> 标签内能够添加任何 JavaScript 代码！黑客能够把用户重定向到另一台服务器上的某个文件，该文件中的恶意代码能够更改全局变量或将表单提交到其他地址以保存用户数据，等等。<br>如果避免 $_SERVER["PHP_SELF"] 被利用？<br>通过使用 htmlspecialchars() 函数能够避免 $_SERVER["PHP_SELF"] 被利用。<br>表单代码是这样的：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method=<span class="string">"post"</span> action=<span class="string">"&lt;?php echo htmlspecialchars($_SERVER["</span>PHP_SELF<span class="string">"]);?&gt;"</span>&gt;</span><br></pre></td></tr></table></figure><p>htmlspecialchars() 函数把特殊字符转换为 HTML 实体。现在，如果用户试图利用 PHP_SELF 变量，会导致如下输出：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method=<span class="string">"post"</span> action=<span class="string">"test_form.php/&amp;quot;&amp;gt;&amp;lt;script&amp;gt;alert('hacked')&amp;lt;/script&amp;gt;"</span>&gt;</span><br></pre></td></tr></table></figure><p>无法利用，没有危害！</p><h2 id="通过-PHP-验证表单数据"><a href="#通过-PHP-验证表单数据" class="headerlink" title="通过 PHP 验证表单数据"></a>通过 PHP 验证表单数据</h2><p>我们要做的第一件事是通过 PHP 的 htmlspecialchars() 函数传递所有变量。<br>在我们使用 htmlspecialchars() 函数后，如果用户试图在文本字段中提交以下内容：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;location.href(<span class="string">'http://www.hacked.com'</span>)&lt;/script&gt;</span><br><span class="line">- 代码不会执行，因为会被保存为转义代码，就像这样：</span><br><span class="line">&amp;lt;script&amp;gt;location.href(<span class="string">'http://www.hacked.com'</span>)&amp;lt;/script&amp;gt;</span><br></pre></td></tr></table></figure><p>现在这条代码显示在页面上或 e-mail 中是安全的。<br>在用户提交该表单时，我们还要做两件事：<br>（通过 PHP trim() 函数）去除用户输入数据中不必要的字符（多余的空格、制表符、换行）<br>（通过 PHP stripslashes() 函数）删除用户输入数据中的反斜杠（\）<br>接下来我们创建一个检查函数（相比一遍遍地写代码，这样效率更好）。<br>我们把函数命名为 test_input()。<br>现在，我们能够通过 test_input() 函数检查每个 $_POST 变量，脚本是这样的：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">实例</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 定义变量并设置为空值</span></span><br><span class="line">$name = $email = $gender = $comment = $website = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($_SERVER[<span class="string">"REQUEST_METHOD"</span>] == <span class="string">"POST"</span>) &#123;</span><br><span class="line">  $name = test_input($_POST[<span class="string">"name"</span>]);</span><br><span class="line">  $email = test_input($_POST[<span class="string">"email"</span>]);</span><br><span class="line">  $website = test_input($_POST[<span class="string">"website"</span>]);</span><br><span class="line">  $comment = test_input($_POST[<span class="string">"comment"</span>]);</span><br><span class="line">  $gender = test_input($_POST[<span class="string">"gender"</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test_input</span><span class="params">($data)</span> </span>&#123;</span><br><span class="line">  $data = trim($data);</span><br><span class="line">  $data = stripslashes($data);</span><br><span class="line">  $data = htmlspecialchars($data);</span><br><span class="line">  <span class="keyword">return</span> $data;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>请注意在脚本开头，我们检查了表单是否使用 $_SERVER["REQUEST_METHOD"] 进行提交。如果 REQUEST_METHOD 是 POST，那么表单已被提交 - 并且应该对其进行验证。如果未提交，则跳过验证并显示一个空白表单。<br>不过，在上面的例子中，所有输入字段都是可选的。即使用户未输入任何数据，脚本也能正常工作。<br>下一步是制作必填输入字段，并创建需要时使用的错误消息。</p><hr><p><strong>关于正则表达式</strong>：记-正则表达式</p><hr><h2 id="PHP-表单验证-验证-E-mail-和-URL"><a href="#PHP-表单验证-验证-E-mail-和-URL" class="headerlink" title="PHP 表单验证 - 验证 E-mail 和 URL"></a>PHP 表单验证 - 验证 E-mail 和 URL</h2><h3 id="PHP-验证名字"><a href="#PHP-验证名字" class="headerlink" title="PHP - 验证名字"></a>PHP - 验证名字</h3><p>以下代码展示的简单方法检查 name 字段是否包含字母和空格。如果 name 字段无效，则存储一条错误消息：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$name = test_input($_POST[<span class="string">"name"</span>]);</span><br><span class="line"><span class="keyword">if</span> (!preg_match(<span class="string">"/^[a-zA-Z ]*$/"</span>,$name)) &#123;</span><br><span class="line">  $nameErr = <span class="string">"只允许字母和空格！"</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注释：preg_match() 函数检索字符串的模式，如果模式存在则返回 true，否则返回 false。</p><h3 id="PHP-验证-E-mail"><a href="#PHP-验证-E-mail" class="headerlink" title="PHP - 验证 E-mail"></a>PHP - 验证 E-mail</h3><p>以下代码展示的简单方法检查 e-mail </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$email = test_input($_POST[<span class="string">"email"</span>]);</span><br><span class="line"><span class="keyword">if</span> (!preg_match(<span class="string">"/([\w\-]+\@[\w\-]+\.[\w\-]+)/"</span>,$email)) &#123;</span><br><span class="line">  $emailErr = <span class="string">"无效的 email 格式！"</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="PHP-验证-URL"><a href="#PHP-验证-URL" class="headerlink" title="PHP - 验证 URL"></a>PHP - 验证 URL</h3><p>以下代码展示的方法检查 URL 地址语法是否有效（这条正则表达式同时允许 URL 中的斜杠）。如果 URL 地址语法无效，则存储一条错误消息：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$website = test_input($_POST[<span class="string">"website"</span>]);</span><br><span class="line"><span class="keyword">if</span> (!preg_match(<span class="string">"/\b(?:(?:https?|ftp):\/\/|www\.)[-a-z0-9+&amp;@#\/%?=~_|!:,.;]*[-a-z0-9+&amp;@#\/%</span></span><br><span class="line"><span class="string">=~_|]/i"</span>,$website)) &#123;</span><br><span class="line">  $websiteErr = <span class="string">"无效的 URL"</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="PHP-验证-Name、E-mail、以及-URL"><a href="#PHP-验证-Name、E-mail、以及-URL" class="headerlink" title="PHP - 验证 Name、E-mail、以及 URL"></a>PHP - 验证 Name、E-mail、以及 URL</h4><p>现在，脚本是这样的：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">实例</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 定义变量并设置为空值</span></span><br><span class="line">$nameErr = $emailErr = $genderErr = $websiteErr = <span class="string">""</span>;</span><br><span class="line">$name = $email = $gender = $comment = $website = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($_SERVER[<span class="string">"REQUEST_METHOD"</span>] == <span class="string">"POST"</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">empty</span>($_POST[<span class="string">"name"</span>])) &#123;</span><br><span class="line">    $nameErr = <span class="string">"Name is required"</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $name = test_input($_POST[<span class="string">"name"</span>]);</span><br><span class="line">    <span class="comment">// 检查名字是否包含字母和空格</span></span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">"/^[a-zA-Z ]*$/"</span>,$name)) &#123;</span><br><span class="line">      $nameErr = <span class="string">"Only letters and white space allowed"</span>; </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">empty</span>($_POST[<span class="string">"email"</span>])) &#123;</span><br><span class="line">    $emailErr = <span class="string">"Email is required"</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $email = test_input($_POST[<span class="string">"email"</span>]);</span><br><span class="line">    <span class="comment">// 检查电邮地址语法是否有效</span></span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">"/([\w\-]+\@[\w\-]+\.[\w\-]+)/"</span>,$email)) &#123;</span><br><span class="line">      $emailErr = <span class="string">"Invalid email format"</span>; </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">empty</span>($_POST[<span class="string">"website"</span>])) &#123;</span><br><span class="line">    $website = <span class="string">""</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $website = test_input($_POST[<span class="string">"website"</span>]);</span><br><span class="line">    <span class="comment">// 检查 URL 地址语言是否有效（此正则表达式同样允许 URL 中的下划线）</span></span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">"/\b(?:(?:https?|ftp):\/\/|www\.)[-a-z0-9+&amp;@#\/%?=~_|!:,.;]*[-a-z0-9+&amp;@#\/%</span></span><br><span class="line"><span class="string">    =~_|]/i"</span>,$website)) &#123;</span><br><span class="line">      $websiteErr = <span class="string">"Invalid URL"</span>; </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">empty</span>($_POST[<span class="string">"comment"</span>])) &#123;</span><br><span class="line">    $comment = <span class="string">""</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $comment = test_input($_POST[<span class="string">"comment"</span>]);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">empty</span>($_POST[<span class="string">"gender"</span>])) &#123;</span><br><span class="line">    $genderErr = <span class="string">"Gender is required"</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $gender = test_input($_POST[<span class="string">"gender"</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></script></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;文章内容主要来自W3School，仅作为学习记录使用。&lt;/p&gt;
&lt;h2 id=&quot;在-PHP-创建用户定义函数&quot;&gt;&lt;a href=&quot;#在-PHP-创建用户定义函数&quot; class=&quot;headerlink&quot; title=&quot;在 PHP 创建用户定义函数&quot;&gt;&lt;/a&gt;在 PHP 创建用
      
    
    </summary>
    
      <category term="notes" scheme="https://singlemindedt.github.io/categories/notes/"/>
    
    
      <category term="PHP" scheme="https://singlemindedt.github.io/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>CumtCTF2019华为杯</title>
    <link href="https://singlemindedt.github.io/2019/09/30/CumtCTF2019%E5%8D%8E%E4%B8%BA%E6%9D%AF/"/>
    <id>https://singlemindedt.github.io/2019/09/30/CumtCTF2019华为杯/</id>
    <published>2019-09-30T07:38:23.000Z</published>
    <updated>2019-10-04T16:49:46.497Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Web签到题"><a href="#Web签到题" class="headerlink" title="Web签到题"></a>Web签到题</h2><p>点开链接为seed和hash参数的提交框，尝试admin，admin，返回Fail…;查看响应，发现有payload，提示访问<code>index.php?source=1</code><br>发现php代码:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gen_secured_random</span><span class="params">()</span> </span>&#123; <span class="comment">// cause random is the way</span></span><br><span class="line">    $a = rand(<span class="number">1337</span>,<span class="number">2600</span>)*<span class="number">42</span>;</span><br><span class="line">    $b = rand(<span class="number">1879</span>,<span class="number">1955</span>)*<span class="number">42</span>;</span><br><span class="line"></span><br><span class="line">    $a &lt; $b ? $a ^= $b ^= $a ^= $b : $a = $b;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $a+$b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">secured_hash_function</span><span class="params">($plain)</span> </span>&#123; <span class="comment">// cause md5 is the best hash ever</span></span><br><span class="line">    $secured_plain = sanitize_user_input($plain);</span><br><span class="line">    <span class="keyword">return</span> md5($secured_plain);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sanitize_user_input</span><span class="params">($input)</span> </span>&#123; <span class="comment">// cause someone told me to never trust user input</span></span><br><span class="line">    $re = <span class="string">'/[^a-zA-Z0-9]/'</span>;<span class="comment">//re不为a-zA-Z0-9</span></span><br><span class="line">    $secured_input = preg_replace($re, <span class="string">""</span>, $input);</span><br><span class="line">    <span class="comment">//preg_replace函数（搜索input中符合re正则的内容用“ ”代替，即去除不是a-zA-Z0-9）</span></span><br><span class="line">    <span class="keyword">return</span> $secured_input;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">&lt;?php</span></span><br><span class="line"><span class="comment">      // cause someone told me to never trust user input</span></span><br><span class="line"><span class="comment">    $input='&lt;&lt;&lt;&gt;&gt;&gt;.AZ.,,assddf23232????'; </span></span><br><span class="line"><span class="comment">    $re = '/[^a-zA-Z0-9]/';//re不为a-zA-Z0-9</span></span><br><span class="line"><span class="comment">    $secured_input = preg_replace($re, "", $input);</span></span><br><span class="line"><span class="comment">    //preg_replace函数（搜索input中符合re正则的内容用“ ”代替，即去除非a-zA-Z0-9）</span></span><br><span class="line"><span class="comment">     echo $secured_input;</span></span><br><span class="line"><span class="comment">     ?&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">     run:AZassddf23232</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'source'</span>])) &#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">"secret.php"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'s'</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">'h'</span>]))</span><br><span class="line"> &#123;<span class="comment">//输入s,h</span></span><br><span class="line">    <span class="comment">//isset在php中用来判断变量是否声明，该函数返回布尔类型的值，即true/false。</span></span><br><span class="line">    <span class="comment">//isset只能用于变量，因为传递任何其它参数都将造成解析错误</span></span><br><span class="line">    $s = sanitize_user_input($_POST[<span class="string">'s'</span>]);<span class="comment">//s=输入s</span></span><br><span class="line">    $h = secured_hash_function($_POST[<span class="string">'h'</span>]);<span class="comment">//h=MD5（h）</span></span><br><span class="line">    $r = gen_secured_random();<span class="comment">//r=随机数</span></span><br><span class="line">    <span class="keyword">if</span>($s != <span class="keyword">false</span> &amp;&amp; $h != <span class="keyword">false</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>($s.$r == $h) <span class="comment">//弱类型比较</span></span><br><span class="line">        &#123;<span class="comment">//连接s和r，即：用户输入s+随机数==用户输入h   </span></span><br><span class="line">        <span class="comment">//*****此处利用0e漏洞，即0e+r==(填写hash为0开头字符)</span></span><br><span class="line">            <span class="keyword">print</span> <span class="string">"Well done! Here is your flag: "</span>.$flag;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"Fail..."</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"&lt;p&gt;Hum ...&lt;/p&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s=0e1<span class="variable">&amp;h</span>=QNKCDZO<span class="variable">&amp;submit</span>=<span class="meta">Check</span></span><br></pre></td></tr></table></figure><h2 id="Misc两岁半的猪"><a href="#Misc两岁半的猪" class="headerlink" title="Misc两岁半的猪"></a>Misc两岁半的猪</h2><p>打开压缩包为三只猪png，利用stegsolve发下有二维码；</p><hr><h2 id="寻找你的Key"><a href="#寻找你的Key" class="headerlink" title="寻找你的Key"></a>寻找你的Key</h2><p>得到压缩包，解压发现需要密码，用binwalk文件分离，得到另外一个压缩包0.zip和kEy.exe<br><img src="/images/key1.png" alt="key1"><br><img src="/images/key2.png" alt="key2"><br>将kEy.exe放进winhex,得到逆序图片base64编码<br><img src="/images/key3.png" alt="key3"><br>逆序编码，转图片，得到二维码<br><img src="/images/key4.png" alt="key4"></p><h2 id="委屈的兔兔"><a href="#委屈的兔兔" class="headerlink" title="委屈的兔兔"></a>委屈的兔兔</h2><p>将图片拖入winhex，得到Unicode 编码，直接百度解码得到 flag</p><h2 id="302？还有其他？"><a href="#302？还有其他？" class="headerlink" title="302？还有其他？"></a>302？还有其他？</h2><p>看到302，抓包，发现存在1ndex.php,访问1ndex.php发现RAW中有key和base64编码后的png图片，转图片，没有什么发现，<br>直接站长工具解密带隐藏信息的图片，输入密码，得到flag；<br>（此处做一补充，当时利用binwalk -e分离文件得到一个空文本文件和一个zlib文件，利用脚本解密zlib文件应该也能成功，不过当时未跑出来）</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Web签到题&quot;&gt;&lt;a href=&quot;#Web签到题&quot; class=&quot;headerlink&quot; title=&quot;Web签到题&quot;&gt;&lt;/a&gt;Web签到题&lt;/h2&gt;&lt;p&gt;点开链接为seed和hash参数的提交框，尝试admin，admin，返回Fail…;查看响应，发现有pay
      
    
    </summary>
    
      <category term="CTF" scheme="https://singlemindedt.github.io/categories/CTF/"/>
    
    
      <category term="CTF" scheme="https://singlemindedt.github.io/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>暴跳老板+Flag在哪？</title>
    <link href="https://singlemindedt.github.io/2019/09/25/%E6%9A%B4%E8%B7%B3%E8%80%81%E6%9D%BF/"/>
    <id>https://singlemindedt.github.io/2019/09/25/暴跳老板/</id>
    <published>2019-09-25T14:49:02.000Z</published>
    <updated>2019-09-27T15:38:49.163Z</updated>
    
    <content type="html"><![CDATA[<h2 id="暴跳老板"><a href="#暴跳老板" class="headerlink" title="暴跳老板"></a>暴跳老板</h2><p>随便输入内容，得到弹窗要以POST方式用Dear发邮件，抓包：<br><img src="/image/%E6%9A%B4%E8%B7%B31.png" alt="暴跳"><br>直接在postText后添加Dear=MyBoss，发包得到flag</p><hr><h2 id="Flag在哪？"><a href="#Flag在哪？" class="headerlink" title="Flag在哪？"></a>Flag在哪？</h2><p>burpsuit抓包，发现有五个跳转页面，但是都没有flag:)<br>/where_is_flag.php<br>/flag.php<br><strong>/I_have_a_frog.php</strong><br><strong>/I_have_a_flag.php</strong><br>/no_flag.php<br>看看大佬们骚操作，要组合一下 orz ，flagfrog.php,发包得到flag。</p><hr><h2 id="美味的饼干"><a href="#美味的饼干" class="headerlink" title="美味的饼干"></a>美味的饼干</h2><p>点击链接得到一个登录页面，尝试admin，111<br>提示“登录成功，欢迎admin！”，但是并没有什么有用的信息。查看源代码，提示“只有admin才有flag”。<br>检查请求头，有可疑Cookie：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">login</span>=ZWUxMWNiYjE5MDUyZTQwYjA3YWFjMGNhMDYwYzIzZWU%<span class="number">3</span>D</span><br></pre></td></tr></table></figure><p>base64解码：</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ee<span class="number">11</span>cbb<span class="number">19052e40</span>b<span class="number">07</span>aac<span class="number">0</span>ca<span class="number">060</span><span class="keyword">c</span><span class="number">23</span>ee</span><br></pre></td></tr></table></figure><p>MD5解码：<br>user</p><p>那么意思基本就清楚了，应该是要Cookie信息为admin，才能够得到flag</p><p>admin<br>MD5：</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">21232f</span>297a57a5a743894a0e4a801fc3</span><br></pre></td></tr></table></figure><p>base64:</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MjEyMzJmMjk<span class="number">3</span>YTU<span class="number">3</span>YTVh<span class="symbol">NzQzODk0</span>YTBl<span class="symbol">NGE4</span>MDFmYzM=</span><br></pre></td></tr></table></figure><p>更改Cookie，重发，在响应里看到flag</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;暴跳老板&quot;&gt;&lt;a href=&quot;#暴跳老板&quot; class=&quot;headerlink&quot; title=&quot;暴跳老板&quot;&gt;&lt;/a&gt;暴跳老板&lt;/h2&gt;&lt;p&gt;随便输入内容，得到弹窗要以POST方式用Dear发邮件，抓包：&lt;br&gt;&lt;img src=&quot;/image/%E6%9A%B4%
      
    
    </summary>
    
      <category term="CTF" scheme="https://singlemindedt.github.io/categories/CTF/"/>
    
    
      <category term="Web" scheme="https://singlemindedt.github.io/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>最大子段和</title>
    <link href="https://singlemindedt.github.io/2019/09/24/%E6%9C%80%E5%A4%A7%E5%AD%90%E6%AE%B5%E5%92%8C/"/>
    <id>https://singlemindedt.github.io/2019/09/24/最大子段和/</id>
    <published>2019-09-24T14:18:31.000Z</published>
    <updated>2019-09-24T14:22:04.803Z</updated>
    
    <content type="html"><![CDATA[<h1 id="问题D：最大子段和"><a href="#问题D：最大子段和" class="headerlink" title="问题D：最大子段和"></a>问题D：最大子段和</h1><h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>给定n 个整体组成的序列a1，a2，… an，求子段和a i + a i + 1 + … + a j（子段可为空集）的替代。</p><h2 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h2><p>包含多组测试数据。第一行为一个整数T（1 &lt;= T &lt;= 20），代表测试数据个数。</p><p>每组测试数据第一行为一个整数n ，代表有n 个整数（1 &lt;= n &lt;= 10000）。</p><p>接下来一行有n 个数x（-1000 &lt;= x &lt;= 1000）。</p><h2 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h2><p>输出其对应的最大子段和。</p><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="symbol">2 </span>-<span class="number">11</span> <span class="number">4</span> <span class="number">13</span> -<span class="number">1</span> <span class="number">2</span></span><br></pre></td></tr></table></figure><h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">18</span></span><br></pre></td></tr></table></figure><h3 id="提示"><a href="#提示" class="headerlink" title="提示"></a>提示</h3><p>子段可为空集，答案为0</p><h2 id="代码："><a href="#代码：" class="headerlink" title="代码："></a>代码：</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxsum</span><span class="params">(<span class="keyword">int</span> b[],<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> tempsum=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> Maxsum=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">&#123;</span><br><span class="line">tempsum=(tempsum+b[i])&gt;b[i]?(tempsum+b[i]):b[i];</span><br><span class="line"><span class="keyword">if</span>(tempsum&gt;Maxsum)</span><br><span class="line">Maxsum=tempsum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> Maxsum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;T&gt;&gt;n)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">10000</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;a[i];</span><br><span class="line"><span class="keyword">int</span> SUM=maxsum(a,n);</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;SUM&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;问题D：最大子段和&quot;&gt;&lt;a href=&quot;#问题D：最大子段和&quot; class=&quot;headerlink&quot; title=&quot;问题D：最大子段和&quot;&gt;&lt;/a&gt;问题D：最大子段和&lt;/h1&gt;&lt;h2 id=&quot;题目描述&quot;&gt;&lt;a href=&quot;#题目描述&quot; class=&quot;headerli
      
    
    </summary>
    
      <category term="算法" scheme="https://singlemindedt.github.io/categories/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="算法" scheme="https://singlemindedt.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="动态规划" scheme="https://singlemindedt.github.io/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
  </entry>
  
  <entry>
    <title>汽水瓶</title>
    <link href="https://singlemindedt.github.io/2019/09/24/%E6%B1%BD%E6%B0%B4%E7%93%B6/"/>
    <id>https://singlemindedt.github.io/2019/09/24/汽水瓶/</id>
    <published>2019-09-24T09:41:42.000Z</published>
    <updated>2019-09-24T14:16:32.134Z</updated>
    
    <content type="html"><![CDATA[<h1 id="问题-E-汽水瓶【25】"><a href="#问题-E-汽水瓶【25】" class="headerlink" title="问题 E: 汽水瓶【25】"></a>问题 E: 汽水瓶【25】</h1><h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>有这样一道智力题：“某商店规定：三个空汽水瓶可以换一瓶汽水。小张手上有十个空汽水瓶，她最多可以换多少瓶汽水喝？”答案是5瓶，方法如下：先用9个空瓶子换3瓶汽水，喝掉3瓶满的，喝完以后4个空瓶子，用3个再换一瓶，喝掉这瓶满的，这时候剩2个空瓶子。然后你让老板先借给你一瓶汽水，喝掉这瓶满的，喝完以后用3个空瓶子换一瓶满的还给老板。如果小张手上有n个空汽水瓶，最多可以换多少瓶汽水喝？</p><h2 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h2><p>输入文件最多包含10组测试数据，每个数据占一行，仅包含一个正整数n(1≤n≤100)，表示小张手上的空汽水瓶数。n=0表示输入结束，你的程序不应当处理这一行。</p><h2 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h2><p>对于每组测试数据，输出一行，表示最多可以喝的汽水瓶数。如果一瓶也喝不到，输出 0</p><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="number">81</span></span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure><h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">40</span></span><br></pre></td></tr></table></figure><h2 id="代码："><a href="#代码：" class="headerlink" title="代码："></a>代码：</h2><p>```C++</p><p>#include<iostream><br>using namespace std;<br>int main()<br>{<br>    int n=0;<br>    while(cin&gt;&gt;n)<br>    {<br>        int m=0;//最多可喝<br>        if(n==0)<br>        {<br>        continue;<br>        }<br>        if(n==2)//第一次忘了这个初次n=2的情况<br>        {<br>        cout&lt;&lt;1&lt;&lt;endl;<br>        continue;//此处若无会多输出 0<br>        }<br>        else<br>        while(n&gt;2)<br>        {<br>            int bn=n;<br>            n=n/3+n%3;<br>            m+=bn/3;<br>            if(n==2)<br>            {<br>            m++;<br>            break;<br>            }<br>        }<br>        cout&lt;&lt;m&lt;&lt;endl;</iostream></p><pre><code>}return 0;</code></pre><p>}<br>/*由规律可得如下方法： </p><p>#include<iostream><br>using namespace std;<br>int main()<br>{<br>int num = 0;<br>    while (cin&gt;&gt;num)<br>        if (num == 0)<br>            continue;<br>        else<br>            cout&lt;&lt;num/2&lt;&lt;endl;//都是整除结果<br>    return 0;<br>}<br>*/ </iostream></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;问题-E-汽水瓶【25】&quot;&gt;&lt;a href=&quot;#问题-E-汽水瓶【25】&quot; class=&quot;headerlink&quot; title=&quot;问题 E: 汽水瓶【25】&quot;&gt;&lt;/a&gt;问题 E: 汽水瓶【25】&lt;/h1&gt;&lt;h2 id=&quot;题目描述&quot;&gt;&lt;a href=&quot;#题目描述&quot; c
      
    
    </summary>
    
      <category term="算法" scheme="https://singlemindedt.github.io/categories/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="算法" scheme="https://singlemindedt.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>最长公共子序列</title>
    <link href="https://singlemindedt.github.io/2019/09/24/%E6%9C%80%E9%95%BF%E5%85%AC%E5%85%B1%E5%AD%90%E5%BA%8F%E5%88%97/"/>
    <id>https://singlemindedt.github.io/2019/09/24/最长公共子序列/</id>
    <published>2019-09-24T08:02:54.000Z</published>
    <updated>2019-09-24T08:07:31.137Z</updated>
    
    <content type="html"><![CDATA[<h1 id="问题-A-最长公共子序列"><a href="#问题-A-最长公共子序列" class="headerlink" title="问题 A: 最长公共子序列"></a>问题 A: 最长公共子序列</h1><p>时间限制: 1 Sec  内存限制: 32 MB</p><h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>给你一个序列X和另一个序列Z，当Z中的所有元素都在X中存在，并且在X中的下标顺序是严格递增的，那么就把Z叫做X的子序列。<br>例如：Z=&lt;a,b,f,c&gt;是序列X=&lt;a,b,c,f,b,c&gt;的一个子序列，Z中的元素在X中的下标序列为&lt;1,2,4,6&gt;。<br>现给你两个序列X和Y，请问它们的最长公共子序列的长度是多少？</p><h3 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h3><p>输入包含多组测试数据。每组输入占一行，为两个字符串，由若干个空格分隔。每个字符串的长度不超过100。</p><h3 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h3><p>对于每组输入，输出两个字符串的最长公共子序列的长度。</p><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">abcfbc</span> <span class="string">abfcab</span></span><br><span class="line"><span class="attr">programming</span> <span class="string">contest </span></span><br><span class="line"><span class="attr">abcd</span> <span class="string">mnp</span></span><br></pre></td></tr></table></figure><h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure><p>代码：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">string</span> x;</span><br><span class="line"><span class="built_in">string</span> z;</span><br><span class="line"><span class="keyword">int</span> dp[<span class="number">105</span>][<span class="number">105</span>] =&#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;x&gt;&gt;z)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> len1 = x.size();<span class="comment">//8</span></span><br><span class="line"><span class="keyword">int</span> len2 = z.size();<span class="comment">//9</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">1</span>; i &lt;= len1; i++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j =<span class="number">1</span>; j &lt;=len2; j++)</span><br><span class="line"><span class="keyword">if</span>(x[i<span class="number">-1</span>]==z[j<span class="number">-1</span>])<span class="comment">//i,j&gt;0,xi=zj</span></span><br><span class="line">dp[i][j] =dp[i - <span class="number">1</span>][j - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">dp[i][j]= max(dp[i][j<span class="number">-1</span>], dp[i<span class="number">-1</span>][j]);<span class="comment">//i,j&gt;0,xi!=yj</span></span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;dp[len1][len2]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;问题-A-最长公共子序列&quot;&gt;&lt;a href=&quot;#问题-A-最长公共子序列&quot; class=&quot;headerlink&quot; title=&quot;问题 A: 最长公共子序列&quot;&gt;&lt;/a&gt;问题 A: 最长公共子序列&lt;/h1&gt;&lt;p&gt;时间限制: 1 Sec  内存限制: 32 MB&lt;/p&gt;
      
    
    </summary>
    
      <category term="算法" scheme="https://singlemindedt.github.io/categories/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="算法" scheme="https://singlemindedt.github.io/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="动态规划" scheme="https://singlemindedt.github.io/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
  </entry>
  
  <entry>
    <title>文件包含漏洞</title>
    <link href="https://singlemindedt.github.io/2019/09/24/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/"/>
    <id>https://singlemindedt.github.io/2019/09/24/文件包含漏洞/</id>
    <published>2019-09-23T16:13:50.000Z</published>
    <updated>2019-09-23T16:23:38.411Z</updated>
    
    <content type="html"><![CDATA[<p>php://filter（本地磁盘文件进行读取）<br>元封装器，设计用于”数据流打开”时的”筛选过滤”应用，对本地磁盘文件进行读写。</p><p>用法：</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?filename=php://<span class="built_in">filter</span>/<span class="built_in">convert</span>.base64-encode/resource=xxx.php </span><br><span class="line">?filename=php://<span class="built_in">filter</span>/<span class="built_in">read</span>=<span class="built_in">convert</span>.base64-encode/resource=xxx.php </span><br><span class="line">一样。</span><br></pre></td></tr></table></figure><p>条件：只是读取，需要开启 allow_url_fopen，不需要开启 allow_url_include；</p><p>MOCTF上这道文件包含题，直接</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">file</span>=php://<span class="built_in">filter</span>/<span class="built_in">convert</span>.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><p>得到一串base64编码解码得到flag</p><p>关于<a href="https://www.freebuf.com/articles/web/182280.html" target="_blank" rel="noopener">文件包含漏洞</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;php://filter（本地磁盘文件进行读取）&lt;br&gt;元封装器，设计用于”数据流打开”时的”筛选过滤”应用，对本地磁盘文件进行读写。&lt;/p&gt;
&lt;p&gt;用法：&lt;/p&gt;
&lt;figure class=&quot;highlight livecodeserver&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;t
      
    
    </summary>
    
      <category term="CTF" scheme="https://singlemindedt.github.io/categories/CTF/"/>
    
    
      <category term="CTF" scheme="https://singlemindedt.github.io/tags/CTF/"/>
    
      <category term="Web" scheme="https://singlemindedt.github.io/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>NewsCenter</title>
    <link href="https://singlemindedt.github.io/2019/09/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B9%8BWeb%E9%AB%98%E6%89%8B%E8%BF%9B%E9%98%B6-NewsCenter/"/>
    <id>https://singlemindedt.github.io/2019/09/10/攻防世界之Web高手进阶-NewsCenter/</id>
    <published>2019-09-10T15:45:00.000Z</published>
    <updated>2019-09-27T15:42:02.629Z</updated>
    
    <content type="html"><![CDATA[<p>打开链接，出现如下页面：<br><img src="https://dev.tencent.com/u/Single-minded_T/p/Single-minded_T/git/raw/master/images/N1.PNG" alt="N1"></p><p>尝试是否为sql注入：<br>抓包：<br><img src="https://dev.tencent.com/u/Single-minded_T/p/Single-minded_T/git/raw/master/images/N0.PNG" alt="N0"><br>利用sqlmap,</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;打开链接，出现如下页面：&lt;br&gt;&lt;img src=&quot;https://dev.tencent.com/u/Single-minded_T/p/Single-minded_T/git/raw/master/images/N1.PNG&quot; alt=&quot;N1&quot;&gt;&lt;/p&gt;
&lt;p&gt;尝试是否
      
    
    </summary>
    
      <category term="Writeup" scheme="https://singlemindedt.github.io/categories/Writeup/"/>
    
      <category term="Web" scheme="https://singlemindedt.github.io/categories/Writeup/Web/"/>
    
    
      <category term="Web" scheme="https://singlemindedt.github.io/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>ics-06</title>
    <link href="https://singlemindedt.github.io/2019/09/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B9%8BWeb%E9%AB%98%E6%89%8B%E8%BF%9B%E9%98%B6-ics-06/"/>
    <id>https://singlemindedt.github.io/2019/09/10/攻防世界之Web高手进阶-ics-06/</id>
    <published>2019-09-10T09:00:00.000Z</published>
    <updated>2019-09-10T15:45:13.006Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题目描述："><a href="#题目描述：" class="headerlink" title="题目描述："></a>题目描述：</h2><p>云平台报表中心收集了设备管理基础服务的数据，但是数据被删除了，只有一处留下了入侵者的痕迹。<br><img src="/images/ics1.png" alt><br>进入页面只有报表中心可以点击，有一个输入框，各种fuzzing，没成功，后来才知道直接爆破就行。。。<br><img src="/images/ics2.png" alt></p><p>关于<a href="http://single-minded_t.coding.me/2019/09/05/攻防世界之Web新手（7-12）/" target="_blank" rel="noopener">爆破</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;题目描述：&quot;&gt;&lt;a href=&quot;#题目描述：&quot; class=&quot;headerlink&quot; title=&quot;题目描述：&quot;&gt;&lt;/a&gt;题目描述：&lt;/h2&gt;&lt;p&gt;云平台报表中心收集了设备管理基础服务的数据，但是数据被删除了，只有一处留下了入侵者的痕迹。&lt;br&gt;&lt;img src=
      
    
    </summary>
    
      <category term="Writeup" scheme="https://singlemindedt.github.io/categories/Writeup/"/>
    
      <category term="Web" scheme="https://singlemindedt.github.io/categories/Writeup/Web/"/>
    
    
      <category term="Web" scheme="https://singlemindedt.github.io/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>Cat</title>
    <link href="https://singlemindedt.github.io/2019/09/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B9%8BWeb%E9%AB%98%E6%89%8B%E8%BF%9B%E9%98%B6-cat/"/>
    <id>https://singlemindedt.github.io/2019/09/10/攻防世界之Web高手进阶-cat/</id>
    <published>2019-09-09T16:00:00.000Z</published>
    <updated>2019-09-10T14:49:06.470Z</updated>
    
    <content type="html"><![CDATA[<p>仅给出了这样一个页面：<br><img src="/images/cat1.png" alt="cat1"></p><p>输入cat，得到：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PING cat.ad-world-<span class="number">198302431</span>-<span class="number">4658</span>.rancher.internal (<span class="number">10.42</span>.197.21) <span class="number">56</span>(<span class="number">84</span>) bytes of data.</span><br><span class="line"><span class="number">64</span> <span class="function">bytes from <span class="title">b4fccc7cf554</span> <span class="params">(<span class="number">10.42</span><span class="number">.197</span><span class="number">.21</span>)</span>: icmp_seq</span>=<span class="number">1</span> ttl=<span class="number">64</span> time=<span class="number">0.045</span> ms</span><br><span class="line"></span><br><span class="line">--- cat.ad-world-<span class="number">198302431</span>-<span class="number">4658</span>.rancher.internal ping statistics ---</span><br><span class="line"><span class="number">1</span> packets transmitted, <span class="number">1</span> received, <span class="number">0</span>% packet loss, time <span class="number">0</span>ms</span><br><span class="line">rtt min/avg/max/mdev = <span class="number">0.045</span>/<span class="number">0.045</span>/<span class="number">0.045</span>/<span class="number">0.000</span> ms</span><br></pre></td></tr></table></figure><p>并在URL中如此传参：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//111.198.29.45:35113/index.php?url=cat</span></span><br></pre></td></tr></table></figure><p>输入127.0.0.1：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PING <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> (<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>) <span class="number">56</span>(<span class="number">84</span>) bytes of data.</span><br><span class="line"><span class="number">64</span> bytes from <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>: icmp_seq=<span class="number">1</span> ttl=<span class="number">64</span> time=<span class="number">0.061</span> ms</span><br><span class="line"></span><br><span class="line">--- <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> ping statistics ---</span><br><span class="line"><span class="number">1</span> packets transmitted, <span class="number">1</span> received, <span class="number">0</span>% packet loss, time <span class="number">0</span>ms</span><br><span class="line">rtt min/avg/max/mdev = <span class="number">0.061</span>/<span class="number">0.061</span>/<span class="number">0.061</span>/<span class="number">0.000</span> ms</span><br></pre></td></tr></table></figure><p>尝试使用命令连接符/管道命令，均被屏蔽；<br>目前仅知道，输入框通过用户输入进行<del>GET方式传参</del>；(此处请跳转文末 orz)<br>那么只能从url入手了，看看有没有可能爆出一些有用的信息；<br>测试发现超过ASCll可打印字符之外的url编码都会报错，比如键入<a href="http://111.198.29.45:35113/index.php?url=%8c" target="_blank" rel="noopener">http://111.198.29.45:35113/index.php?url=%8c</a> ：<br>给出报错信息：<br><img src="/images/cat2.png" alt="cat2"><br>可以明显看到使用的是Django框架；</p><p>查看配置文件信息：<a href="https://www.shiyanlou.com/questions/23602/" target="_blank" rel="noopener">settings.py</a><br><img src="/images/cat7.png" alt="cat7"><br>在报错信息中搜索database，发现的到有关数据库内容：<br><img src="/images/cat3.png" alt="cat3"><br>参考：<img src="/images/cat4.png" alt><br>通过<a href="http://111.198.29.45:35113/index.php?url=@/opt/api/database.sqlite3" target="_blank" rel="noopener">http://111.198.29.45:35113/index.php?url=@/opt/api/database.sqlite3</a> 得到数据库内容：<br>查找ctf关键字：</p><p><img src="/images/cat5.png" alt="cat5"></p><p><del>源码里就是GET啊，那这个又是啥？？？！</del><br>orz  orz  orz</p><p><img src="/images/cat6.png" alt="cat6"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;仅给出了这样一个页面：&lt;br&gt;&lt;img src=&quot;/images/cat1.png&quot; alt=&quot;cat1&quot;&gt;&lt;/p&gt;
&lt;p&gt;输入cat，得到：&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;
      
    
    </summary>
    
      <category term="Writeup" scheme="https://singlemindedt.github.io/categories/Writeup/"/>
    
      <category term="Web" scheme="https://singlemindedt.github.io/categories/Writeup/Web/"/>
    
    
      <category term="Web" scheme="https://singlemindedt.github.io/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>Win10安装pygame</title>
    <link href="https://singlemindedt.github.io/2019/09/09/pygame_install/"/>
    <id>https://singlemindedt.github.io/2019/09/09/pygame_install/</id>
    <published>2019-09-09T15:37:45.000Z</published>
    <updated>2019-09-10T08:33:21.440Z</updated>
    
    <content type="html"><![CDATA[<ol><li>检查pip是否安装，查看Python安装版本；<br><img src="/images/pygame0.png" alt></li></ol><p>2.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install wheel</span><br></pre></td></tr></table></figure><p><img src="/images/pygame1.png" alt></p><p>3.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install Pygame==<span class="number">1.9</span>.6</span><br></pre></td></tr></table></figure><p><img src="/images/pygame2.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ol&gt;
&lt;li&gt;检查pip是否安装，查看Python安装版本；&lt;br&gt;&lt;img src=&quot;/images/pygame0.png&quot; alt&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;2.&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td c
      
    
    </summary>
    
      <category term="notes" scheme="https://singlemindedt.github.io/categories/notes/"/>
    
    
      <category term="tools" scheme="https://singlemindedt.github.io/tags/tools/"/>
    
  </entry>
  
  <entry>
    <title>Byte CTF 字节跳动网络安全攻防大赛</title>
    <link href="https://singlemindedt.github.io/2019/09/09/Byte_CTF/"/>
    <id>https://singlemindedt.github.io/2019/09/09/Byte_CTF/</id>
    <published>2019-09-09T08:36:00.000Z</published>
    <updated>2019-09-09T08:42:09.927Z</updated>
    
    <content type="html"><![CDATA[<h1 id="betgame"><a href="#betgame" class="headerlink" title="betgame"></a>betgame</h1><p>给了提示，nc 112.125.25.81 9999</p><h2 id="知识补充："><a href="#知识补充：" class="headerlink" title="知识补充："></a>知识补充：</h2><p>nc即netcat，被誉为网络安全界的“瑞士军刀”。透过使用TCP或UDP协议的网络连接去读写数据。它被设计成一个稳定的后门(back-end)工具，能够直接由其它程序和脚本轻松驱动。同时，它也是一个功能强大的网络调试和探测工具，能够建立你需要的几乎所有类型的网络连接.</p><p>使用之前首先我们要弄明白netcat的工作原理,其实netcat的原理很简单,它就是从网络的一端读入数据,然后输出到网络的另一端,它可以使用tcp 和udp协议.之所以叫做netcat,因为它是网络上的cat,想象一下cat的功能,读出一个文件的内容,然后输出到屏幕上(默认的stdout是屏幕,当然可以重定向到其他地方).netcat也是如此,它读取一端的输入,然后传送到网络的另一端。ncat/nc 既是一个端口扫描工具，也是一款安全工具，还能是一款监测工具，甚至可以做为一个简单的 TCP 代理。<br><a href="https://blog.csdn.net/qq_26442553/article/details/79056683" target="_blank" rel="noopener">细节</a></p><h2 id="实际操作："><a href="#实际操作：" class="headerlink" title="实际操作："></a>实际操作：</h2><p>可以将nc作为聊天工具利用，本地server1上传nc 122.125.25.81 9999<br>Server2启动监听9999端口：nc -lp 9999<br>至此就可以简单交互，本题提示要30次全赢，找规律，对应输入即可；<br><img src="/images/betgame1.png" alt="a"></p><p><a href="https://blog.csdn.net/iteye_21199/article/details/82358749" target="_blank" rel="noopener">Linux nc命令详解</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;betgame&quot;&gt;&lt;a href=&quot;#betgame&quot; class=&quot;headerlink&quot; title=&quot;betgame&quot;&gt;&lt;/a&gt;betgame&lt;/h1&gt;&lt;p&gt;给了提示，nc 112.125.25.81 9999&lt;/p&gt;
&lt;h2 id=&quot;知识补充：&quot;&gt;&lt;a h
      
    
    </summary>
    
      <category term="Writeup" scheme="https://singlemindedt.github.io/categories/Writeup/"/>
    
    
      <category term="Misc" scheme="https://singlemindedt.github.io/tags/Misc/"/>
    
  </entry>
  
  <entry>
    <title>CTF中常见编码</title>
    <link href="https://singlemindedt.github.io/2019/09/08/CTF%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%BC%96%E7%A0%81%E6%80%BB%E7%BB%93/"/>
    <id>https://singlemindedt.github.io/2019/09/08/CTF中常见编码总结/</id>
    <published>2019-09-08T01:05:00.000Z</published>
    <updated>2019-09-08T11:03:39.953Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ASCII码表"><a href="#ASCII码表" class="headerlink" title="ASCII码表"></a>ASCII码表</h1><p>  ASCII（American Standard Code for Information Interchange，美国信息交换标准代码）是基于拉丁字母的一套电脑编码系统，主要用于显示现代英语和其他西欧语言。它是现今最通用的单字节编码系统，并等同于国际标准ISO/IEC 646。</p><h2 id="编码方法"><a href="#编码方法" class="headerlink" title="编码方法"></a>编码方法</h2><p>  因为1位二进制数可以表示（2^1=）2种状态：0、1；而2位二进制数可以表示（2^2）=4种状态：00、01、10、11；依次类推，7位二进制数可以表示（2^7=）128种状态，每种状态都唯一地编为一个7位的二进制码，对应一个字符（或控制码），这些码可以排列成一个十进制序号0～127。所以，7位ASCII码是用七位二进制数进行编码的，可以表示128个字符。<br>  第0～32号及第127号(共34个)是控制字符或通讯专用字符，如控制符：LF（换行）、CR（回车）、FF（换页）、DEL（删除）、BEL（振铃）等；通讯专用字符：SOH（文头）、EOT（文尾）、ACK（确认）等；</p><h2 id="ASCII码大致可以分作三部分组成："><a href="#ASCII码大致可以分作三部分组成：" class="headerlink" title="ASCII码大致可以分作三部分组成："></a>ASCII码大致可以分作三部分组成：</h2><p>第一部分是：<strong>ASCII非打印控制字符</strong><br>第二部分是：<strong>ASCII打印字符</strong><br>第三部分是：<strong>扩展ASCII打印字符</strong> </p><h3 id="第一部分：ASCII非打印控制字符表"><a href="#第一部分：ASCII非打印控制字符表" class="headerlink" title="第一部分：ASCII非打印控制字符表"></a>第一部分：ASCII非打印控制字符表</h3><p>ASCII表上的数字0–31分配给了控制字符，用于控制像打印机等一些外围设备。例如，12代表换页/新页功能。此命令指示打印机跳到下一页的开头。（参详ASCII码表中0-31）</p><h3 id="第二部分：ASCII打印字符"><a href="#第二部分：ASCII打印字符" class="headerlink" title="第二部分：ASCII打印字符"></a>第二部分：ASCII打印字符</h3><p>数字 32–126 分配给了能在键盘上找到的字符，当您查看或打印文档时就会出现。数字127代表 DELETE 命令。（参详ASCII码表中32-127）<br><img src="/images/ASCII.jpg" alt="ASCII"></p><h3 id="第三部分：扩展ASCII打印字符"><a href="#第三部分：扩展ASCII打印字符" class="headerlink" title="第三部分：扩展ASCII打印字符"></a>第三部分：扩展ASCII打印字符</h3><p>扩展的ASCII字符满足了对更多字符的需求。扩展的ASCII包含ASCII中已有的128个字符（数字0–32显示在下图中），又增加了128个字符，总共是256个。即使有了这些更多的字符，许多语言还是包含无法压缩到256个字符中的符号。因此，出现了一些ASCII的变体来囊括地区性字符和符号。例如，许多软件程序把ASCII表（又称作ISO8859-1）用于北美、西欧、澳大利亚和非洲的语言。<br><img src="/images/ascii127-255.jpg" alt="ascii127-255"></p><h2 id="特征特点："><a href="#特征特点：" class="headerlink" title="特征特点："></a>特征特点：</h2><p><strong>用1个字节的8位数来编码英文字符集，即所有字母数字等英文符号可以用二进制数、十进制、十六进制来表示。</strong></p><hr><h1 id="Unicode编码"><a href="#Unicode编码" class="headerlink" title="Unicode编码"></a>Unicode编码</h1><p>Unicode是一个编码方案，Unicode 是为了解决传统的字符编码方案的局限而产生的，它为每种语言中的每个字符设定了统一并且唯一的二进制编码，以满足跨语言、跨平台进行文本转换、处理的要求。<br>Unicode 编码共有三种具体实现，分别为<strong>utf-8</strong>,<strong>utf-16</strong>,<strong>utf-32</strong>，其中utf-8占用一到四个字节，utf-16占用二或四个字节，utf-32占用四个字节。</p><h2 id="UTF-8"><a href="#UTF-8" class="headerlink" title="UTF-8"></a>UTF-8</h2><p>UTF-8以字节为单位对Unicode进行编码。从Unicode到UTF-8的编码方式如下：<br>|Unicode编码(十六进制)|UTF-8 字节流(二进制)|<br>|:——–:|:————-:|<br>| 000000-00007F | 0xxxxxxx |<br>| 000080-0007FF | 110xxxxx 10xxxxxx |<br>| 000800-00FFFF | 1110xxxx 10xxxxxx 10xxxxxx|<br>| 010000-10FFFF |    11110xxx10xxxxxx10xxxxxx10xxxxxx|<br>UTF-8的特点是对不同范围的字符使用不同长度的编码。对于0x00-0x7F之间的字符，UTF-8编码与ASCII编码完全相同。UTF-8编码的最大长度是4个字节。从上表可以看出，4字节模板有21个x，即可以容纳21位二进制数字。Unicode的最大码位0x10FFFF也只有21位。</p><p><strong>例1：</strong>“汉”字的Unicode编码是0x6C49。0x6C49在0x0800-0xFFFF之间，使用3字节模板：1110xxxx 10xxxxxx 10xxxxxx。将0x6C49写成二进制是：0110 1100 0100 1001， 用这个比特流依次代替模板中的x，得到：11100110 10110001 10001001，即E6 B1 89。</p><p><strong>例2：</strong>Unicode编码0x20C30在0x010000-0x10FFFF之间，使用4字节模板：11110xxx 10xxxxxx 10xxxxxx 10xxxxxx。将0x20C30写成21位二进制数字（不足21位就在前面补0）：0 0010 0000 1100 0011 0000，用这个比特流依次代替模板中的x，得到：11110000 10100000 10110000 10110000，即F0 A0 B0 B0。</p><h2 id="UTF-8-UTF-32"><a href="#UTF-8-UTF-32" class="headerlink" title="[UTF-8\UTF-32]"></a>[UTF-8\UTF-32]</h2><p><a href="https://baike.baidu.com/item/Unicode/750500" target="_blank" rel="noopener">UTF-8\UTF-32</a></p><h2 id="Unicode一般有四种表示形式"><a href="#Unicode一般有四种表示形式" class="headerlink" title="Unicode一般有四种表示形式"></a>Unicode一般有四种表示形式</h2><table><thead><tr><th align="center">&amp;#x [Hex]</th><th align="center">&#x0054;&#x0068;&#x0065;</th></tr></thead><tbody><tr><td align="center">&amp;# [Decimal]</td><td align="center">&#00084;&#00104;&#00101;</td></tr><tr><td align="center">\U [Hex]</td><td align="center">\U0054\U0068\U0065</td></tr><tr><td align="center">\U+ [Hex]</td><td align="center">\U+0054\U+0068\U+0065</td></tr></tbody></table><h2 id="特征特点：-1"><a href="#特征特点：-1" class="headerlink" title="特征特点："></a>特征特点：</h2><p>国际标准字符，将全球的各种语言的每个字符定义一个唯一的编码，以满足跨语言、跨平台文本信息的转换，当编码和解码的字符集出现不一致的时候就会出现乱码。</p><hr><h1 id="URL编码"><a href="#URL编码" class="headerlink" title="URL编码"></a>URL编码</h1><p>url编码是一种浏览器用来打包表单输入的格式。浏览器从表单中获取所有的name和其中的值 ，将它们以name/value参数编码（移去那些不能传送的字符，将数据排行等等）作为URL的一部分或者分离地发给服务器。不管哪种情况，在服务器端的表单输入格式样子象这样：<br><strong>theName=Ichabod+Crane&amp;gender=male&amp;status=missing&amp; ;headless=yes</strong><br><strong>URL地址（常说网址）规定了常用地数字，字母可以直接使用，另外一批作为特殊用户字符也可以直接用（/,:@等），剩下的其它所有字符必须通过%后跟两位十六进制数来替换非ASCII字符。</strong></p><h2 id="编码规则"><a href="#编码规则" class="headerlink" title="编码规则"></a>编码规则</h2><p>URL编码遵循下列规则： 每对name/value由&amp;；符分开；每对来自表单的name/value由=符分开。如果用户没有输入值给这个name，那么这个name还是出现，只是无值。任何特殊的字符（就是那些不是简单的七位ASCII，如汉字）将以百分符%用十六进制编码，当然也包括象 =,&amp;；，和 % 这些特殊的字符。其实url编码就是一个字符ascii码的十六进制。不过稍微有些变动，需要在前面加上“%”。<br>比如：</p><ul><li>“\”，它的ascii码是92，92的十六进制是5c，所以“\”的url编码就是%5c。</li><li>空格字符，ascii 码是 32，对应16 进制是‘20’，那么 urlencode 编码结果是:%20。</li></ul><p>URL编码平时是用不到的，因为IE会自动将输入到地址栏的非数字字母转换为url编码。曾有人提出数据库名字里带上“#”以防止被下载，因为IE遇到#就会忽略后面的字母。破解方法很简单——<strong>用url编码%23替换掉#</strong>。</p><h2 id="特征特点：-2"><a href="#特征特点：-2" class="headerlink" title="特征特点："></a>特征特点：</h2><p>字符ASCII码的十六进制，并在前面加上%<br><img src="/images/URL.png" alt="URL"></p><p><a href="https://www.jianshu.com/p/6722d6fe1403" target="_blank" rel="noopener">URL原理、URL编码、URL特殊字符</a></p><hr><h1 id="base64编码"><a href="#base64编码" class="headerlink" title="base64编码"></a>base64编码</h1><p>Base64是网络上最常见的用于传输8Bit字节码的编码方式之一，Base64就是一种基于64个可打印字符来表示二进制数据的方法。</p><p>Base64编码是从二进制到字符的过程，可用于在HTTP环境下传递较长的标识信息。采用Base64编码具有不可读性，需要解码后才能阅读。</p><p>Base64由于以上优点被广泛应用于计算机的各个领域，然而由于输出内容中包括两个以上“符号类”字符（+, /, =)，不同的应用场景又分别研制了Base64的各种“变种”。为统一和规范化Base64的输出，Base62x被视为无符号化的改进版本。</p><p>Base64要求把每三个8Bit的字节转换为四个6Bit的字节（3<em>8 = 4</em>6 = 24），然后把6Bit再添两位高位0，组成四个8Bit的字节，也就是说，转换后的字符串理论上将要比原来的长1/3。</p><h2 id="特征："><a href="#特征：" class="headerlink" title="特征："></a>特征：</h2><p>密文由64个字符(A-Z,a-z,0-9,+,/)组成，末尾可能会出现1或2个’=’ 最多有2个 </p><h2 id="规则"><a href="#规则" class="headerlink" title="规则"></a>规则</h2><ol><li>把3个字节变成4个字节。</li><li>每76个字符加一个换行符。</li><li>最后的结束符也要处理。</li></ol><p><em>字符串转为2进制，每3个8位二进制转化为4个6位二进制，六位二进制转化为十进制，根据十进制数值在base64编码表中获取字符。Base64编码将串起来的二进制以6位进行分割.所以分切之前的二进制位数应该是24的倍数(即6,8的最小公倍数).如果不足24位,则在编码后数据后面添加”=”(=为填充字符)</em><br><strong>例子1</strong><br>转换前 11111111, 11111111, 11111111 （二进制）<br>转换后 00111111, 00111111, 00111111, 00111111 （二进制）<br>上面的三个字节是原文，下面的四个字节是转换后的Base64编码，其前两位均为0。<br>转换后，我们用一个码表来得到我们想要的字符串（也就是最终的Base64编码），这个表是这样的：（摘自RFC2045）<br>转换表：<br><img src="/images/base64.jpg" alt="base64"></p><p><strong>例子2</strong><br>转换前 10101101,10111010,01110110<br>转换后 00101011, 00011011 ,00101001 ,00110110<br>十进制 43 27 41 54<br>对应码表中的值 r b p 2<br>所以上面的24位编码，编码后的Base64值为 rbp2<br>解码同理，把 rbq2 的二进制位连接上再重组得到三个8位值，得出原码。</p><h1 id="base32编码"><a href="#base32编码" class="headerlink" title="base32编码"></a>base32编码</h1><p>Base32使用了ASCII编码中可打印的32个字符(大写字母A<del>Z和数字2</del>7)对任意字节数据进行编码.Base32将串起来的二进制数据按照5个二进制位分为一组,由于传输数据的单位是字节(即8个二进制位).所以分割之前的二进制位数是40的倍数(40是5和8的最小公倍数).如果不足40位,则在编码后数据补充”=”,一个”=”相当于一个组(5个二进制位),编码后的数据是原先的8\5倍.</p><h2 id="特征：密文由32个字符（A-Z-2-7-组成，末尾可能会有‘-’，但最多有6个"><a href="#特征：密文由32个字符（A-Z-2-7-组成，末尾可能会有‘-’，但最多有6个" class="headerlink" title="特征：密文由32个字符（A-Z,2-7)组成，末尾可能会有‘=’，但最多有6个"></a>特征：密文由32个字符（A-Z,2-7)组成，末尾可能会有‘=’，但最多有6个</h2><p><img src="/images/base32.jpg" alt="base32"></p><h1 id="base16"><a href="#base16" class="headerlink" title="base16"></a>base16</h1><p> base16是用16（2的4次方）个特定ASCII码表示256个ASCII字符。1个ASCII字符经过base16编码后会变为2个字符，长度增加一倍。</p><p>将数据转换为二进制数，不足8比特位高位补0.然后将所有的二进制全部串起来,4个二进制位为一组,转化成对应十进制数,根据十进制数值找到Base16编码表里面对应的字符.Base16是4个比特位表示一个字符,所以原始是1个字节(8个比特位)刚好可以分成两组,也就是说原先如果使用ASCII编码后的一个字符,现在转化成两个字符.数据量是原先的2倍,不需要补’=’</p><h2 id="特征：密文由16个字符（0-9-A-F）组成"><a href="#特征：密文由16个字符（0-9-A-F）组成" class="headerlink" title="特征：密文由16个字符（0-9,A-F）组成"></a>特征：密文由16个字符（0-9,A-F）组成</h2><table><thead><tr><th align="center">数值</th><th align="center">0</th><th align="center">1</th><th align="center">2</th><th align="center">3</th><th align="center">4</th><th align="center">5</th><th align="center">6</th><th align="center">7</th><th align="center">8</th><th align="center">9</th><th align="center">10</th><th align="center">11</th><th align="center">12</th><th align="center">13</th><th align="center">14</th><th align="center">15</th></tr></thead><tbody><tr><td align="center">字符</td><td align="center">0</td><td align="center">1</td><td align="center">2</td><td align="center">3</td><td align="center">4</td><td align="center">5</td><td align="center">6</td><td align="center">7</td><td align="center">8</td><td align="center">9</td><td align="center">A</td><td align="center">B</td><td align="center">C</td><td align="center">D</td><td align="center">E</td><td align="center">F</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ASCII码表&quot;&gt;&lt;a href=&quot;#ASCII码表&quot; class=&quot;headerlink&quot; title=&quot;ASCII码表&quot;&gt;&lt;/a&gt;ASCII码表&lt;/h1&gt;&lt;p&gt;  ASCII（American Standard Code for Information Int
      
    
    </summary>
    
      <category term="CTF" scheme="https://singlemindedt.github.io/categories/CTF/"/>
    
    
      <category term="编码" scheme="https://singlemindedt.github.io/tags/%E7%BC%96%E7%A0%81/"/>
    
  </entry>
  
  <entry>
    <title>攻防世界之Web新手（7-12）</title>
    <link href="https://singlemindedt.github.io/2019/09/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B9%8BWeb%E6%96%B0%E6%89%8B%EF%BC%887-12%EF%BC%89/"/>
    <id>https://singlemindedt.github.io/2019/09/05/攻防世界之Web新手（7-12）/</id>
    <published>2019-09-05T13:09:03.000Z</published>
    <updated>2019-09-05T14:09:35.321Z</updated>
    
    <content type="html"><![CDATA[<h1 id="simple-js"><a href="#simple-js" class="headerlink" title="simple_js"></a>simple_js</h1><h2 id="题目描述："><a href="#题目描述：" class="headerlink" title="题目描述："></a>题目描述：</h2><p>小宁发现了一个网页，但却一直输不对密码。(Flag格式为 Cyberpeace{xxxxxxxxx} )<br>打开链接空白，查看源码，有如下代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">dechiffre</span><span class="params">(pass_enc)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> pass = <span class="string">"70,65,85,88,32,80,65,83,83,87,79,82,68,32,72,65,72,65"</span>;</span><br><span class="line">    <span class="keyword">var</span> tab = pass_enc.split(<span class="string">','</span>);</span><br><span class="line">    <span class="keyword">var</span> tab2 = pass.split(<span class="string">','</span>);</span><br><span class="line">    <span class="keyword">var</span> i, j, k, l = <span class="number">0</span>,</span><br><span class="line">        m, n, o, p = <span class="string">""</span>;</span><br><span class="line">    i = <span class="number">0</span>;</span><br><span class="line">    j = tab.length;</span><br><span class="line">    k = j + (l) + (n = <span class="number">0</span>);</span><br><span class="line">    n = tab2.length;</span><br><span class="line">    <span class="keyword">for</span> (i = (o = <span class="number">0</span>); i &lt; (k = j = n); i++) &#123;</span><br><span class="line">        o = tab[i - l];</span><br><span class="line">        p += String.fromCharCode((o = tab2[i]));</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">5</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = (o = <span class="number">0</span>); i &lt; (k = j = n); i++) &#123;</span><br><span class="line">        o = tab[i - l];</span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">5</span> &amp;&amp; i &lt; k - <span class="number">1</span>)</span><br><span class="line">            p += String.fromCharCode((o = tab2[i]));</span><br><span class="line">    &#125;</span><br><span class="line">    p += String.fromCharCode(tab2[<span class="number">17</span>]);</span><br><span class="line">    pass = p;</span><br><span class="line">    <span class="keyword">return</span> pass;</span><br><span class="line">&#125;</span><br><span class="line">String[<span class="string">"fromCharCode"</span>](dechiffre(</span><br><span class="line">    <span class="string">"\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30"</span></span><br><span class="line">));</span><br><span class="line"></span><br><span class="line">h = window.prompt(<span class="string">'Enter password'</span>);</span><br><span class="line">alert(dechiffre(h));</span><br></pre></td></tr></table></figure><p>这一长串16进制数很可疑，</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30"</span></span><br></pre></td></tr></table></figure><p>转字符得到：55,56,54,79,115,69,114,116,107,49,50<br>再将其转换为10进制ASCII码对应的字符得到 ：786OsErtk12<br>加上题目给出的格式得到flag（解码函数似乎不能得到正确密码//orz？）</p><hr><h1 id="xff-referer"><a href="#xff-referer" class="headerlink" title="xff_referer"></a>xff_referer</h1><h2 id="题目描述：-1"><a href="#题目描述：-1" class="headerlink" title="题目描述："></a>题目描述：</h2><p>X老师告诉小宁其实xff和referer是可以伪造的。<br>打开链接如图：<br><img src="/images/7.1.png" alt="1"></p><p>X-Forwarded-For和Referer<br><strong>XFF构造来源IP</strong><br><strong>Referer构造来源浏览器</strong><br>X-Forwarded-For:简称XFF头，它代表客户端，也就是HTTP的请求端真实的IP，只有在通过了HTTP 代理或者负载均衡服务器时才会添加该项<br>HTTP Referer是header的一部分，当浏览器向web服务器发送请求的时候，一般会带上Referer，告诉服务器我是从哪个页面链接过来的，服务器基此可以获得一些信息用于处理<br>利用bp抓包：<br><img src="/images/7.2.png" alt="1"></p><p>在HTTP头添加：X-Forwarded-For:123.123.123.123<br><img src="/images/7.3.png" alt="1"><br>得到下图提示：<br><img src="/images/7.4.png" alt="1"><br>再加一条Referer:<a href="https://www.google.com" target="_blank" rel="noopener">https://www.google.com</a> 得到flag。<br><img src="/images/7.5.png" alt="1"><br>由于每次添加都要重新输入，这里可以利用Repeater功能：<br><img src="/images/7.6.png" alt="1"><br>得到：<br><img src="/images/7.7.png" alt="1"><br>可以在左边直接编辑Request—&gt;右侧得到Response：<br><img src="/images/7.8.png" alt="1"><br>Response—&gt;Flag!<br><img src="/images/7.9.png" alt="1"></p><p>自己编辑的时候注意Target的格式：<br><img src="/images/7.10.png" alt="1"><br>去掉请求协议<strong>http://</strong><br><img src="/images/7.11.png" alt="1"></p><p><strong>URL与URI：<a href="https://blog.csdn.net/lslk9898/article/details/86490383" target="_blank" rel="noopener">https://blog.csdn.net/lslk9898/article/details/86490383</a></strong></p><hr><h1 id="weak-auth"><a href="#weak-auth" class="headerlink" title="weak_auth"></a>weak_auth</h1><h2 id="题目描述：-2"><a href="#题目描述：-2" class="headerlink" title="题目描述："></a>题目描述：</h2><p>小宁写了一个登陆验证页面，随手就设了一个密码。<br><img src="/images/8.png" alt="2"><br>根据弹窗的提示，用户名必须是admin<br>将usename设置为admin，随手！！！真的是随手，输了个123456，结果对了hhh :)<br><img src="/images/8.1.png" alt></p><p>—————————-正常解法———————-<br>用Burp Suite对它进行密码爆破，<br>可以先试着输入username=admin和password=11111,以确定爆破位置。<br>Action—&gt;send to Intruder<br><img src="/images/8.2.png" alt><br><strong>基本配置：</strong><br>1、在消息编辑器的上方，有一个下拉选择框，攻击类型（Attack Type），几种不同的方式，这里选择：<strong>集束炸弹模式（Cluster bomb）</strong> 它可以使用多组Payload集合，在每一个不同的Payload标志位置上（最多20个），依次遍历所有的Payload。它与草叉模式的主要区别在于，执行的Payload数据Payload组的乘积。举例来说，如果有两个Payload标志位置，第一个Payload值为A和B，第二个Payload值为C和D，则发起攻击时，将共发起四次攻击，第一次使用的Payload分别为A和C，第二次使用的Payload分别为A和D，第三次使用的Payload分别为B和C，第四次使用的Payload分别为B和D。<br><img src="/images/8.3.png" alt><br>2、由于username规定用admin；<br><strong>简单列表（Simple list）</strong> ——最简单的Payload类型，通过配置一个字符串列表作为Payload，也可以手工添加字符串列表或从文件加载字符串列表。其设置界面如下图<br><img src="/images/8.4.png" alt><br>3、导入密码list<br><img src="/images/8.5.png" alt></p><p>4、可选项设置（Options）<br>可选项设置主要包括请求消息头设置、请求引擎设置、攻击结果设置、grep match, grep extract, grep payloads,以及重定向设置。在使用中，你可以在攻击前进行设置，也可以在攻击过程中做这些选项的调整。<br><img src="/images/8.6.png" alt><br><strong>开始爆破：</strong><br><img src="/images/.png" alt><br>可以明显看到出现了长度不一样的响应，123456应该就是正确密码，查看Response得到Flag。<br><img src="/images/8.7.png" alt></p><hr><h1 id="webshell"><a href="#webshell" class="headerlink" title="webshell"></a>webshell</h1><h2 id="题目描述：-3"><a href="#题目描述：-3" class="headerlink" title="题目描述："></a>题目描述：</h2><p>小宁百度了php一句话,觉着很有意思,并且把它放在index.php里。<br><img src="/images/9.png" alt></p><h2 id="知识补充："><a href="#知识补充：" class="headerlink" title="知识补充："></a>知识补充：</h2><p>webshell就是以asp、php、jsp或者cgi等网页文件形式存在的<strong>一种命令执行环境</strong>，也可以将其称做为一种<strong>网页后门</strong>。黑客在入侵了一个网站后，通常会将asp或php后门文件与网站服务器WEB目录下正常的网页文件混在一起，然后就可以使用浏览器来访问asp或者php后门，得到一个命令执行环境，以达到控制网站服务器的目的。<br>顾名思义，“web”的含义是显然需要服务器开放web服务，“shell”的含义是取得对服务器某种程度上操作权限。<strong>webshell常常被称为入侵者通过网站端口对网站服务器的某种程度上操作的权限</strong>。由于webshell其大多是以动态脚本的形式出现，也有人称之为网站的后门工具。<br><a href="https://blog.csdn.net/Breeze_CAT/article/details/80044676" target="_blank" rel="noopener">上传木马拿webshell的方法汇总</a><br>图片给出的代码为php一句话木马：<strong><?php @eval($_POST['shell']);?></strong><br>一句话木马的工作原理：一句话木马分析服务端与客户端。</p><p>“一句话木马”服务端（是用于本地的html提交脚本木马文件）<br>就是我们要用来插入到asp文件中的asp语句，（不仅仅是以asp为后缀的数据库文件），该语句将回为触发，接收入侵者通过客户端提交的数据，执行并完成相应的操作，服务端的代码内容为 &lt;%execute request(“value”)%&gt; 其中value可以自己修改<br>“一句话木马”客户端（远程服务器上被插入一句话的asp可执行文件）<br>用来向服务端提交控制数据的，提交的数据通过服务端构成完整的asp功能语句并执行，也就是生成我们所需要的asp木马文件</p><ul><li>用中国菜刀或者蚁剑等工具可以上传或执行命令，密码是shell。</li></ul><p><img src="/images/9.1.png" alt><br>连接成功：<br><img src="/images/9.2.png" alt><br>选择双击：<br><img src="/images/9.3.png" alt><br>看到flag.txt,打开：<br><img src="/images/9.4.png" alt></p><hr><h1 id="command-execution"><a href="#command-execution" class="headerlink" title="command_execution"></a>command_execution</h1><h2 id="题目描述：-4"><a href="#题目描述：-4" class="headerlink" title="题目描述："></a>题目描述：</h2><p>小宁写了个ping功能,但没有写waf,X老师告诉她这是非常危险的，你知道为什么吗。</p><h2 id="知识补充：-1"><a href="#知识补充：-1" class="headerlink" title="知识补充："></a>知识补充：</h2><h3 id="1、ping-（网络诊断工具）"><a href="#1、ping-（网络诊断工具）" class="headerlink" title="1、ping （网络诊断工具）"></a>1、ping （网络诊断工具）</h3><p>Ping是Windows、Unix和Linux系统下的一个命令。ping也属于一个通信协议，是TCP/IP协议的一部分。利用“ping”命令可以检查网络是否连通，可以很好地帮助我们分析和判定网络故障。<br>应用格式：ping空格IP地址。<em>该命令还可以加许多参数使用，具体是键入ping按回车即可看到详细说明。</em><br>作为一个生活在网络上的管理员或者黑客来说，ping命令是第一个必须掌握的DOS命令，它所利用的原理是这样的：<strong>利用网络上机器IP地址的唯一性，给目标IP地址发送一个数据包，再要求对方返回一个同样大小的数据包来确定两台网络机器是否连接相通，时延是多少。</strong><br>ping指的是端对端连通，通常用来作为可用性的检查， 但是某些病毒木马会强行大量远程执行ping命令抢占你的网络资源，导致系统变慢，网速变慢。严禁ping入侵作为大多数防火墙的一个基本功能提供给用户进行选择。</p><h3 id="2、有关命令执行的知识"><a href="#2、有关命令执行的知识" class="headerlink" title="2、有关命令执行的知识"></a>2、有关命令执行的知识</h3><p>windows或linux下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">command1 &amp; command2 ：先执行command2后执行command1</span><br><span class="line">command1 &amp;&amp; command2 ：先执行command1后执行command2</span><br><span class="line">command1 | command2 ：只执行command2</span><br><span class="line">command1 || command2 ：command1执行失败，再执行command2(若command1执行成功，就不再执行command2)</span><br></pre></td></tr></table></figure><h3 id="3、WAF"><a href="#3、WAF" class="headerlink" title="3、WAF"></a>3、WAF</h3><p>Web应用防护系统（也称为：网站应用级入侵防御系统。英文：Web Application Firewall，简称： WAF）。利用国际上公认的一种说法：Web应用防火墙是通过执行一系列针对HTTP/HTTPS的安全策略来专门为Web应用提供保护的一款产品。<br>Web应用防火墙会对HTTP的请求进行异常检测，拒绝不符合HTTP标准的请求。并且，它也可以只允许HTTP协议的部分选项通过，从而减少攻击的影响范围。甚至，一些Web应用防火墙还可以严格限定HTTP协议中那些过于松散或未被完全制定的选项。<br>（<a href="https://www.waitalone.cn/waf-bypass-methods-and-reflection.html" target="_blank" rel="noopener">WAF绕过</a>）此题给出未开WAF，所以不用考虑这一步。</p><h3 id="4、还需要掌握一些常用的命令"><a href="#4、还需要掌握一些常用的命令" class="headerlink" title="4、还需要掌握一些常用的命令"></a>4、还需要掌握一些常用的命令</h3><p>ls 对于目录，该命令列出该目录下的所有子目录与文件。对于文件，将列出文件名以及其他信息。<br>Cd 改变工作目录，将当前工作目录改变到指定的目录下。<br>cat是打印文件内容<br>tac 是反向打印<br>less 文件名：分页显示文件内容（如less /etc/passwd）<br>Find 沿着文件层次结构向下遍历，匹配符合条件的文件，并执行相应操作。<br>关于find可以参考：<a href="https://www.jianshu.com/p/16af649d9b6d" target="_blank" rel="noopener">https://www.jianshu.com/p/16af649d9b6d</a><br>*&lt;利用截断来执行行的命令，如’$’ 和 ‘ ; ‘和 ‘|’ 和 ‘-‘ 和 ‘(‘ 和 ‘ ) ‘ 和 ‘ “ ‘ 和 ‘||’ 和’&amp;&amp;’ 和 ‘&amp;’ 和 ‘{‘ 和 ‘}’等&gt;*<br>实际操作：<br><img src="/images/.2.png" alt><br><img src="/images/.2.1png" alt></p><p>试着使用命令连接符，查看目录<br><img src="/images/2.2.png" alt><br><img src="/images/2.3.png" alt><br>发现有home目录，看看里面有啥：<br><img src="/images/2.4.png" alt><br>发现有flag.txt;或者直接根据文件名或正则表达式进行搜索，如下：<br><img src="/images/2.5.png" alt><br>得到flag.txt在home下，cat一下：<br><img src="/images/2.6.png" alt></p><p>同时这道题，查看代码可以发现：POST传参是通过参数target，而target就是我们所要输入的值<br><img src="/images/2.7.png" alt><br>尝试post传值：<br><img src="/images/2.8.png" alt><br>得到flag:<br><img src="/images/2.9.png" alt><br><img src="/images/2.10.png" alt></p><hr><h1 id="simple-php"><a href="#simple-php" class="headerlink" title="simple_php"></a>simple_php</h1><p>##题目描述：<br>小宁听说php是最好的语言,于是她简单学习之后写了几行php代码。<br>打开链接：<br><img src="/images/3.png" alt><br>很简单的PHP代码：a要等于0，又不能等于0；b不能是数字，但还要大于1234</p><p><em>is_numeric（）来函数用于检测变量是否为数字或数字字符串。</em><br><em>如果指定的变量是数字和数字字符串则返回TRUE，否则返回FALSE。</em></p><p>此处靠php弱类型比较：可查看我的这篇博文<br>构造如下url:<br><img src="/images/3.1.png" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;simple-js&quot;&gt;&lt;a href=&quot;#simple-js&quot; class=&quot;headerlink&quot; title=&quot;simple_js&quot;&gt;&lt;/a&gt;simple_js&lt;/h1&gt;&lt;h2 id=&quot;题目描述：&quot;&gt;&lt;a href=&quot;#题目描述：&quot; class=&quot;header
      
    
    </summary>
    
      <category term="CTF" scheme="https://singlemindedt.github.io/categories/CTF/"/>
    
      <category term="Web" scheme="https://singlemindedt.github.io/categories/CTF/Web/"/>
    
    
      <category term="Web" scheme="https://singlemindedt.github.io/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>Images</title>
    <link href="https://singlemindedt.github.io/2019/09/04/images/"/>
    <id>https://singlemindedt.github.io/2019/09/04/images/</id>
    <published>2019-09-04T09:37:45.000Z</published>
    <updated>2019-09-05T14:33:05.157Z</updated>
    
    <content type="html"><![CDATA[<p>Inset demo …</p><p><img src="1.jpg" alt="demo"><br><img src="im/1.jpg" alt="demo"><br><img src="/images/1.jpg" alt="success"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Inset demo …&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;1.jpg&quot; alt=&quot;demo&quot;&gt;&lt;br&gt;&lt;img src=&quot;im/1.jpg&quot; alt=&quot;demo&quot;&gt;&lt;br&gt;&lt;img src=&quot;/images/1.jpg&quot; alt=&quot;success&quot;&gt;&lt;/p&gt;

      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>攻防世界之Web新手（1-6）</title>
    <link href="https://singlemindedt.github.io/2019/09/04/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E4%B9%8BWeb%E6%96%B0%E6%89%8B%EF%BC%881-6%EF%BC%89/"/>
    <id>https://singlemindedt.github.io/2019/09/04/攻防世界之Web新手（1-6）/</id>
    <published>2019-09-04T07:11:48.415Z</published>
    <updated>2019-09-04T09:49:49.710Z</updated>
    
    <content type="html"><![CDATA[<h1 id="view-source"><a href="#view-source" class="headerlink" title="view_source"></a>view_source</h1><h2 id="题目描述："><a href="#题目描述：" class="headerlink" title="题目描述："></a>题目描述：</h2><p>X老师让小宁同学查看一个网页的源代码，但小宁同学发现鼠标右键好像不管用了。<br>打开链接如下：<br><img src="http://wx1.sinaimg.cn/mw690/0070Pzw7gy1g6nlcr015bj30g7062dfx.jpg" alt="1"><br>试试右键的确不管用了，直接F12，找到flag<br><img src="http://wx4.sinaimg.cn/mw690/0070Pzw7gy1g6nlc0awuuj30kc067wvy.jpg" alt="2"></p><p>另外还可以通过view-source：url查看源代码：<br><img src="http://wx3.sinaimg.cn/mw690/0070Pzw7gy1g6nlcvm0hgj30lq0cg3yt.jpg" alt="3"></p><p>其实还可以禁用Js代码，这样右键就可以用了：<br><img src="http://wx4.sinaimg.cn/mw690/0070Pzw7gy1g6nlczbhbwj30pn08b74w.jpg" alt="4"></p><hr><h1 id="get-post"><a href="#get-post" class="headerlink" title="get_post"></a>get_post</h1><h2 id="题目描述：-1"><a href="#题目描述：-1" class="headerlink" title="题目描述："></a>题目描述：</h2><p>X老师告诉小宁同学HTTP通常使用两种请求方法，你知道是哪两种吗？<br>知识补充：</p><h3 id="两种-HTTP-请求方法：GET-和-POST"><a href="#两种-HTTP-请求方法：GET-和-POST" class="headerlink" title="两种 HTTP 请求方法：GET 和 POST"></a>两种 HTTP 请求方法：GET 和 POST</h3><p>在客户机和服务器之间进行请求-响应时，两种最常被用到的方法是：GET 和 </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST。</span><br><span class="line">&#123;</span><br><span class="line">GET - 从指定的资源请求数据。</span><br><span class="line">POST - 向指定的资源提交要被处理的数据</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.w3school.com.cn/tags/html_ref_httpmethods.asp" target="_blank" rel="noopener">https://www.w3school.com.cn/tags/html_ref_httpmethods.asp</a> </p><p><a href="https://baijiahao.baidu.com/s?id=1620934682611653374&amp;wfr=spider&amp;for=pc" target="_blank" rel="noopener">https://baijiahao.baidu.com/s?id=1620934682611653374&amp;wfr=spider&amp;for=pc</a><br>实际操作：打开网址，得到如下要求<br><img src="https://img-blog.csdnimg.cn/20190904152016124.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjM4MDA2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>&lt;用GET给后端传参的方法是：在?后跟变量名字，不同的变量之间用&amp;隔开&gt;<br>在url后添加/？a=1即可发送get请求。</strong><br><img src="https://img-blog.csdnimg.cn/20190904152106943.png" alt="在这里插入图片描述"><br><strong>利用hackbar进行POST传参：复制get的url，选择postdata，填入b=2，选择execute。即可发送POST请求。</strong><br><img src="https://img-blog.csdnimg.cn/20190904152142555.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20190904152154319.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjM4MDA2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>关于GET 和 POST：<a href="https://www.cnblogs.com/williamjie/p/9099940.html" target="_blank" rel="noopener">https://www.cnblogs.com/williamjie/p/9099940.html</a></strong></p><hr><h1 id="Robots"><a href="#Robots" class="headerlink" title="Robots"></a>Robots</h1><h2 id="题目描述：-2"><a href="#题目描述：-2" class="headerlink" title="题目描述："></a>题目描述：</h2><p>X老师上课讲了Robots协议，小宁同学却上课打了瞌睡，赶紧来教教小宁Robots协议是什么吧。</p><h2 id="知识补充："><a href="#知识补充：" class="headerlink" title="知识补充："></a>知识补充：</h2><p>  <strong>robots.txt是搜索引擎中访问网站的时候要查看的第一个文件。robots.txt文件告诉蜘蛛程序在服务器上什么文件是可以被查看的。</strong><br>当一个搜索蜘蛛访问一个站点时，它会首先检查该站点根目录下是否存在robots.txt，如果存在，搜索机器人就会按照该文件中的内容来确定访问的范围；如果该文件不存在，所有的搜索蜘蛛将能够访问网站上所有没有被口令保护的页面。百度官方建议，仅当您的网站包含不希望被搜索引擎收录的内容时，才需要使用robots.txt文件。如果您希望搜索引擎收录网站上所有内容，请勿建立robots.txt文件。<br>如果将网站视为酒店里的一个房间，robots.txt就是主人在房间门口悬挂的“请勿打扰”或“欢迎打扫”的提示牌。这个文件告诉来访的搜索引擎哪些房间可以进入和参观，哪些房间因为存放贵重物品，或可能涉及住户及访客的隐私而不对搜索引擎开放。但robots.txt不是命令，也不是防火墙，如同守门人无法阻止窃贼等恶意闯入者。</p><p>Robots协议用来告知搜索引擎哪些页面能被抓取，哪些页面不能被抓取；可以屏蔽一些网站中比较大的文件，如：图片，音乐，视频等，节省服务器带宽；可以屏蔽站点的一些死链接。方便搜索引擎抓取网站内容；设置网站地图连接，方便引导蜘蛛爬取页面。<br>【<a href="https://blog.csdn.net/qq_40491569/article/details/83473703】" target="_blank" rel="noopener">https://blog.csdn.net/qq_40491569/article/details/83473703】</a></p><h3 id="实际操作："><a href="#实际操作：" class="headerlink" title="实际操作："></a>实际操作：</h3><p>打开网页空白；<br><img src="https://img-blog.csdnimg.cn/20190904152608276.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjM4MDA2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>在题URL后输入/robots.txt即：  <a href="http://111.198.29.45:35567/robots.txt" target="_blank" rel="noopener">http://111.198.29.45:35567/robots.txt</a><br><img src="https://img-blog.csdnimg.cn/20190904152620940.png" alt="在这里插入图片描述"><br>f1ag_1s_h3re.php这个页面不允许被爬取，查看一下f1ag_1s_h3re.php页面得到flag.<br><img src="https://img-blog.csdnimg.cn/2019090415264189.png" alt="在这里插入图片描述"></p><hr><h1 id="Backup"><a href="#Backup" class="headerlink" title="Backup"></a>Backup</h1><h2 id="题目描述：-3"><a href="#题目描述：-3" class="headerlink" title="题目描述："></a>题目描述：</h2><p>X老师忘记删除备份文件，他派小宁同学去把备份文件找出来,一起来帮小宁同学吧！<br><img src="https://img-blog.csdnimg.cn/20190904152903767.png" alt="在这里插入图片描述"><br><strong>备份文件:    bak（被自动或是通过命令创建的辅助文件，它包含某个文件的最近一个版本）</strong></p><p>试着在index.php后加.bak<br>得到index.php.bak的备份文件，打开得到flag</p><hr><h1 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h1><h2 id="知识补充：-1"><a href="#知识补充：-1" class="headerlink" title="知识补充："></a>知识补充：</h2><p>Cookie 可以翻译为“小甜品，小饼干”，Cookie 在网络系统中几乎无处不在，当我们浏览以前访问过的网站时，网页中可能会出现 ：你好 XXX，这会让我们感觉很亲切，就好像吃了一个小甜品一样。这其实是通过访问主机中的一个文件来实现的，这个文件就是 Cookie。在 Internet 中，<strong>Cookie 实际上是指小量信息，是由Web服务器创建的，将信息存储在用户计算机上的文件。一般网络用户习惯用其复数形式 Cookies，指某些网站为了辨别用户身份、进行Session 跟踪而存储在用户本地终端上的数据，而这些数据通常会经过加密处理。<br>其实cookies是由网络服务器存储在你电脑硬盘上的一个txt类型的小文件，它和你的网络浏览行为有关，所以存储在你电脑上的cookies就好像你的一张身份证，你电脑上的cookies和其他电脑上的cookies是不一样的;cookies不能被视作代码执行</strong>，也不能成为病毒，所以它对你基本无害。<br>cookies的作用主要是，当你访问了某些网页，并且对网页的一些设置进行修改，cookies就能跟踪并记录到这些修改，当你下一次访问这个网页的时候，这个网页会分析你电脑上的cookies，进而采取措施像你返回更符合你个性化的网页;</p><p>　　当然，目前大部分广告的定位基础也是基于cookies的，比如你此前访问了大量的健身类网站，cookies记录了你的访问行为，广告主就能够根据你的访问行为，向你推送健身类的广告。</p><p>实际操作：利用开发者工具F12键—网络，查看消息头看到“Cookie look-here=cookie.php”<br><img src="https://img-blog.csdnimg.cn/2019090415314763.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20190904153157769.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjM4MDA2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>根据提示信息，在URL后加上”/cookie.php”即<a href="http://111.198.29.45:47420/cookie.php" target="_blank" rel="noopener">http://111.198.29.45:47420/cookie.php</a><br><img src="https://img-blog.csdnimg.cn/20190904153416901.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjM4MDA2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>提示查看HTTP响应，在消息头里发现flag。<br><img src="https://img-blog.csdnimg.cn/20190904153232157.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjM4MDA2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><hr><h1 id="disabled-button"><a href="#disabled-button" class="headerlink" title="disabled_button"></a>disabled_button</h1><h2 id="题目描述：-4"><a href="#题目描述：-4" class="headerlink" title="题目描述："></a>题目描述：</h2><p>X老师今天上课讲了前端知识，然后给了大家一个不能按的按钮，小宁惊奇地发现这个按钮按不下去，到底怎么才能按下去呢？</p><h2 id="知识补充：-2"><a href="#知识补充：-2" class="headerlink" title="知识补充："></a>知识补充：</h2><p>需要熟悉一些常见的HTML知识</p><h2 id="实际操作：-1"><a href="#实际操作：-1" class="headerlink" title="实际操作："></a>实际操作：</h2><p>右键-&gt;查看元素，在input中用了‘disabled=” “’属性，双击，将其删掉，按钮便可正常使用。<br><img src="https://img-blog.csdnimg.cn/20190904153647682.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjM4MDA2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20190904153656620.png" alt="在这里插入图片描述"></p><hr><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;view-source&quot;&gt;&lt;a href=&quot;#view-source&quot; class=&quot;headerlink&quot; title=&quot;view_source&quot;&gt;&lt;/a&gt;view_source&lt;/h1&gt;&lt;h2 id=&quot;题目描述：&quot;&gt;&lt;a href=&quot;#题目描述：&quot; class
      
    
    </summary>
    
      <category term="CTF" scheme="https://singlemindedt.github.io/categories/CTF/"/>
    
      <category term="Web" scheme="https://singlemindedt.github.io/categories/CTF/Web/"/>
    
    
      <category term="Web" scheme="https://singlemindedt.github.io/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>代码审计</title>
    <link href="https://singlemindedt.github.io/2019/09/03/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1ONE/"/>
    <id>https://singlemindedt.github.io/2019/09/03/代码审计ONE/</id>
    <published>2019-09-03T14:35:18.000Z</published>
    <updated>2019-09-04T08:46:22.694Z</updated>
    
    <content type="html"><![CDATA[<h1 id="PHP大法"><a href="#PHP大法" class="headerlink" title="PHP大法"></a>PHP大法</h1><p>（来源：实验吧  解题链接： <a href="http://ctf5.shiyanbar.com/DUTCTF/index.php）" target="_blank" rel="noopener">http://ctf5.shiyanbar.com/DUTCTF/index.php）</a><br><img src="https://img-blog.csdnimg.cn/20190903224633314.png" alt="在这里插入图片描述"><br>点开链接只有如上一句话。<br>根据提示 直接访问： index.php.txt<br>        （即：<a href="http://ctf5.shiyanbar.com/DUTCTF/index.php.txt）" target="_blank" rel="noopener">http://ctf5.shiyanbar.com/DUTCTF/index.php.txt）</a><br>得到如下页面：<br><img src="https://img-blog.csdnimg.cn/20190903224649753.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjM4MDA2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>分析代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">if</span>(eregi(<span class="string">"hackerDJ"</span>,$_GET[id])) &#123;      <span class="comment">//对id进行字符串匹配，若$_GET[id]中有hacker DJ则</span></span><br><span class="line">    <span class="comment">//出not allowed!并终止正在执行的进程;</span></span><br><span class="line">      <span class="keyword">echo</span>(<span class="string">"&lt;p&gt;not allowed!&lt;/p&gt;"</span>);</span><br><span class="line">      <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    $_GET[id] = urldecode($_GET[id]);    <span class="comment">//urldecode对字符串进行URL解码;将解码后的//$_GET[id]赋值给$_GET[id];</span></span><br><span class="line">    <span class="keyword">if</span>($_GET[id] == <span class="string">"hackerDJ"</span>)            <span class="comment">//若$_GET[id]的值等于hackerDJ，输出Access granted! //并给出flag: *****************&#125;</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">"&lt;p&gt;Access granted!&lt;/p&gt;"</span>;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">"&lt;p&gt;flag: *****************&#125; &lt;/p&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;br&gt;&lt;br&gt;</span><br><span class="line">Can you authenticate to this website?</span><br></pre></td></tr></table></figure><hr>   <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$_GET</span><br><span class="line">说明</span><br><span class="line">通过 URL 参数传递给当前脚本的变量的数组</span><br><span class="line">Example <span class="comment">#1$_GET范例</span></span><br><span class="line">     <span class="meta">&lt;?php</span>          <span class="keyword">echo</span> <span class="string">'Hello '</span> . htmlspecialchars($_GET[<span class="string">"name"</span>]) . <span class="string">'!'</span>;     <span class="meta">?&gt;</span></span><br><span class="line">假设用户访问的是 http:<span class="comment">//example.com/?name=Hannes</span></span><br><span class="line">以上例程的输出类似于：</span><br><span class="line">                       Hello Hannes!</span><br></pre></td></tr></table></figure><h2 id="解题思路："><a href="#解题思路：" class="headerlink" title="解题思路："></a>解题思路：</h2><p>有$_GET[id] 所以应该是可以用 ?id= 来构造URL<br>id变量是一个url解码函数前不包含hackerDJ，url解码函数后为hackerDJ的变量，即id在进入url解码函数前必须是hackerDJ的url编码形式</p><p> <strong>注意：</strong>由于在浏览器输入url后会进行一次decode，这段代码中又进行一次decode，所以应对hackerDJ进行两次encode。只进行一次encode，浏览器自动解码后即为hackerDJ,被eregi()拦住，所以要进行二次编码，即对%68%61%63%6B%65%72%44%4A进行url编码。</p><p>①　<a href="http://ctf5.shiyanbar.com/DUTCTF/index.php?id=%68%61%63%6B%65%72%44%4A" target="_blank" rel="noopener">http://ctf5.shiyanbar.com/DUTCTF/index.php?id=%68%61%63%6B%65%72%44%4A</a></p><p>②　<a href="http://ctf5.shiyanbar.com/DUTCTF/index.php?id=%25%36%38%25%36%31%25%36%33%25%36%42%25%36%35%25%37%32%25%34%34%25%34%41" target="_blank" rel="noopener">http://ctf5.shiyanbar.com/DUTCTF/index.php?id=%25%36%38%25%36%31%25%36%33%25%36%42%25%36%35%25%37%32%25%34%34%25%34%41</a> </p><p>或者直接对其中的一个字母进行二次编码： h –&gt; %68 –&gt; %2568<br>构造url: index.php?id=%2568ackerDJ</p><hr><h1 id="Very-easy"><a href="#Very-easy" class="headerlink" title="Very easy"></a>Very easy</h1><p>打开链接直接得到如下代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$what=$_GET[<span class="string">'what'</span>];</span><br><span class="line"><span class="keyword">echo</span> $what;</span><br><span class="line"><span class="keyword">if</span>($what==<span class="string">'flag'</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'flag&#123;****&#125;'</span>;</span><br></pre></td></tr></table></figure><p>分析：如果$what等于flag,则给出flag。<br>解决：<a href="http://123.206.87.240:8002/get/?what=flag" target="_blank" rel="noopener">http://123.206.87.240:8002/get/?what=flag</a> 得到flag。</p><hr><h1 id="Experiment-1"><a href="#Experiment-1" class="headerlink" title="Experiment 1"></a>Experiment 1</h1><p>打开链接直接出现PHP代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">include</span> <span class="string">"flag.php"</span>;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'money'</span>])) &#123;</span><br><span class="line">        $money=$_GET[<span class="string">'money'</span>];</span><br><span class="line">        <span class="keyword">if</span>(strlen($money)&lt;=<span class="number">4</span>&amp;&amp;$money&gt;time()&amp;&amp;!is_array($money))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;!--By:daoyuan--&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">"Wrong Answer!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">"Wrong Answer!"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="代码分析："><a href="#代码分析：" class="headerlink" title="代码分析："></a>代码分析：</h2><p>第一行:告诉我们flag应该就在flag.php中<br>第二行：highlight_file() 函数对文件进行 PHP 语法高亮显示。语法通过使用 HTML 标签进行高亮。</p><p>提示：用于高亮的颜色可通过 php.ini 文件进行设置或者通过调用 ini_set() 函数进行设置。</p><p>注释：当使用该函数时，整个文件都将被显示，包括密码和其他敏感信息！</p><p><strong>语法：highlight_file(filename,return)</strong><br><strong>filename    必需。规定要显示的文件。</strong><br><strong>return    可选。</strong><br>如果该参数设置为 TRUE，该函数将以字符串形式返回高亮显示的代码，而不是直接进行输出。<br>默认是 FALSE。<br>返回值<br>如果 return 参数设置为 TRUE，该函数将以字符串形式返回高亮显示的代码，而不是直接进行输出。<br>否则，如果成功则返回 TRUE，如果失败则返回 FALSE。<br><strong>If条件：$money的长度&lt;=4；同时&gt;time()；同时不是数组</strong><br>{<br>time() 函数返回自 Unix 纪元（January 1 1970 00:00:00 GMT）起的当前时间的秒数。<strong>此处我们直接将其理解为一个很大的数</strong><br>}<br>==PHP中，字符串开头以xex开头，x代表数字。会被转换成科学计数法。  如1e9 == 1×10^9==<br><strong>解决：直接用xex格式如：<a href="http://119.23.73.3:5001/web6/?money=10e9" target="_blank" rel="noopener">http://119.23.73.3:5001/web6/?money=10e9</a>  直接得到flag</strong></p><hr><h1 id="Experiment-2"><a href="#Experiment-2" class="headerlink" title="Experiment 2"></a>Experiment 2</h1><p>打开链接页面中只有一句话“好像少了点什么”，试着在url后添加<strong>index.php~</strong><br>即<a href="http://119.23.73.3:5001/web5/index.php~。" target="_blank" rel="noopener">http://119.23.73.3:5001/web5/index.php~。</a><br>打开页面发现什么都没有，查看源文件发现果然有PHP文件：</p><p><img src="https://img-blog.csdnimg.cn/20190903230150990.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjM4MDA2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h2 id="分析代码："><a href="#分析代码：" class="headerlink" title="分析代码："></a>分析代码：</h2><p>9：给出$flag的值为我们最终需要的结果</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moctf&#123;**************&#125;</span><br></pre></td></tr></table></figure><p>11：<br>{<br>PHP的isset()函数 一般用来检测变量是否设置<br>格式：bool isset ( mixed var [, mixed var [, …]] )<br>功能：检测变量是否设置<br>返回值：<br>若变量不存在则返回 FALSE<br>若变量存在且其值为NULL，也返回 FALSE<br>若变量存在且值不为NULL，则返回 TURE<br>同时检查多个变量时，每个单项都符合上一条要求时才返回 TRUE，否则结果为 FALSE<br>版本：PHP 3, PHP 4, PHP 5<br>更多说明：<br>使用 unset() 释放变量之后，它将不再是 isset()。<br>PHP函数isset()只能用于变量，传递任何其它参数都将造成解析错误。<br>检测常量是否已设置可使用 defined() 函数。<br>}</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">If</span>条件下对变量$_GET[<span class="string">'a'</span>]和$_GET[<span class="string">'b'</span>]赋值，并将其赋值给$a,$b.</span><br><span class="line">若$a等于$b则打印Wrong Answer!</span><br><span class="line">否则在条件md5($a)==md5($b)下给出$flag，否则打印Wrong Answer！</span><br><span class="line">**即此代码的意思时要我们对提供$a,$b使得其值不同，但MD5值相同。**</span><br></pre></td></tr></table></figure><p><strong>***弱类型比较——“==”类型转换的规则<br>1、字符串和数字比较，字符串会被转换成数字。  “admin”==0 (true)  admin被转换成数字，由于admin是字符串，转换失败，int(admin)=0，所以 比较结果是true。<br>2、混合字符串转换成数字，看字符串的第一个。  “1admin”==1      “2admin”==2<br>3、字符串开头以xex开头，x代表数字。会被转换成科学计数法。  1e9 == 1×10^9</strong></p><p>注：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"admin1"</span>==<span class="number">1</span> <span class="comment">//false</span></span><br><span class="line"><span class="string">"admin1"</span>==<span class="number">0</span> <span class="comment">//true</span></span><br></pre></td></tr></table></figure><p>参考网上资料：<strong>当一个字符串当作一个数值来取值，其结果和类型如下:<br>如果该字符串没有包含’.’,’e’,’E’并且其数值值在整形的范围之内<br>则：该字符串被当作int来取值，其他所有情况下都被作为float来取值，该字符串的开始部分决定了它的值，如果该字符串以合法的数值开始，则使用该数值，否则其值为0。</strong></p><p><strong>所以我们可以直接找符合xex格式的MD5原参</strong><br>{MD5 算法自诞生之日起，就有很多人试图证明和发现它的不安全之处，即存在碰撞（在对两个不同的内容使用 MD5算法运算的时候，有可能得到一对相同的结果值）–百科}<br>md5的碰撞，在PHP的数的处理中，类似0开头的字符串会被转换成0，因此有md5碰撞。</p><p>MD5值(哈希值)相等的问题可以用哈希值碰撞，也可以用数组绕过，如：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`username[]=<span class="number">1</span>&amp;password[]=<span class="number">2.</span></span><br></pre></td></tr></table></figure><p>解决：<a href="http://119.23.73.3:5001/web5/**?a=QNKCDZO&amp;b=s878926199a" target="_blank" rel="noopener">http://119.23.73.3:5001/web5/**?a=QNKCDZO&amp;b=s878926199a</a>** ,直接得到flag。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md5(<span class="string">'**QNKCDZO**'</span>)==md5(<span class="string">'**s878926199a** '</span>)---&gt;True</span><br></pre></td></tr></table></figure><hr><h1 id="Experiment-2-1"><a href="#Experiment-2-1" class="headerlink" title="Experiment 2.1"></a>Experiment 2.1</h1><p>题目给出了php代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$flag = <span class="string">'flag&#123;test&#125;'</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'username'</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_GET[<span class="string">'password'</span>])) </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> ($_GET[<span class="string">'username'</span>] == $_GET[<span class="string">'password'</span>])</span><br><span class="line"><span class="keyword">print</span> <span class="string">'Your password can not be your username.'</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (md5($_GET[<span class="string">'username'</span>]) === md5($_GET[<span class="string">'password'</span>]))</span><br><span class="line"><span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'Invalid password'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="分析代码：-1"><a href="#分析代码：-1" class="headerlink" title="分析代码："></a>分析代码：</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">我们得构造$_GET[‘username’]和$GET[‘password’]的值不相等，同时它们的md5的值相等才能得到flag</span><br></pre></td></tr></table></figure><p>因为md5不能处理数组，可以使用数组绕过，md5(数组)会返回FALSE，username[]=1,password[]=2这样弱==下可以实现username!=password,同时会得到FALSE===FALSE使得md5(username)===md5(password)成立。<br>解决：<a href="http://123.206.87.240:9009/18.php?username[]=1&amp;password[]=2" target="_blank" rel="noopener">http://123.206.87.240:9009/18.php?username[]=1&amp;password[]=2</a> 直接得到flag。</p><hr><h1 id="Experiment-3"><a href="#Experiment-3" class="headerlink" title="Experiment 3"></a>Experiment 3</h1><p>打开链接得到：<br><img src="https://img-blog.csdnimg.cn/20190903231726221.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQwNjM4MDA2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>细细品味后发现“链接”下真有一个链接。点开得到php代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'v1'</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">'v2'</span>]) &amp;&amp; <span class="keyword">isset</span>($_GET[<span class="string">'v3'</span>]))&#123;</span><br><span class="line">$v1 = $_GET[<span class="string">'v1'</span>];</span><br><span class="line">$v2 = $_GET[<span class="string">'v2'</span>];</span><br><span class="line">$v3 = $_GET[<span class="string">'v3'</span>];</span><br><span class="line"><span class="keyword">if</span>($v1 != $v2 &amp;&amp; md5($v1) == md5($v2))&#123;</span><br><span class="line"><span class="keyword">if</span>(!strcmp($v3, $flag))&#123;</span><br><span class="line"><span class="keyword">echo</span> $flag;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="分析代码：-2"><a href="#分析代码：-2" class="headerlink" title="分析代码："></a>分析代码：</h2><p>v1不等于v2同时两者的MD5值相等<br><strong>&lt;此处既可以用MD5的0e漏洞也可以利用数组绕过&gt;</strong><br>由if(!strcmp(v3,flag))需要v3和flag值相同才返回flag的值</p><h3 id="strcmp漏洞"><a href="#strcmp漏洞" class="headerlink" title="strcmp漏洞"></a>strcmp漏洞</h3><p>int strcmp ( string str1,stringstr2 )<br>str1是第一个字符串，str2是第二个字符串。如果 str1 小于 str2 返回 &lt; 0； 如果 str1 大于 str2 返回 &gt; 0；如果两者相等，返回 0。</p><p>但是如果我们传入非字符串类型的数据的时候，这个函数将发生错误，在5.3之前的php中，显示了报错的警告信息后，将return 0 ! 也就是虽然报了错，但却判定其相等了。</p><p>因此，解这道题，就只要传入一个非字符串类型的变量使其报错，又由于前面的否定“！”得到true。<br>解决：<a href="http://123.206.31.85:49162/?v1[]=1&amp;v2[]=2&amp;v3[]=1" target="_blank" rel="noopener">http://123.206.31.85:49162/?v1[]=1&amp;v2[]=2&amp;v3[]=1</a> </p><hr><h1 id="Experiment-3-2"><a href="#Experiment-3-2" class="headerlink" title="Experiment 3.2"></a>Experiment 3.2</h1><p>打开链接得到空页，根据给出的php代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$flag = <span class="string">"flag&#123;xxxxx&#125;"</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'a'</span>])) &#123;</span><br><span class="line"><span class="keyword">if</span> (strcmp($_GET[<span class="string">'a'</span>], $flag) == <span class="number">0</span>) </span><br><span class="line"><span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'No'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="分析代码：-3"><a href="#分析代码：-3" class="headerlink" title="分析代码："></a>分析代码：</h2><p>  第一行，flag变量被设置为flag{xxxxx}。这并不是我们要提交的flag，真实运行的后端中的flag变量才是真的flag。<br>  第二行，isset函数判断HTTP GET请求中的参数a是否已设置并且非NULL。strcmp函数将a参数与flag相比较，如果一致，则调用die函数。die函数的作用是打印die函数的参数，并立即停止该php后端的运行。那么我们的目标很明显，就是要让php执行到die函数，显示flag。<br>根据上题<strong>strcmp漏洞</strong>，我们可以直接利用数组绕过比如用<strong>”a[]=”</strong><br>解决：<a href="http://123.206.87.240:9009/6.php?a[]=" target="_blank" rel="noopener">http://123.206.87.240:9009/6.php?a[]=</a> </p><hr><h1 id="ereg截断"><a href="#ereg截断" class="headerlink" title="ereg截断"></a>ereg截断</h1><p>打开链接同样是一个空白页面，根据给出的php代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$flag = <span class="string">"flag"</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'password'</span>])) &#123;</span><br><span class="line"><span class="keyword">if</span> (ereg (<span class="string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="string">'password'</span>]) === <span class="keyword">FALSE</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'You password must be alphanumeric'</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (strpos ($_GET[<span class="string">'password'</span>], <span class="string">'--'</span>) !== <span class="keyword">FALSE</span>)</span><br><span class="line"><span class="keyword">die</span>(<span class="string">'Flag: '</span> . $flag);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Invalid password'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="分析代码：-4"><a href="#分析代码：-4" class="headerlink" title="分析代码："></a>分析代码：</h2><p>flag变量被设置为flag，即最终我们需要得到flag变量的内容从而达到真正的flag。<br>isset函数判断HTTP GET请求中的参数password是否已设置并且非NULL</p><h3 id="ereg-函数"><a href="#ereg-函数" class="headerlink" title="ereg()函数"></a>ereg()函数</h3> <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> ereg ( string $pattern , string $string [, <span class="keyword">array</span> &amp;$regs ] ) : int</span><br><span class="line">函数用指定的模式搜索一个字符串中指定的字符串,如果匹配成功返回<span class="keyword">true</span>,否则,则返回<span class="keyword">false</span>。</span><br><span class="line">搜索字母的字符是大小写敏感的。</span><br><span class="line">&#125;</span><br><span class="line">ereg (<span class="string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="string">'password'</span>]) !== <span class="keyword">FALSE</span></span><br><span class="line">由第一个参数正则表达式可知该字符串从头到尾只允许出现字母与数字即a-z、A-Z、<span class="number">0</span><span class="number">-9.</span></span><br></pre></td></tr></table></figure><h3 id="strpos-函数"><a href="#strpos-函数" class="headerlink" title="strpos()函数"></a>strpos()函数</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> strpos ( string $haystack , mixed $needle [, int $offset = <span class="number">0</span> ] ) : int</span><br><span class="line">查找字符串在另一字符串中第一次出现的位置。</span><br><span class="line">&#125;</span><br><span class="line">strpos ($_GET[<span class="string">'password'</span>], <span class="string">'--'</span>) !== <span class="keyword">FALSE</span></span><br><span class="line">该字符串必须有“*--*”字符。</span><br></pre></td></tr></table></figure><p>这两个条件明显发生冲突，<em>由于ereg()函数存在%00截断，即ereg()读取字符串时，当遇到%00会默认已经读完，不再读取后面的内容，这样我们就可以利用此漏洞在%00后添加“–”从而绕过正则检测。</em></p><p>解决：<a href="http://123.206.87.240:9009/19.php?password=12%00--" target="_blank" rel="noopener">http://123.206.87.240:9009/19.php?password=12%00--</a><br>同时，ereg()只能处理字符串，遇到数组做参数返回NULL，条件用强 === （要求两边类型相同），而NULL跟FALSE类型不同,顺利进入下一个条件；strpos()的参数也不能为数组，否则返回NULL，与FALSE类型不同，满足！==条件，故也可以直接传入一个数组。<br>解决：<a href="http://123.206.87.240:9009/19.php?password[]=" target="_blank" rel="noopener">http://123.206.87.240:9009/19.php?password[]=</a><br>（或<a href="http://123.206.87.240:9009/19.php?password[]=1只是一个为空值一个给了个值。）" target="_blank" rel="noopener">http://123.206.87.240:9009/19.php?password[]=1只是一个为空值一个给了个值。）</a></p><hr><h1 id="Extract"><a href="#Extract" class="headerlink" title="Extract"></a>Extract</h1><p>打开链接空白页面，分析给出的php代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$flag=<span class="string">'xxx'</span>;extract($_GET); </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($shiyan))</span><br><span class="line">&#123; </span><br><span class="line">$content=trim(file_get_contents($flag)); </span><br><span class="line"><span class="keyword">if</span>($shiyan==$content)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span><span class="string">'flag&#123;xxx&#125;'</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> &#123; <span class="keyword">echo</span><span class="string">'Oh.no'</span>; &#125; &#125;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="extract-函数"><a href="#extract-函数" class="headerlink" title="extract()函数"></a>extract()函数</h3><p>{<br>extract() 函数从数组中将变量导入到当前的符号表。<br>该函数使用数组键名作为变量名，使用数组键值作为变量值。针对数组中的每个元素，将在当前符号表中创建对应的一个变量。<br>该函数返回成功设置的变量数目。<br><strong>但是当变量中有同名的元素时，该函数默认将原有的值给覆盖掉，这就造成了变量覆盖漏洞。</strong><br>}</p><h2 id="代码分析：-1"><a href="#代码分析：-1" class="headerlink" title="代码分析："></a>代码分析：</h2><p>将flag变量设置为xxx；<br>将GET 方法传输进来的值通过extract()函数处理；<br>isset函数判断HTTP GET请求中的参数shiyan是否已设置并且非NULL;<br>if 判断shiyan这个变量和content这个变量是否相等。content 的值是通过读取 flag 变量的值来获取的。如果这个两个变量相等输出 flag 。<br>file_get_contents() — 将整个文件读入一个字符串。<br>trim() — 去除字符串首尾处的空白字符（或者其他字符）。<br>解决：<br>由于我们不知道flag的值是什么？所以我们需要利用extract()函数漏洞，进行变量覆盖，重新给flag变量赋值。<br>只要我们构造的payload使得 $shiyan = $content ，其中 $content 的值又取决于 flag 变量，所以只要 shiyan变量相等于flag变量即可。由于file_get_contents($flag) 中的$flag是一个参数，导致$content的值是空值，所以我们可以构造如下payload：<br><a href="http://123.206.87.240:9009/1.php?shiyan=" target="_blank" rel="noopener">http://123.206.87.240:9009/1.php?shiyan=</a> </p><hr><p><em>这里再引一位大佬的解答：（代码稍有不同）<a href="https://zhouxinan.github.io/" target="_blank" rel="noopener">https://zhouxinan.github.io/</a></em></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$flag=<span class="string">'xxx'</span>;</span><br><span class="line">extract($_GET);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($sixstars)) &#123;</span><br><span class="line">    $content=trim(file_get_contents($flag));</span><br><span class="line">    <span class="keyword">if</span> ($sixstars==$content) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'flag&#123;xxx&#125;'</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Oh.no'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>首先，flag变量被设置为’xxx’，一个简单的字符串。<br>接着，后端运行了extract函数，从<code>$_GET</code>数组中将变量导入到当前的符号表。什么意思呢？其实很简单。比如如果我们访问了<a href="http://139.224.220.67:23900/dmsj/level2/?sixstars=1，那么`$_GET[&quot;sixstars&quot;]`的值为字符串1。执行`extract($_GET)`;时，就相当于执行了`$sixstars=&#39;1&#39;`。" target="_blank" rel="noopener">http://139.224.220.67:23900/dmsj/level2/?sixstars=1，那么`$_GET[&quot;sixstars&quot;]`的值为字符串1。执行`extract($_GET)`;时，就相当于执行了`$sixstars=&#39;1&#39;`。</a><br>然后，程序将会执行<code>isset($sixstars)</code>。我们看到，为了获取flag，必须执行到echo ‘flag{xxx}’;，所以<code>isset($sixstars)</code>的返回值必须为 TRUE。所以，我们必须通过<code>extract($_GET)</code>;将sixstars变量设置为任意值，即使是空字符串也可以。也就是说，即使访问<a href="http://139.224.220.67:23900/dmsj/level2/?sixstars=也是可以的。但绝对不能不包含sixstars参数。" target="_blank" rel="noopener">http://139.224.220.67:23900/dmsj/level2/?sixstars=也是可以的。但绝对不能不包含sixstars参数。</a><br>接着，程序将会执行<code>$content=trim(file_get_contents($flag));</code>。我们分步看。首先会执行<code>file_get_contents($flag)</code>。正常情况下，如果你不通过URL传入flag参数，那么，因为程序的最开始已经执行过<code>$flag=&#39;xxx&#39;</code>;，所以到了这里将会执行file_get_contents(‘xxx’)。file_get_contents函数可以“将整个文件读入一个字符串”。比如如下代码可以将<a href="http://www.example.com/网站的源代码读取到homepage变量中并显示出来。" target="_blank" rel="noopener">http://www.example.com/网站的源代码读取到homepage变量中并显示出来。</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$homepage = file_get_contents(<span class="string">'http://www.example.com/'</span>);</span><br><span class="line"><span class="keyword">echo</span> $homepage;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>接着，php又会执行trim函数，它将会“去除字符串首尾处的空白字符（或者其他字符）”。<br>最后，php将会执行<code>if ($sixstars==$content)，</code>如果为TRUE，那么将会显示flag。<br>读到这里，你想必已经知道了我们该怎么做：首先，给sixstars变量传入一个值，比如1。然后，给flag变量传入一个我们能控制的网站的地址，并让这个我们能控制的网站的源代码设置为1。由于extract能起到“变量覆盖”的作用，在extract后，flag变量就会被覆盖为我们能控制的网站的地址，而不再是’xxx’，这样当执行到file_get_contents时php后端将会从我们能控制的网站上读取到1，并将其和sixstars变量比较，并返回TRUE，然后就能打印flag。<br>虽然这个方法是可行的，但是今天我要教你一个更简单的方法，那就是php伪协议。我们可以直接给flag变量传入data://text/plain,1。意思是明文1。这样file_get_contents(‘data://text/plain,1’)将会直接返回1，就不需要我们在公网上开一台服务器了。<br>所以，最后我们的payload是：<br>1    <a href="http://139.224.220.67:23900/dmsj/level2/?sixstars=1&amp;flag=data://text/plain,1" target="_blank" rel="noopener">http://139.224.220.67:23900/dmsj/level2/?sixstars=1&amp;flag=data://text/plain,1</a><br>这里再强调一下，给后端传参的方法是：在?后跟变量名字，不同的变量之间用&amp;隔开。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;PHP大法&quot;&gt;&lt;a href=&quot;#PHP大法&quot; class=&quot;headerlink&quot; title=&quot;PHP大法&quot;&gt;&lt;/a&gt;PHP大法&lt;/h1&gt;&lt;p&gt;（来源：实验吧  解题链接： &lt;a href=&quot;http://ctf5.shiyanbar.com/DUTCTF/i
      
    
    </summary>
    
      <category term="代码审计" scheme="https://singlemindedt.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
      <category term="php" scheme="https://singlemindedt.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/php/"/>
    
    
      <category term="php" scheme="https://singlemindedt.github.io/tags/php/"/>
    
  </entry>
  
</feed>
